{
  Transaction txn=Transaction.currentTxn();
  try {
    txn.start();
    SubscriptionMgr.getInstance().notifySubscribers(ConsoleProxyManager.ALERT_SUBJECT,this,new ConsoleProxyAlertEventArgs(ConsoleProxyAlertEventArgs.PROXY_DOWN,proxy.getDataCenterId(),proxy.getId(),proxy,null));
    if (!_itMgr.stateTransitTo(proxy,ev,null)) {
      s_logger.debug("Unable to update the console proxy");
      return;
    }
    txn.commit();
  }
 catch (  Exception e) {
    s_logger.error("Unable to complete stop command due to ",e);
  }
  if (_storageMgr.unshare(proxy,null) == null) {
    s_logger.warn("Unable to set share to false for " + proxy.getId());
  }
}
