{
  CertificateVO cert=_certDao.listAll().get(0);
  if (cert.getUpdated().equalsIgnoreCase("Y")) {
    String certStr=cert.getCertificate();
    long proxyVmId=(cmd).getProxyVmId();
    ConsoleProxyVO consoleProxy=_consoleProxyDao.findById(proxyVmId);
    if (consoleProxy != null) {
      HostVO consoleProxyHost=_hostDao.findConsoleProxyHost(consoleProxy.getHostName(),Type.ConsoleProxy);
      UpdateCertificateCommand certCmd=new UpdateCertificateCommand(certStr,true);
      try {
        Answer updateCertAns=_agentMgr.send(consoleProxyHost.getId(),certCmd);
        if (updateCertAns.getResult() == true) {
          long eventId=saveScheduledEvent(User.UID_SYSTEM,Account.ACCOUNT_ID_SYSTEM,EventTypes.EVENT_PROXY_REBOOT,"rebooting console proxy with Id: " + consoleProxy.getId());
          rebootProxy(consoleProxy.getId(),eventId);
          s_logger.info("Successfully rebooted console proxy resource after custom certificate application for proxy:" + cmd.getProxyVmId());
          return true;
        }
      }
 catch (      AgentUnavailableException e) {
        s_logger.warn("Unable to send update certificate command to the console proxy resource for proxy:" + cmd.getProxyVmId(),e);
        return false;
      }
catch (      OperationTimedoutException e) {
        s_logger.warn("Unable to send update certificate command to the console proxy resource for proxy:" + cmd.getProxyVmId(),e);
        return false;
      }
    }
  }
 else {
    return false;
  }
  return false;
}
