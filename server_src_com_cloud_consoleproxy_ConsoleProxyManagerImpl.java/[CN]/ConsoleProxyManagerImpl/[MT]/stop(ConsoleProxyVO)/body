{
  if (!_itMgr.stateTransitTo(proxy,VirtualMachine.Event.StopRequested,proxy.getHostId())) {
    s_logger.debug("Unable to stop console proxy: " + proxy.toString());
    return false;
  }
  GlobalLock proxyLock=GlobalLock.getInternLock(getProxyLockName(proxy.getId()));
  try {
    if (proxyLock.lock(ACQUIRE_GLOBAL_LOCK_TIMEOUT_FOR_SYNC)) {
      try {
        boolean result=_itMgr.stop(proxy,_accountMgr.getSystemUser(),_accountMgr.getSystemAccount());
        if (result) {
          completeStopCommand(proxy,VirtualMachine.Event.OperationSucceeded);
        }
        return result;
      }
  finally {
        proxyLock.unlock();
      }
    }
 else {
      s_logger.debug("Unable to acquire console proxy lock : " + proxy.toString());
      return false;
    }
  }
  finally {
    proxyLock.releaseRef();
  }
}
