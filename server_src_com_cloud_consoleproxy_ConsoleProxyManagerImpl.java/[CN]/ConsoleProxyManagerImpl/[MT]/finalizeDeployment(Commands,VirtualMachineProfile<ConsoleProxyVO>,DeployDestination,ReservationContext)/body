{
  NicProfile controlNic=(NicProfile)profile.getParameter("control.nic");
  CheckSshCommand check=new CheckSshCommand(profile.getInstanceName(),controlNic.getIp4Address(),3922,5,20);
  cmds.addCommand("checkSsh",check);
  ConsoleProxyVO proxy=profile.getVirtualMachine();
  List<NicVO> nics=_nicDao.listBy(proxy.getId());
  for (  NicVO nic : nics) {
    NetworkVO network=_networkDao.findById(nic.getNetworkId());
    if (network.getTrafficType() == TrafficType.Public) {
      proxy.setPublicIpAddress(nic.getIp4Address());
      proxy.setPublicNetmask(nic.getNetmask());
      proxy.setPublicMacAddress(nic.getMacAddress());
    }
 else     if (network.getTrafficType() == TrafficType.Control) {
      proxy.setGuestIpAddress(nic.getIp4Address());
      proxy.setGuestNetmask(nic.getNetmask());
      proxy.setGuestMacAddress(nic.getMacAddress());
    }
 else     if (network.getTrafficType() == TrafficType.Management) {
      proxy.setPrivateIpAddress(nic.getIp4Address());
      proxy.setPrivateNetmask(nic.getNetmask());
      proxy.setPrivateMacAddress(nic.getMacAddress());
    }
  }
  _consoleProxyDao.update(proxy.getId(),proxy);
  return true;
}
