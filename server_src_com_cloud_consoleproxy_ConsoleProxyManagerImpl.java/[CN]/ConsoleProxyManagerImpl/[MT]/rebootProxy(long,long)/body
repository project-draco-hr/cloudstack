{
  AsyncJobExecutor asyncExecutor=BaseAsyncJobExecutor.getCurrentExecutor();
  if (asyncExecutor != null) {
    AsyncJobVO job=asyncExecutor.getJob();
    if (s_logger.isInfoEnabled()) {
      s_logger.info("Reboot console proxy " + proxyVmId + ", update async job-"+ job.getId());
    }
    _asyncMgr.updateAsyncJobAttachment(job.getId(),"console_proxy",proxyVmId);
  }
  final ConsoleProxyVO proxy=_consoleProxyDao.findById(proxyVmId);
  if (proxy == null || proxy.getState() == State.Destroyed) {
    return false;
  }
  if (proxy.getState() == State.Running && proxy.getHostId() != null) {
    final RebootCommand cmd=new RebootCommand(proxy.getInstanceName());
    final Answer answer=_agentMgr.easySend(proxy.getHostId(),cmd);
    if (answer != null) {
      if (s_logger.isDebugEnabled()) {
        s_logger.debug("Successfully reboot console proxy " + proxy.getName());
      }
      SubscriptionMgr.getInstance().notifySubscribers(ConsoleProxyManager.ALERT_SUBJECT,this,new ConsoleProxyAlertEventArgs(ConsoleProxyAlertEventArgs.PROXY_REBOOTED,proxy.getDataCenterId(),proxy.getId(),proxy,null));
      final EventVO event=new EventVO();
      event.setUserId(User.UID_SYSTEM);
      event.setAccountId(Account.ACCOUNT_ID_SYSTEM);
      event.setType(EventTypes.EVENT_PROXY_REBOOT);
      event.setLevel(EventVO.LEVEL_INFO);
      event.setStartId(startEventId);
      event.setDescription("Console proxy rebooted - " + proxy.getName());
      _eventDao.persist(event);
      return true;
    }
 else {
      if (s_logger.isDebugEnabled()) {
        s_logger.debug("failed to reboot console proxy : " + proxy.getName());
      }
      final EventVO event=new EventVO();
      event.setUserId(User.UID_SYSTEM);
      event.setAccountId(Account.ACCOUNT_ID_SYSTEM);
      event.setType(EventTypes.EVENT_PROXY_REBOOT);
      event.setLevel(EventVO.LEVEL_ERROR);
      event.setStartId(startEventId);
      event.setDescription("Rebooting console proxy failed - " + proxy.getName());
      _eventDao.persist(event);
      return false;
    }
  }
 else {
    return startProxy(proxyVmId,0) != null;
  }
}
