{
  ConsoleProxyVO proxy=_consoleProxyDao.findById(vmId);
  try {
    _itMgr.expunge(proxy.getUuid());
    proxy.setPublicIpAddress(null);
    proxy.setPublicMacAddress(null);
    proxy.setPublicNetmask(null);
    proxy.setPrivateMacAddress(null);
    proxy.setPrivateIpAddress(null);
    _consoleProxyDao.update(proxy.getId(),proxy);
    _consoleProxyDao.remove(vmId);
    HostVO host=_hostDao.findByTypeNameAndZoneId(proxy.getDataCenterId(),proxy.getHostName(),Host.Type.ConsoleProxy);
    if (host != null) {
      logger.debug("Removing host entry for proxy id=" + vmId);
      return _hostDao.remove(host.getId());
    }
    return true;
  }
 catch (  ResourceUnavailableException e) {
    logger.warn("Unable to expunge " + proxy,e);
    return false;
  }
}
