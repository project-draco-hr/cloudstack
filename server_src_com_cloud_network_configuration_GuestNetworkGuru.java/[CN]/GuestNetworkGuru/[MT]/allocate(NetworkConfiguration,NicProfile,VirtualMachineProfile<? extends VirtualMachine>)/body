{
  if (config.getTrafficType() != TrafficType.Guest) {
    return null;
  }
  if (nic == null) {
    nic=new NicProfile(ReservationStrategy.Start,null,null,null,null);
  }
 else {
    nic.setStrategy(ReservationStrategy.Create);
  }
  if (nic.getMacAddress() == null) {
    nic.setMacAddress(_networkConfigDao.getNextAvailableMacAddress(config.getId()));
    if (nic.getMacAddress() == null) {
      throw new InsufficientAddressCapacityException("Unable to allocate more mac addresses");
    }
  }
  return nic;
}
