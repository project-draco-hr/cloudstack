{
  if (_routerNetworkDao.findByRouterAndNetwork(router.getId(),guestNetwork.getId()) == null && !guestNetwork.getName().equalsIgnoreCase(NetworkOffering.SystemPrivateGatewayNetworkOffering)) {
    Transaction txn=Transaction.currentTxn();
    txn.start();
    RouterNetworkVO routerNtwkMap=new RouterNetworkVO(router.getId(),guestNetwork.getId(),guestNetwork.getGuestType());
    _routerNetworkDao.persist(routerNtwkMap);
    UserStatisticsVO stats=_userStatsDao.findBy(router.getAccountId(),router.getDataCenterIdToDeployIn(),guestNetwork.getId(),null,router.getId(),router.getType().toString());
    if (stats == null) {
      stats=new UserStatisticsVO(router.getAccountId(),router.getDataCenterIdToDeployIn(),null,router.getId(),router.getType().toString(),guestNetwork.getId());
      _userStatsDao.persist(stats);
    }
    txn.commit();
  }
}
