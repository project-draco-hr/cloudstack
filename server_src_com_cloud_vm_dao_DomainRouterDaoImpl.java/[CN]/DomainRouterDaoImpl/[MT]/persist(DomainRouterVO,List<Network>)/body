{
  Transaction txn=Transaction.currentTxn();
  txn.start();
  DomainRouterVO newRouter=super.persist(router);
  if (guestNetworks != null && !guestNetworks.isEmpty()) {
    for (    Network guestNetwork : guestNetworks) {
      if (!isRouterPartOfGuestNetwork(router.getId(),guestNetwork.getId())) {
        if (!(guestNetwork.getName() != NetworkOffering.SystemPrivateGatewayNetworkOffering)) {
          addRouterToGuestNetwork(router,guestNetwork);
        }
      }
    }
  }
  txn.commit();
  return newRouter;
}
