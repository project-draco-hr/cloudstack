{
  SearchCriteria<DataCenterVnetVO> sc=FreeVnetSearch.create();
  sc.setParameters("dc",dcId);
  Date now=new Date();
  Transaction txn=Transaction.currentTxn();
  try {
    txn.start();
    DataCenterVnetVO vo=lockOneRandomRow(sc,true);
    if (vo == null) {
      return null;
    }
    vo.setTakenAt(now);
    vo.setAccountId(accountId);
    update(vo.getId(),vo);
    txn.commit();
    return vo;
  }
 catch (  Exception e) {
    throw new CloudRuntimeException("Caught Exception ",e);
  }
}
