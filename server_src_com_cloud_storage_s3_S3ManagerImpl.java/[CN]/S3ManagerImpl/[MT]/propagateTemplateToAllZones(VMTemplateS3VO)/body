{
  final long templateId=vmTemplateS3VO.getId();
  if (!isS3Enabled()) {
    if (LOGGER.isTraceEnabled()) {
      LOGGER.trace(format("Attempt to propogate template id %1$s across all zones.  However, S3 is not enabled.",templateId));
    }
    return;
  }
  final S3TO s3=getS3TO();
  if (s3 == null) {
    LOGGER.warn(format("Unable to propagate template id %1$s across all zones because S3 is enabled, but not configured.",templateId));
    return;
  }
  if (vmTemplateS3VO != null) {
    final List<DataCenterVO> dataCenters=dataCenterDao.listAll();
    for (    DataCenterVO dataCenter : dataCenters) {
      final VMTemplateZoneVO tmpltZoneVO=new VMTemplateZoneVO(dataCenter.getId(),templateId,now());
      vmTemplateZoneDao.persist(tmpltZoneVO);
    }
  }
}
