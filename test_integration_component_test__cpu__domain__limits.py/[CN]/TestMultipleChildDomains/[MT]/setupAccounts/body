def setupAccounts(self):
    self.debug(('Creating a domain under: %s' % self.domain.name))
    self.parent_domain = Domain.create(self.apiclient, services=self.services['domain'], parentdomainid=self.domain.id)
    self.parentd_admin = Account.create(self.apiclient, self.services['account'], admin=True, domainid=self.domain.id)
    self.debug(('Updating the Memory resource limit for domain: %s' % self.domain.name))
    Resources.updateLimit(self.apiclient, resourcetype=8, max=10, domainid=self.parentd_admin.domainid, account=self.parentd_admin.name)
    self.debug(('Creating a sub-domain under: %s' % self.parent_domain.name))
    self.cdomain_1 = Domain.create(self.apiclient, services=self.services['domain'], parentdomainid=self.parent_domain.id)
    self.debug(('Creating a sub-domain under: %s' % self.parent_domain.name))
    self.cdomain_2 = Domain.create(self.apiclient, services=self.services['domain'], parentdomainid=self.parent_domain.id)
    self.cadmin_1 = Account.create(self.apiclient, self.services['account'], admin=True, domainid=self.cdomain_1.id)
    self.debug(('Updating the Memory resource count for domain: %s' % self.cdomain_1.name))
    Resources.updateLimit(self.apiclient, resourcetype=8, max=4, domainid=self.cadmin_1.domainid)
    self.debug(('Updating the Memory resource count for account: %s' % self.cadmin_1.name))
    Resources.updateLimit(self.apiclient, resourcetype=8, max=2, account=self.cadmin_1.name, domainid=self.cadmin_1.domainid)
    self.cadmin_2 = Account.create(self.apiclient, self.services['account'], admin=True, domainid=self.cdomain_2.id)
    self.debug(('Updating the Memory resource count for domain: %s' % self.cdomain_2.name))
    Resources.updateLimit(self.apiclient, resourcetype=8, max=5, domainid=self.cadmin_2.domainid)
    self.debug(('Updating the Memory resource count for account: %s' % self.cadmin_2.name))
    Resources.updateLimit(self.apiclient, resourcetype=8, max=3, account=self.cadmin_2.name, domainid=self.cadmin_2.domainid)
    self.cleanup.append(self.cadmin_1)
    self.cleanup.append(self.cadmin_2)
    self.cleanup.append(self.cdomain_1)
    self.cleanup.append(self.cdomain_2)
    self.cleanup.append(self.parentd_admin)
    self.cleanup.append(self.parent_domain)
    users = {self.parent_domain: self.parentd_admin, self.cdomain_1: self.cadmin_1, self.cdomain_2: self.cadmin_2, }
    return users
