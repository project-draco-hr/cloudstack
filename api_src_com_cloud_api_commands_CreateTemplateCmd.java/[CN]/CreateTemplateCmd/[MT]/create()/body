{
  if (isBareMetal()) {
    _bareMetalVmService.createPrivateTemplateRecord(this);
    this.setEntityId(vmId);
  }
 else {
    VirtualMachineTemplate template=null;
    template=_userVmService.createPrivateTemplateRecord(this);
    if (template != null) {
      this.setEntityId(template.getId());
    }
 else {
      throw new ServerApiException(BaseCmd.INTERNAL_ERROR,"Failed to create a template");
    }
  }
}
