{
  byte[] buffer=new byte[8192];
  InputStream inputStream=_session.getStdout();
  try {
    while (true) {
      if (inputStream.available() == 0) {
        int conditions=_session.waitForCondition(ChannelCondition.STDOUT_DATA | ChannelCondition.STDERR_DATA | ChannelCondition.EOF,500);
        if ((conditions & ChannelCondition.TIMEOUT) != 0) {
          break;
        }
        if ((conditions & ChannelCondition.EOF) != 0) {
          if ((conditions & (ChannelCondition.STDOUT_DATA | ChannelCondition.STDERR_DATA)) == 0) {
            break;
          }
        }
      }
      while (inputStream.available() > 0) {
        inputStream.read(buffer);
      }
    }
  }
 catch (  Exception e) {
    s_logger.error("Failed to receive message: " + e.getMessage());
    throw new CloudRuntimeException("Failed to receives message: " + e.getMessage());
  }
  return new String(buffer);
}
