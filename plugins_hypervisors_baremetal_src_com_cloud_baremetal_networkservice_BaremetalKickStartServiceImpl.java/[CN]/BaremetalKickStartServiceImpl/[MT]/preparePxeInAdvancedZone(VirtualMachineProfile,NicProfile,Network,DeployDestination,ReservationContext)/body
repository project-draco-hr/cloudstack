{
  DomainRouterVO vr=getVirtualRouter(network);
  List<NicVO> nics=_nicDao.listByVmId(vr.getId());
  NicVO mgmtNic=null;
  for (  NicVO nicvo : nics) {
    if (ControlNetworkGuru.class.getSimpleName().equals(nicvo.getReserver())) {
      mgmtNic=nicvo;
      break;
    }
  }
  if (mgmtNic == null) {
    throw new CloudRuntimeException(String.format("cannot find management nic on virutal router[id:%s]",vr.getId()));
  }
  BaremetalVritualRouterCommands.PreparePxeCmd cmd=new BaremetalVritualRouterCommands.PreparePxeCmd();
  List<String> tuple=parseKickstartUrl(profile);
  cmd.setKickStartUrl(tuple.get(0));
  cmd.setKernelUrl(tuple.get(1));
  cmd.setInitrdUrl(tuple.get(2));
  cmd.setGuestMac(nic.getMacAddress());
  RestTemplate rst=new RestTemplate();
  BaremetalVritualRouterCommands.PreparePxeRsp rsp=rst.getForObject(buildUrl(mgmtNic.getIp4Address(),BaremetalVritualRouterCommands.PREPARE_PXE_URL),BaremetalVritualRouterCommands.PreparePxeRsp.class);
  if (!rsp.isSuccess()) {
    throw new CloudRuntimeException(String.format("failed preparing PXE in virtual router[id:%s], because %s",vr.getId(),rsp.getError()));
  }
  return true;
}
