{
  if (config.isSpecifiedCidr()) {
    return super.allocate(config,nic,vm);
  }
  if (nic != null && nic.getRequestedIp() != null) {
    throw new CloudRuntimeException("Does not support custom ip allocation at this time: " + nic);
  }
  NicProfile profile=super.allocate(config,nic,vm);
  if (_ovsNetworkMgr.isOvsNetworkEnabled() || _tunnelMgr.isOvsTunnelEnabled()) {
    return null;
  }
  profile.setStrategy(ReservationStrategy.Start);
  profile.setGateway(null);
  profile.setNetmask(null);
  return profile;
}
