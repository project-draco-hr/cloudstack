{
  VIF dom0vif=null;
  Pair<VM,VM.Record> vm=getControlDomain(conn);
  VM dom0=vm.first();
  Set<VIF> vifs=dom0.getVIFs(conn);
  if (vifs.size() != 0) {
    for (    VIF vif : vifs) {
      Map<String,String> otherConfig=vif.getOtherConfig(conn);
      if (otherConfig != null) {
        String nameLabel=otherConfig.get("nameLabel");
        if ((nameLabel != null) && nameLabel.equalsIgnoreCase(vifNameLabel)) {
          dom0vif=vif;
        }
      }
    }
  }
  if (dom0vif == null) {
    s_logger.debug("Can't find a vif on dom0 for " + networkDesc + ", creating a new one");
    VIF.Record vifr=new VIF.Record();
    vifr.VM=dom0;
    vifr.device=getLowestAvailableVIFDeviceNum(conn,dom0);
    if (vifr.device == null) {
      s_logger.debug("Failed to create " + networkDesc + ", no vif available");
      return;
    }
    Map<String,String> config=new HashMap<String,String>();
    config.put("nameLabel",vifNameLabel);
    vifr.otherConfig=config;
    vifr.MAC="FE:FF:FF:FF:FF:FF";
    vifr.network=nw;
    dom0vif=VIF.create(conn,vifr);
    dom0vif.plug(conn);
    dom0vif.unplug(conn);
  }
 else {
    s_logger.debug("already have a vif on dom0 for " + networkDesc);
    if (!dom0vif.getCurrentlyAttached(conn)) {
      dom0vif.plug(conn);
      dom0vif.unplug(conn);
    }
  }
}
