{
  try {
    if (!pingxenserver()) {
      Thread.sleep(1000);
      if (!pingxenserver()) {
        s_logger.warn(" can not ping xenserver " + _host.uuid);
        return null;
      }
    }
    HashMap<String,State> newStates=sync();
    if (newStates == null) {
      newStates=new HashMap<String,State>();
    }
    if (!_canBridgeFirewall) {
      return new PingRoutingCommand(getType(),id,newStates);
    }
 else {
      HashMap<String,Pair<Long,Long>> nwGrpStates=syncNetworkGroups(id);
      return new PingRoutingWithNwGroupsCommand(getType(),id,newStates,nwGrpStates);
    }
  }
 catch (  Exception e) {
    s_logger.warn("Unable to get current status",e);
    return null;
  }
}
