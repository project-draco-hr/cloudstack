{
  Connection conn=getConnection();
  HashMap<String,Pair<String,State>> newStates;
  int sync_type;
  if (cmd.isRightStep()) {
    newStates=fullClusterSync(conn);
    sync_type=ClusterSyncAnswer.FULL_SYNC;
  }
 else {
    newStates=deltaClusterSync(conn);
    if (newStates == null) {
      s_logger.warn("Unable to get current status from sync");
    }
    sync_type=ClusterSyncAnswer.DELTA_SYNC;
  }
  cmd.incrStep();
  return new ClusterSyncAnswer(cmd.getClusterId(),newStates,sync_type);
}
