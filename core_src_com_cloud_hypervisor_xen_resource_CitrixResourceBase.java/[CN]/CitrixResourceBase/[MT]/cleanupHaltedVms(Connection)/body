{
  Host host=Host.getByUuid(conn,_host.uuid);
  Set<VM> vms=VM.getAll(conn);
  boolean success=true;
  for (  VM vm : vms) {
    try {
      VM.Record vmr=vm.getRecord(conn);
      if (VmPowerState.HALTED.equals(vmr.powerState) && vmr.affinity.equals(host)) {
        vm.destroy(conn);
      }
    }
 catch (    XenAPIException e) {
      s_logger.warn("Unable to cleanup " + vm);
      success=false;
    }
catch (    XmlRpcException e) {
      s_logger.warn("Unable to cleanup " + vm);
      success=false;
    }
  }
  return success;
}
