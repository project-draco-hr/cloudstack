{
  Long dcId=cmd.getDataCenterId();
  Long accountId=cmd.getAccountId();
  Long volumeId=cmd.getVolumeId();
  String secondaryStoragePoolURL=cmd.getSecondaryStoragePoolURL();
  String snapshotUUID=cmd.getSnapshotUuid();
  String primaryStorageNameLabel=cmd.getPrimaryStoragePoolNameLabel();
  String details=null;
  boolean success=false;
  SR primaryStorageSR=null;
  try {
    primaryStorageSR=getSRByNameLabelandHost(primaryStorageNameLabel);
    if (primaryStorageSR == null) {
      details="Primary Storage SR could not be created from the name label: " + primaryStorageNameLabel;
    }
  }
 catch (  XenAPIException e) {
    details="Couldn't determine primary SR type " + e.getMessage();
    s_logger.error(details,e);
  }
catch (  Exception e) {
    details="Couldn't determine primary SR type " + e.getMessage();
    s_logger.error(details,e);
  }
  if (primaryStorageSR != null) {
    if (snapshotUUID != null) {
      VDI snapshotVDI=getVDIbyUuid(snapshotUUID);
      if (snapshotVDI != null) {
        destroyVDI(snapshotVDI);
      }
    }
  }
  URI uri=null;
  try {
    uri=new URI(secondaryStoragePoolURL);
  }
 catch (  URISyntaxException e) {
    details="Error finding the secondary storage URL" + e.getMessage();
    s_logger.error(details,e);
  }
  if (uri != null) {
    String secondaryStorageMountPath=uri.getHost() + ":" + uri.getPath();
    if (secondaryStorageMountPath == null) {
      details="Couldn't delete snapshotsDir because the URL passed: " + secondaryStoragePoolURL + " is invalid.";
    }
 else {
      details=deleteSnapshotsDir(dcId,accountId,volumeId,secondaryStorageMountPath);
      success=(details != null && details.equals("1"));
      if (success) {
        s_logger.debug("Successfully deleted snapshotsDir for volume: " + volumeId);
      }
    }
  }
  return new Answer(cmd,success,details);
}
