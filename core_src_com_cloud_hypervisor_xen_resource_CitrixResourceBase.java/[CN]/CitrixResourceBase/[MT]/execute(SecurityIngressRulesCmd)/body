{
  Connection conn=getConnection();
  if (s_logger.isTraceEnabled()) {
    s_logger.trace("Sending network rules command to " + _host.ip);
  }
  if (!_canBridgeFirewall) {
    s_logger.info("Host " + _host.ip + " cannot do bridge firewalling");
    return new SecurityIngressRuleAnswer(cmd,false,"Host " + _host.ip + " cannot do bridge firewalling");
  }
  String result=callHostPlugin(conn,"vmops","network_rules","vmName",cmd.getVmName(),"vmIP",cmd.getGuestIp(),"vmMAC",cmd.getGuestMac(),"type","ingress","vmID",Long.toString(cmd.getVmId()),"signature",cmd.getSignature(),"seqno",Long.toString(cmd.getSeqNum()),"rules",cmd.stringifyRules());
  if (result == null || result.isEmpty() || !Boolean.parseBoolean(result)) {
    s_logger.warn("Failed to program network rules for vm " + cmd.getVmName());
    return new SecurityIngressRuleAnswer(cmd,false,"programming network rules failed");
  }
 else {
    s_logger.info("Programmed network rules for vm " + cmd.getVmName() + " guestIp="+ cmd.getGuestIp()+ ", numrules="+ cmd.getRuleSet().length);
    return new SecurityIngressRuleAnswer(cmd);
  }
}
