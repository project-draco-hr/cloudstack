{
  Connection conn=getConnection();
  try {
    Set<VM> vms=VM.getByNameLabel(conn,cmd.getName());
    if (vms.size() == 1) {
      return new GetVncPortAnswer(cmd,getVncPort(conn,vms.iterator().next()));
    }
 else {
      return new GetVncPortAnswer(cmd,"There are " + vms.size() + " VMs named "+ cmd.getName());
    }
  }
 catch (  Exception e) {
    String msg="Unable to get vnc port due to " + e.toString();
    s_logger.warn(msg,e);
    return new GetVncPortAnswer(cmd,msg);
  }
}
