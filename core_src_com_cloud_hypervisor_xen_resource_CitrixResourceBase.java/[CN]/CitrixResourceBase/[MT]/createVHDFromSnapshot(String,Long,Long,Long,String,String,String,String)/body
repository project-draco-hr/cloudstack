{
  String details=null;
  Connection conn=getConnection();
  SR primaryStorageSR=getSRByNameLabelandHost(primaryStorageNameLabel);
  if (primaryStorageSR == null) {
    throw new InternalErrorException("Could not create volume from snapshot " + "because the primary Storage SR could not be created from the name label: " + primaryStorageNameLabel);
  }
  Boolean isISCSI=SRType.LVMOISCSI.equals(primaryStorageSR.getType(conn));
  URI uri=new URI(secondaryStoragePoolURL);
  String secondaryStorageMountPath=uri.getHost() + ":" + uri.getPath();
  VHDInfo vhdInfo=null;
  if (secondaryStorageMountPath == null) {
    details=" because the URL passed: " + secondaryStoragePoolURL + " is invalid.";
  }
 else {
    vhdInfo=createVHDFromSnapshot(dcId,accountId,volumeId,secondaryStorageMountPath,backedUpSnapshotUuid,templatePath,templateDownloadFolder,isISCSI);
    if (vhdInfo == null) {
      details=" because the vmops plugin on XenServer failed at some point";
    }
  }
  return new Pair<VHDInfo,String>(vhdInfo,details);
}
