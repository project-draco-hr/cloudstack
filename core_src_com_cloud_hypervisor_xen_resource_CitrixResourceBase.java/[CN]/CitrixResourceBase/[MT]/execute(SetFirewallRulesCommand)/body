{
  String[] results=new String[cmd.getRules().length];
  String ret;
  Connection conn=getConnection();
  String routerIp=cmd.getAccessDetail(NetworkElementCommand.ROUTER_IP);
  if (routerIp == null) {
    return new SetFirewallRulesAnswer(cmd,false,results);
  }
  String[][] rules=cmd.generateFwRules();
  String args="";
  args+=routerIp + " -F ";
  StringBuilder sb=new StringBuilder();
  String[] addRules=rules[0];
  if (addRules.length > 0) {
    for (int i=0; i < addRules.length; i++) {
      sb.append(addRules[i]).append(',');
    }
    args+=" -a " + sb.toString();
  }
  ret=callHostPlugin(conn,"vmops","setFirewallRule","args",args);
  if (ret == null || ret.isEmpty()) {
    return new SetFirewallRulesAnswer(cmd,false,results);
  }
  return new SetFirewallRulesAnswer(cmd,true,results);
}
