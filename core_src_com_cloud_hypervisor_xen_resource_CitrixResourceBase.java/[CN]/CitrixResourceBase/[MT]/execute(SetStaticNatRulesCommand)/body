{
  Connection conn=getConnection();
  String routerIp=cmd.getAccessDetail(NetworkElementCommand.ROUTER_IP);
  String args=routerIp;
  String[] results=new String[cmd.getRules().length];
  int i=0;
  for (  StaticNatRuleTO rule : cmd.getRules()) {
    args+=rule.revoked() ? " -D " : " -A ";
    args+=" -l " + rule.getSrcIp();
    args+=" -r " + rule.getDstIp();
    args+=" -P " + rule.getProtocol().toLowerCase();
    args+=" -d " + rule.getStringSrcPortRange();
    args+=" -G ";
    String result=callHostPlugin(conn,"vmops","setFirewallRule","args",args);
    results[i++]=(result == null || result.isEmpty()) ? "Failed" : null;
  }
  return new SetStaticNatRulesAnswer(cmd,results);
}
