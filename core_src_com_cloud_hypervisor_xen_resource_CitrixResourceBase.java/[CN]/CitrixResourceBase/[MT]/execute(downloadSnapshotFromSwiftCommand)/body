{
  SwiftTO swift=cmd.getSwift();
  String secondaryStorageURL=cmd.getSecondaryStoragePoolURL();
  Long accountId=cmd.getAccountId();
  Long volumeId=cmd.getVolumeId();
  String rfilename=cmd.getSnapshotUuid();
  try {
    URI uri=new URI(secondaryStorageURL);
    String remoteMountPath=uri.getHost() + ":" + uri.getPath();
    String folder="snapshots/" + String.valueOf(accountId) + "/"+ String.valueOf(volumeId)+ "/";
    String dir=remoteMountPath + "/" + folder;
    Connection conn=getConnection();
    if (!createSecondaryStorageFolder(conn,remoteMountPath,folder)) {
      throw new InternalErrorException("Failed to create the volume folder.");
    }
    String lfilename=rfilename;
    if (rfilename.startsWith("VHD-")) {
      lfilename=rfilename.replace("VHD-","") + ".vhd";
    }
    if (swiftDownload(conn,swift,volumeId.toString(),rfilename,dir,lfilename,true)) {
      return new Answer(cmd,true,"success");
    }
    return new Answer(cmd,false,"failure");
  }
 catch (  Exception e) {
    String msg=cmd + " Command failed due to " + e.toString();
    s_logger.warn(msg,e);
    throw new CloudRuntimeException(msg);
  }
}
