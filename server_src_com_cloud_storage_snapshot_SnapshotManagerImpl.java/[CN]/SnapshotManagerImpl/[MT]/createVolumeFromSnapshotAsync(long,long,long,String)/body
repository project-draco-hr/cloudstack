{
  SnapshotVO snapshot=_snapshotDao.findById(snapshotId);
  VolumeVO volume=_volsDao.findById(snapshot.getVolumeId());
  EventVO event=new EventVO();
  event.setUserId(userId);
  event.setAccountId(accountId);
  event.setType(EventTypes.EVENT_VOLUME_CREATE);
  event.setState(EventState.Scheduled);
  event.setDescription("Scheduled async job for creating volume from snapshot with id: " + snapshotId);
  event=_eventDao.persist(event);
  SnapshotOperationParam param=new SnapshotOperationParam(userId,accountId,volume.getId(),snapshotId,volumeName);
  param.setEventId(event.getId());
  Gson gson=GsonHelper.getBuilder().create();
  AsyncJobVO job=new AsyncJobVO();
  job.setUserId(userId);
  job.setAccountId(snapshot.getAccountId());
  job.setCmd("CreateVolumeFromSnapshot");
  job.setCmdInfo(gson.toJson(param));
  job.setCmdOriginator(CreateVolumeCmd.getResultObjectName());
  return _asyncMgr.submitAsyncJob(job);
}
