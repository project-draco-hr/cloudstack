{
  SnapshotInfo snapshot=this.snapshotFactory.getSnapshot(snapshotId);
  if (snapshot == null) {
    throw new CloudRuntimeException("Can't find snapshot:" + snapshotId);
  }
  if (snapshot.getState() == Snapshot.State.BackedUp) {
    return snapshot;
  }
  SnapshotStrategy strategy=null;
  for (  SnapshotStrategy st : snapshotStrategies) {
    if (st.canHandle(snapshot)) {
      strategy=st;
      break;
    }
  }
  return strategy.backupSnapshot(snapshot);
}
