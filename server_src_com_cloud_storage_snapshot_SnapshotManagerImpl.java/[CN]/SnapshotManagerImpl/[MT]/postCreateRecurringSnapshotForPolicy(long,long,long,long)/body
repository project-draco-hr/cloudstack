{
  Filter searchFilter=new Filter(SnapshotVO.class,GenericDaoBase.CREATED_COLUMN,true,null,null);
  List<SnapshotVO> snaps=listSnapsforPolicy(policyId,searchFilter);
  SnapshotPolicyVO policy=_snapshotPolicyDao.findById(policyId);
  while (snaps.size() > policy.getMaxSnaps() && snaps.size() > 1) {
    SnapshotVO oldestSnapshot=snaps.get(0);
    long oldSnapId=oldestSnapshot.getId();
    s_logger.debug("Max snaps: " + policy.getMaxSnaps() + " exceeded for snapshot policy with Id: "+ policyId+ ". Deleting oldest snapshot: "+ oldSnapId);
    destroySnapshotAsync(userId,volumeId,oldSnapId,policyId);
    snaps.remove(oldestSnapshot);
  }
}
