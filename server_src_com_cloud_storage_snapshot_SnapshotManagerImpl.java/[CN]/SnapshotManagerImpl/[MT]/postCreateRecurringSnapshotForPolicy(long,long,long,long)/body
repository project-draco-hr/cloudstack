{
  List<SnapshotVO> snaps=listSnapsforVolumeType(volumeId,SnapshotType.RECURRING.name());
  SnapshotPolicyVO policy=_snapshotPolicyDao.findById(policyId);
  while (snaps.size() > policy.getMaxSnaps() && snaps.size() > 1) {
    SnapshotVO oldestSnapshot=snaps.get(0);
    long oldSnapId=oldestSnapshot.getId();
    s_logger.debug("Max snaps: " + policy.getMaxSnaps() + " exceeded for snapshot policy with Id: "+ policyId+ ". Deleting oldest snapshot: "+ oldSnapId);
    destroySnapshotAsync(userId,volumeId,oldSnapId,policyId);
    snaps.remove(oldestSnapshot);
  }
}
