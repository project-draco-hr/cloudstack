{
  _name=name;
  ComponentLocator locator=ComponentLocator.getCurrentLocator();
  ConfigurationDao configDao=locator.getDao(ConfigurationDao.class);
  if (configDao == null) {
    throw new ConfigurationException("Unable to get the configuration dao.");
  }
  DateUtil.IntervalType.HOURLY.setMax(NumbersUtil.parseInt(configDao.getValue("snapshot.max.hourly"),HOURLYMAX));
  DateUtil.IntervalType.DAILY.setMax(NumbersUtil.parseInt(configDao.getValue("snapshot.max.daily"),DAILYMAX));
  DateUtil.IntervalType.WEEKLY.setMax(NumbersUtil.parseInt(configDao.getValue("snapshot.max.weekly"),WEEKLYMAX));
  DateUtil.IntervalType.MONTHLY.setMax(NumbersUtil.parseInt(configDao.getValue("snapshot.max.monthly"),MONTHLYMAX));
  _deltaSnapshotMax=NumbersUtil.parseInt(configDao.getValue("snapshot.delta.max"),DELTAMAX);
  _totalRetries=NumbersUtil.parseInt(configDao.getValue("total.retries"),4);
  _pauseInterval=2 * NumbersUtil.parseInt(configDao.getValue("ping.interval"),60);
  Long lastId=_getLastId();
  if (lastId == null) {
    String msg="Can not get last id of snapshots";
    s_logger.error(msg);
    throw new CloudRuntimeException(msg);
  }
  s_logger.info("Set shapshot sequence to " + (lastId + 1));
  _updateSnapshotSeq(lastId + 1);
  s_logger.info("Snapshot Manager is configured.");
  return true;
}
