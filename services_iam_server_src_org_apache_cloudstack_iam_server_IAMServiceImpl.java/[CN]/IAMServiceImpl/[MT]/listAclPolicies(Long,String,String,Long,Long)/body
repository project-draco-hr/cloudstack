{
  if (aclPolicyId != null) {
    IAMPolicy policy=_aclPolicyDao.findById(aclPolicyId);
    if (policy == null) {
      throw new InvalidParameterValueException("Unable to find acl policy by id " + aclPolicyId);
    }
  }
  Filter searchFilter=new Filter(IAMPolicyVO.class,"id",true,startIndex,pageSize);
  SearchBuilder<IAMPolicyVO> sb=_aclPolicyDao.createSearchBuilder();
  sb.and("name",sb.entity().getName(),SearchCriteria.Op.EQ);
  sb.and("path",sb.entity().getPath(),SearchCriteria.Op.LIKE);
  sb.and("id",sb.entity().getId(),SearchCriteria.Op.EQ);
  SearchCriteria<IAMPolicyVO> sc=sb.create();
  if (aclPolicyName != null) {
    sc.setParameters("name",aclPolicyName);
  }
  if (aclPolicyId != null) {
    sc.setParameters("id",aclPolicyId);
  }
  sc.setParameters("path",path + "%");
  Pair<List<IAMPolicyVO>,Integer> policies=_aclPolicyDao.searchAndCount(sc,searchFilter);
  @SuppressWarnings("rawtypes") List policyList=policies.first();
  return new Pair<List<IAMPolicy>,Integer>(policyList,policies.second());
}
