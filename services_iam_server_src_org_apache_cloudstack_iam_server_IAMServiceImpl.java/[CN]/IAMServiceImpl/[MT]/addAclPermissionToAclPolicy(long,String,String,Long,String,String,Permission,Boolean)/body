{
  IAMPolicy policy=_aclPolicyDao.findById(aclPolicyId);
  if (policy == null) {
    throw new InvalidParameterValueException("Unable to find acl policy: " + aclPolicyId + "; failed to add permission to policy.");
  }
  IAMPolicyPermissionVO permit=_policyPermissionDao.findByPolicyAndEntity(aclPolicyId,entityType,scope,scopeId,action,perm);
  if (permit == null) {
    permit=new IAMPolicyPermissionVO(aclPolicyId,action,entityType,accessType,scope,scopeId,perm,recursive);
    _policyPermissionDao.persist(permit);
  }
  return policy;
}
