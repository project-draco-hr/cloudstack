{
  Account caller=CallContext.current().getCallingAccount();
  AclPolicy policy=_aclPolicyDao.findById(aclPolicyId);
  if (policy == null) {
    throw new InvalidParameterValueException("Unable to find acl policy: " + aclPolicyId + "; failed to add permission to policy.");
  }
  AclPolicyPermissionVO permit=_policyPermissionDao.findByPolicyAndEntity(aclPolicyId,entityType,scope,scopeId,action,perm);
  if (permit == null) {
    permit=new AclPolicyPermissionVO(aclPolicyId,action,entityType,accessType,scope,scopeId,perm);
    _policyPermissionDao.persist(permit);
  }
  return policy;
}
