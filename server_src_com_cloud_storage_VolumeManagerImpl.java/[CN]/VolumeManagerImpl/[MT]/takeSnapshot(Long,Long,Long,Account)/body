{
  VolumeInfo volume=this.volFactory.getVolume(volumeId);
  if (volume == null) {
    throw new InvalidParameterValueException("Creating snapshot failed due to volume:" + volumeId + " doesn't exist");
  }
  if (volume.getState() != Volume.State.Ready) {
    throw new InvalidParameterValueException("VolumeId: " + volumeId + " is not in "+ Volume.State.Ready+ " state but "+ volume.getState()+ ". Cannot take snapshot.");
  }
  CreateSnapshotPayload payload=new CreateSnapshotPayload();
  payload.setSnapshotId(snapshotId);
  payload.setSnapshotPolicyId(policyId);
  payload.setAccount(account);
  volume.addPayload(payload);
  return this.volService.takeSnapshot(volume);
}
