{
  DataStore storeForRootVol=this.dataStoreMgr.getPrimaryDataStore(rootVolumeOfVm.getPoolId());
  DataStore storeForDataVol=this.dataStoreMgr.getPrimaryDataStore(volume.getPoolId());
  Scope storeForRootStoreScope=storeForRootVol.getScope();
  if (storeForRootStoreScope == null) {
    throw new CloudRuntimeException("Can't get scope of data store: " + storeForRootVol.getId());
  }
  Scope storeForDataStoreScope=storeForDataVol.getScope();
  if (storeForDataStoreScope == null) {
    throw new CloudRuntimeException("Can't get scope of data store: " + storeForDataVol.getId());
  }
  if (storeForDataStoreScope.getScopeType() == ScopeType.ZONE) {
    return false;
  }
  if (storeForRootStoreScope.getScopeType() != storeForDataStoreScope.getScopeType()) {
    throw new CloudRuntimeException("Can't move volume between scope: " + storeForDataStoreScope.getScopeType() + " and "+ storeForRootStoreScope.getScopeType());
  }
  return !storeForRootStoreScope.isSameScope(storeForDataStoreScope);
}
