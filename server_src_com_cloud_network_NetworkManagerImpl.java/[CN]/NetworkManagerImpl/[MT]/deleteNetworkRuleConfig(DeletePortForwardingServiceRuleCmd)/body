{
  Long userId=UserContext.current().getUserId();
  Long netRuleId=cmd.getId();
  Account account=(Account)UserContext.current().getAccountObject();
  if (userId == null) {
    userId=Long.valueOf(1);
  }
  NetworkRuleConfigVO netRule=_networkRuleConfigDao.findById(netRuleId);
  if (netRule != null) {
    SecurityGroupVO sg=_securityGroupDao.findById(netRule.getSecurityGroupId());
    if (account != null) {
      if (!BaseCmd.isAdmin(account.getType())) {
        if (sg.getAccountId() != account.getId()) {
          throw new PermissionDeniedException("Unable to delete port forwarding service rule " + netRuleId + "; account: "+ account.getAccountName()+ " is not the owner");
        }
      }
 else       if (!_domainDao.isChildDomain(account.getDomainId(),sg.getDomainId())) {
        throw new PermissionDeniedException("Unable to delete port forwarding service rule " + netRuleId + "; account: "+ account.getAccountName()+ " is not an admin in the domain hierarchy.");
      }
    }
  }
 else {
    return false;
  }
  return deleteNetworkRuleConfigInternal(userId,netRuleId);
}
