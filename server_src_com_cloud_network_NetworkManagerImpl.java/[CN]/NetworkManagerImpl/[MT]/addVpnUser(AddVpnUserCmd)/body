{
  Long userId=UserContext.current().getUserId();
  Account account=getAccountForApiCommand(cmd.getAccountName(),cmd.getDomainId());
  EventUtils.saveStartedEvent(userId,account.getId(),EventTypes.EVENT_VPN_USER_ADD,"Add VPN user for account: " + account.getAccountName(),cmd.getStartEventId());
  boolean added=addRemoveVpnUser(account,cmd.getUserName(),cmd.getPassword(),true);
  if (added) {
    EventUtils.saveEvent(userId,account.getId(),EventTypes.EVENT_VPN_USER_ADD,"Added a VPN user for account: " + account.getAccountName() + " username= "+ cmd.getUserName());
  }
 else {
    EventUtils.saveEvent(userId,account.getId(),EventVO.LEVEL_ERROR,EventTypes.EVENT_VPN_USER_ADD,"Unable to add VPN user for account: ",account.getAccountName() + " username= " + cmd.getUserName());
  }
  return added;
}
