{
  Long userId=UserContext.current().getUserId();
  Account account=getAccountForApiCommand(cmd.getAccountName(),cmd.getDomainId());
  EventUtils.saveStartedEvent(userId,account.getId(),EventTypes.EVENT_VPN_USER_ADD,"Add VPN user for account: " + account.getAccountName(),cmd.getStartEventId());
  if (!cmd.getUserName().matches("^[a-zA-Z0-9][a-zA-Z0-9@._-]{2,15}$")) {
    throw new InvalidParameterValueException("Username has to be 3-16 characters including alphabets, numbers and the set '@.-_'");
  }
  if (!cmd.getPassword().matches("^[a-zA-Z0-9][a-zA-Z0-9@#+=._-]{2,15}$")) {
    throw new InvalidParameterValueException("Password has to be 3-16 characters including alphabets, numbers and the set '@#+=.-_'");
  }
  boolean added=addRemoveVpnUser(account,cmd.getUserName(),cmd.getPassword(),true);
  if (added) {
    EventUtils.saveEvent(userId,account.getId(),EventTypes.EVENT_VPN_USER_ADD,"Added a VPN user for account: " + account.getAccountName() + " username= "+ cmd.getUserName());
  }
 else {
    EventUtils.saveEvent(userId,account.getId(),EventVO.LEVEL_ERROR,EventTypes.EVENT_VPN_USER_ADD,"Unable to add VPN user for account: ",account.getAccountName() + " username= " + cmd.getUserName());
  }
  return added;
}
