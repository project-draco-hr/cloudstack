{
  boolean result=false;
  Long networkDomainId=null;
  Network network=getNetwork(networkId);
  if (!network.getIsShared()) {
    s_logger.trace("Network id=" + networkId + " is not shared");
    return false;
  }
  List<NetworkVO> networks=_networksDao.listSharedDomainNetworksByNetworkId(networkId);
  if (networks.isEmpty()) {
    s_logger.trace("Network id=" + networkId + " is shared, but not domain specific");
    return true;
  }
 else {
    networkDomainId=networks.get(0).getDomainId();
  }
  if (domainId == networkDomainId.longValue()) {
    return true;
  }
  Domain domain=_domainDao.findById(domainId);
  while (domain.getParent() != null) {
    if (domain.getParent().longValue() == networkDomainId) {
      return true;
    }
    domain=_domainDao.findById(domain.getParent());
  }
  return result;
}
