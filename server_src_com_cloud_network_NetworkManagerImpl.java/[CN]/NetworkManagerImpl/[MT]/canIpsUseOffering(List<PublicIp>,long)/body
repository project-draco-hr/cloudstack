{
  Map<PublicIp,Set<Service>> ipToServices=getIpToServices(publicIps,false);
  Map<Service,Set<Provider>> serviceToProviders=getNetworkOfferingServiceProvidersMap(offeringId);
  for (  PublicIp ip : ipToServices.keySet()) {
    Set<Service> services=ipToServices.get(ip);
    Provider provider=null;
    for (    Service service : services) {
      Provider curProvider=(Provider)serviceToProviders.get(service).toArray()[0];
      if (provider == null) {
        provider=curProvider;
        continue;
      }
      if (!provider.equals(curProvider)) {
        throw new CloudRuntimeException("There would be multiply providers for IP " + ip.getAddress() + " with the new network offering!");
      }
    }
  }
  return true;
}
