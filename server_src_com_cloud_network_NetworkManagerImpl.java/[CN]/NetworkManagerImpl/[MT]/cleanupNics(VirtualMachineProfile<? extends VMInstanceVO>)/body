{
  List<NicVO> nics=_nicDao.listBy(vm.getId());
  for (  NicVO nic : nics) {
    nic.setState(Nic.State.Deallocating);
    _nicDao.update(nic.getId(),nic);
    NetworkVO network=_networksDao.findById(nic.getNetworkId());
    NicProfile profile=new NicProfile(nic,network,null,null,null);
    NetworkGuru guru=_networkGurus.get(network.getGuruName());
    guru.deallocate(network,profile,vm);
    _nicDao.remove(nic.getId());
  }
}
