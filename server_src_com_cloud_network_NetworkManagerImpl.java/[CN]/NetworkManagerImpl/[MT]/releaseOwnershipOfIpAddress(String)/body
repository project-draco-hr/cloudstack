{
  Transaction txn=Transaction.currentTxn();
  txn.start();
  IPAddressVO ip=_ipAddressDao.lockRow(ipAddress,true);
  if (ip == null) {
    s_logger.warn("Unable to find allocated ip: " + ipAddress);
    return null;
  }
  if (ip.getAllocatedTime() == null) {
    s_logger.debug("Ip Address is already rleeased: " + ipAddress);
    return null;
  }
  ip.setAllocatedToAccountId(null);
  ip.setAllocatedInDomainId(null);
  _ipAddressDao.update(ip.getAddress(),ip);
  txn.commit();
  return ip;
}
