{
  if (!areServicesSupportedByNetworkOffering(offering.getId(),service)) {
    throw new UnsupportedServiceException("Service " + service.getName() + " is not supported by the network offering "+ offering);
  }
  Map<Capability,String> serviceCapabilities=new HashMap<Capability,String>();
  String provider=_ntwkOfferingSrvcDao.getProviderForServiceForNetworkOffering(offering.getId(),service);
  NetworkElement element=getElementImplementingProvider(provider);
  if (element != null) {
    Map<Service,Map<Capability,String>> elementCapabilities=element.getCapabilities();
    ;
    if (elementCapabilities == null || elementCapabilities.get(service) == null) {
      throw new UnsupportedServiceException("Service " + service.getName() + " is not supported by the element="+ element.getName()+ " implementing Provider="+ provider);
    }
    serviceCapabilities=elementCapabilities.get(service);
  }
  return serviceCapabilities;
}
