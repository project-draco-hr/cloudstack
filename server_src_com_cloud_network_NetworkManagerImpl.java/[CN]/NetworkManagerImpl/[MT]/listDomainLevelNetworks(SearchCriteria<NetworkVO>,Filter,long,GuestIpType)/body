{
  Set<Long> allowedDomains=new HashSet<Long>();
  if (_allowSubdomainNetworkAccess && guestIpType == GuestIpType.Direct) {
    allowedDomains=_accountMgr.getDomainParentIds(domainId);
  }
 else {
    allowedDomains.add(domainId);
  }
  sc.addJoinAnd("domainNetworkSearch","domainId",SearchCriteria.Op.IN,allowedDomains.toArray());
  sc.addAnd("guestType",SearchCriteria.Op.EQ,guestIpType);
  return _networksDao.search(sc,searchFilter);
}
