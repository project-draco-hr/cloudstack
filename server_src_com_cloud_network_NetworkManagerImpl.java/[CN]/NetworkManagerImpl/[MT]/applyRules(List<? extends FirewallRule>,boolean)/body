{
  if (rules == null || rules.size() == 0) {
    s_logger.debug("There are no rules to forward to the network elements");
    return true;
  }
  boolean success=true;
  Network network=_networksDao.findById(rules.get(0).getNetworkId());
  int found=0;
  for (  NetworkElement ne : _networkElements) {
    try {
      if (!(ne instanceof FirewallServiceProvider) && !(ne instanceof LoadBalancingServiceProvider)) {
        continue;
      }
      found++;
      boolean handled;
      if (ne instanceof FirewallServiceProvider) {
        FirewallServiceProvider e=(FirewallServiceProvider)ne;
        handled=e.applyRules(network,rules);
      }
 else {
        LoadBalancingServiceProvider e=(LoadBalancingServiceProvider)ne;
        handled=e.applyRules(network,rules);
      }
      s_logger.debug("Network Rules for network " + network.getId() + " were "+ (handled ? "" : " not")+ " handled by "+ ne.getName());
    }
 catch (    ResourceUnavailableException e) {
      if (!continueOnError) {
        throw e;
      }
      s_logger.warn("Problems with " + ne.getName() + " but pushing on",e);
      success=false;
    }
  }
  return success;
}
