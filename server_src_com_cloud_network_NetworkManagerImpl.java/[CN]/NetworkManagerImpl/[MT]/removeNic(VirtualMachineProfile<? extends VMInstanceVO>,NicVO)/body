{
  nic.setState(Nic.State.Deallocating);
  _nicDao.update(nic.getId(),nic);
  NetworkVO network=_networksDao.findById(nic.getNetworkId());
  NicProfile profile=new NicProfile(nic,network,null,null,null,isSecurityGroupSupportedInNetwork(network),getNetworkTag(vm.getHypervisorType(),network));
  NetworkGuru guru=Adapters.getAdapterByName(_networkGurus,network.getGuruName());
  guru.deallocate(network,profile,vm);
  _nicDao.remove(nic.getId());
  s_logger.debug("Removed nic id=" + nic.getId());
}
