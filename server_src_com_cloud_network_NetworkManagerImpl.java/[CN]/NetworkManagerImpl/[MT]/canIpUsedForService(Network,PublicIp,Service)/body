{
  NetworkOffering offering=_networkOfferingDao.findById(network.getNetworkOfferingId());
  if (offering.isConserveMode()) {
    List<PublicIp> ipList=new ArrayList<PublicIp>();
    ipList.add(ip);
    Map<PublicIp,Set<Service>> ipToServices=getIpToServices(network,ipList,false);
    Set<Service> currentServices=ipToServices.get(ip);
    if (currentServices == null || currentServices.isEmpty()) {
      return true;
    }
  }
  Map<Service,Set<Provider>> serviceToProviders=getServiceProviderMap(network.getId());
  Set<Provider> currentProviders=serviceToProviders.get(service);
  if (currentProviders.size() > 1) {
    throw new CloudRuntimeException("Can't support multiply providers for same service now!");
  }
  Provider currentProvider=(Provider)currentProviders.toArray()[0];
  return true;
}
