{
  String ipaddr=null;
  Account caller=UserContext.current().getCaller();
  long callerUserId=UserContext.current().getCallerUserId();
  DataCenter zone=_configMgr.getZone(zoneId);
  Network network=_networksDao.findById(networkId);
  _accountMgr.checkAccess(caller,null,false,network);
  ipaddr=acquireGuestIpAddress(network,requestedIp);
  return ipaddr;
}
