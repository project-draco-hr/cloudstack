{
  List<NicVO> nics=_nicDao.listBy(vmProfile.getId());
  for (  NicVO nic : nics) {
    NetworkVO network=_networksDao.findById(nic.getNetworkId());
    if (nic.getReservationStrategy() == ReservationStrategy.Start) {
      NetworkGuru concierge=_networkGurus.get(network.getGuruName());
      nic.setState(Resource.State.Releasing);
      _nicDao.update(nic.getId(),nic);
      NicProfile profile=new NicProfile(nic,network,null,null);
      if (!concierge.release(profile,vmProfile,nic.getReservationId())) {
        nic.setState(Resource.State.Allocated);
        _nicDao.update(nic.getId(),nic);
      }
    }
    _networksDao.changeActiveNicsBy(network.getId(),-1);
  }
}
