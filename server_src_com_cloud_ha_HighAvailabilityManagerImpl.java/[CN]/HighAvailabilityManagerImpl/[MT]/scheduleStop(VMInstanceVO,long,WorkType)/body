{
  assert(type == WorkType.CheckStop || type == WorkType.ForceStop || type == WorkType.Stop);
  if (_haDao.hasBeenScheduled(vm.getId(),type)) {
    logger.info("There's already a job scheduled to stop " + vm);
    return;
  }
  HaWorkVO work=new HaWorkVO(vm.getId(),vm.getType(),type,Step.Scheduled,hostId,vm.getState(),0,vm.getUpdated());
  _haDao.persist(work);
  if (logger.isDebugEnabled()) {
    logger.debug("Scheduled " + work);
  }
  wakeupWorkers();
}
