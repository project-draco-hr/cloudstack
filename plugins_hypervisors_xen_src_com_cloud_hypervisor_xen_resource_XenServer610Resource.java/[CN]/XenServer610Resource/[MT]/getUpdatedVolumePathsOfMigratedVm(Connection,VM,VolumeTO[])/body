{
  List<VolumeTO> volumeToList=new ArrayList<VolumeTO>();
  try {
    Set<VBD> vbds=migratedVm.getVBDs(connection);
    Map<String,VDI> deviceIdToVdiMap=new HashMap<String,VDI>();
    for (    VBD vbd : vbds) {
      VBD.Record vbdr=vbd.getRecord(connection);
      if (vbdr.type == Types.VbdType.DISK) {
        VDI vdi=vbdr.VDI;
        deviceIdToVdiMap.put(vbdr.userdevice,vdi);
      }
    }
    for (    VolumeTO volumeTo : volumes) {
      Long deviceId=volumeTo.getDeviceId();
      VDI vdi=deviceIdToVdiMap.get(deviceId.toString());
      volumeTo.setPath(vdi.getUuid(connection));
      volumeToList.add(volumeTo);
    }
  }
 catch (  Exception e) {
    s_logger.error("Unable to get the updated VDI paths of the migrated vm " + e.toString(),e);
    throw new CloudRuntimeException("Unable to get the updated VDI paths of the migrated vm " + e.toString(),e);
  }
  return volumeToList;
}
