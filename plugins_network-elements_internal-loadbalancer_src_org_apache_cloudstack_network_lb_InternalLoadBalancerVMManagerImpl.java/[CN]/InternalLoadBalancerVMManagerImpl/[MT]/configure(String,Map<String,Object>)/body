{
  final Map<String,String> configs=_configDao.getConfiguration("AgentManager",params);
  _instance=configs.get("instance.name");
  if (_instance == null) {
    _instance="DEFAULT";
  }
  _mgmtHost=configs.get("host");
  _mgmtCidr=_configDao.getValue(Config.ManagementNetwork.key());
  String offIdStr=configs.get(Config.InternalLbVmServiceOfferingId.key());
  if (offIdStr != null && !offIdStr.isEmpty()) {
    _internalLbVmOfferingId=Long.parseLong(offIdStr);
  }
 else {
    boolean useLocalStorage=Boolean.parseBoolean(configs.get(Config.SystemVMUseLocalStorage.key()));
    ServiceOfferingVO newOff=new ServiceOfferingVO("System Offering For Internal LB VM",1,InternalLoadBalancerVMManager.DEFAULT_INTERNALLB_VM_RAMSIZE,InternalLoadBalancerVMManager.DEFAULT_INTERNALLB_VM_CPU_MHZ,null,null,true,null,useLocalStorage,true,null,true,VirtualMachine.Type.InternalLoadBalancerVm,true);
    newOff.setUniqueName(ServiceOffering.internalLbVmDefaultOffUniqueName);
    newOff=_serviceOfferingDao.persistSystemServiceOffering(newOff);
    _internalLbVmOfferingId=newOff.getId();
  }
  _itMgr.registerGuru(VirtualMachine.Type.InternalLoadBalancerVm,this);
  if (s_logger.isInfoEnabled()) {
    s_logger.info(getName() + " has been configured");
  }
  return true;
}
