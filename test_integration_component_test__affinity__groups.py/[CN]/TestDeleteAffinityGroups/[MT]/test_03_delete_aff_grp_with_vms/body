def test_03_delete_aff_grp_with_vms(self):
    '\n            Delete Afifnity Group which has vms in it.\n        '
    self.create_aff_grp(aff_grp=self.services['host_anti_affinity_0'], acc=self.account.name, domainid=self.domain.id)
    self.create_aff_grp(aff_grp=self.services['host_anti_affinity_1'], acc=self.account.name, domainid=self.domain.id)
    (vm, hostid) = self.create_vm_in_aff_grps([self.aff_grp[0].name, self.aff_grp[1].name])
    AffinityGroup.delete(self.api_client, account=self.account.name, domainid=self.domain.id, name=self.aff_grp[0].name)
    vm_list = list_virtual_machines(self.apiclient, id=self.virtual_machine.id)
    vm.delete(self.api_client)
    wait_for_cleanup(self.apiclient, ['expunge.delay', 'expunge.interval'])
    AffinityGroup.delete(self.api_client, account=self.account.name, domainid=self.domain.id, name=self.aff_grp[0].name)
    AffinityGroup.delete(self.api_client, account=self.account.name, domainid=self.domain.id, name=self.aff_grp[1].name)
