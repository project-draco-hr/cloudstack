{
  VpcGatewayVO vo=_vpcGatewayDao.acquireInLockTable(gatewayId);
  if (vo == null) {
    throw new ConcurrentOperationException("Unable to lock gateway " + gatewayId);
  }
  try {
    PrivateGateway gateway=getVpcPrivateGateway(gatewayId);
    if (getVpcElement().createPrivateGateway(gateway)) {
      s_logger.debug("Private gateway " + gateway + " was applied succesfully on the backend");
      if (vo.getState() != VpcGateway.State.Ready) {
        vo.setState(VpcGateway.State.Ready);
        _vpcGatewayDao.update(vo.getId(),vo);
        s_logger.debug("Marke gateway " + gateway + " with state "+ VpcGateway.State.Ready);
      }
      return getVpcPrivateGateway(gatewayId);
    }
 else {
      s_logger.warn("Private gateway " + gateway + " failed to apply on the backend");
      return null;
    }
  }
  finally {
    if (vo != null) {
      _vpcGatewayDao.releaseFromLockTable(gatewayId);
    }
  }
}
