{
  logger.debug("Cleaning up resources for vpc id=" + vpcId);
  boolean success=true;
  logger.debug("Cleaning up existed site to site VPN connections");
  _s2sVpnMgr.cleanupVpnConnectionByVpc(vpcId);
  logger.debug("Cleaning up existed site to site VPN gateways");
  _s2sVpnMgr.cleanupVpnGatewayByVpc(vpcId);
  final List<IPAddressVO> ipsToRelease=_ipAddressDao.listByAssociatedVpc(vpcId,null);
  logger.debug("Releasing ips for vpc id=" + vpcId + " as a part of vpc cleanup");
  for (  final IPAddressVO ipToRelease : ipsToRelease) {
    if (ipToRelease.isPortable()) {
      ipToRelease.setVpcId(null);
      ipToRelease.setAssociatedWithNetworkId(null);
      _ipAddressDao.update(ipToRelease.getId(),ipToRelease);
      logger.debug("Portable IP address " + ipToRelease + " is no longer associated with any VPC");
    }
 else {
      success=success && _ipAddrMgr.disassociatePublicIpAddress(ipToRelease.getId(),callerUserId,caller);
      if (!success) {
        logger.warn("Failed to cleanup ip " + ipToRelease + " as a part of vpc id="+ vpcId+ " cleanup");
      }
    }
  }
  if (success) {
    logger.debug("Released ip addresses for vpc id=" + vpcId + " as a part of cleanup vpc process");
  }
 else {
    logger.warn("Failed to release ip addresses for vpc id=" + vpcId + " as a part of cleanup vpc process");
  }
  if (!revokeStaticRoutesForVpc(vpcId,caller)) {
    logger.warn("Failed to revoke static routes for vpc " + vpcId + " as a part of cleanup vpc process");
    return false;
  }
  final List<PrivateGateway> gateways=getVpcPrivateGateways(vpcId);
  if (gateways != null) {
    for (    final PrivateGateway gateway : gateways) {
      if (gateway != null) {
        logger.debug("Deleting private gateway " + gateway + " as a part of vpc "+ vpcId+ " resources cleanup");
        if (!deleteVpcPrivateGateway(gateway.getId())) {
          success=false;
          logger.debug("Failed to delete private gateway " + gateway + " as a part of vpc "+ vpcId+ " resources cleanup");
        }
 else {
          logger.debug("Deleted private gateway " + gateway + " as a part of vpc "+ vpcId+ " resources cleanup");
        }
      }
    }
  }
  return success;
}
