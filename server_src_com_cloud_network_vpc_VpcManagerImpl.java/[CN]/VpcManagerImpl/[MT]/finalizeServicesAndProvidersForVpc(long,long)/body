{
  Map<String,String> svcProviders=new HashMap<String,String>();
  Map<String,List<String>> providerSvcs=new HashMap<String,List<String>>();
  List<VpcOfferingServiceMapVO> servicesMap=_vpcOffSvcMapDao.listByVpcOffId(offeringId);
  for (  VpcOfferingServiceMapVO serviceMap : servicesMap) {
    if (svcProviders.containsKey(serviceMap.getService())) {
      continue;
    }
    String service=serviceMap.getService();
    String provider=serviceMap.getProvider();
    if (provider == null) {
      provider=Provider.VPCVirtualRouter.getName();
    }
    if (!vpcProviderEnabledInZone(zoneId,provider)) {
      throw new InvalidParameterValueException("Provider " + provider + " should be enabled in at least one physical network of the zone specified");
    }
    svcProviders.put(service,provider);
    List<String> l=providerSvcs.get(provider);
    if (l == null) {
      providerSvcs.put(provider,l=new ArrayList<String>());
    }
    l.add(service);
  }
  return svcProviders;
}
