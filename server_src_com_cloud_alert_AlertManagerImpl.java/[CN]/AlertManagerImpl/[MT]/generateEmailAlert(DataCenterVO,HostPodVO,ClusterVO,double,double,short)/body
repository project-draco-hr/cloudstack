{
  String msgSubject=null;
  String msgContent=null;
  String totalStr;
  String usedStr;
  String pctStr=formatPercent(usedCapacity / totalCapacity);
switch (capacityType) {
case CapacityVO.CAPACITY_TYPE_MEMORY:
    msgSubject="System Alert: Low Available Memory in pod " + pod.getName() + " of availablity zone "+ dc.getName();
  totalStr=formatBytesToMegabytes(totalCapacity);
usedStr=formatBytesToMegabytes(usedCapacity);
msgContent="System memory is low, total: " + totalStr + " MB, used: "+ usedStr+ " MB ("+ pctStr+ "%)";
break;
case CapacityVO.CAPACITY_TYPE_CPU:
msgSubject="System Alert: Low Unallocated CPU in pod " + pod.getName() + " of availablity zone "+ dc.getName();
totalStr=_dfWhole.format(totalCapacity);
usedStr=_dfWhole.format(usedCapacity);
msgContent="Unallocated CPU is low, total: " + totalStr + " Mhz, used: "+ usedStr+ " Mhz ("+ pctStr+ "%)";
break;
case CapacityVO.CAPACITY_TYPE_STORAGE:
msgSubject="System Alert: Low Available Storage in pod " + pod.getName() + " of availablity zone "+ dc.getName();
totalStr=formatBytesToMegabytes(totalCapacity);
usedStr=formatBytesToMegabytes(usedCapacity);
msgContent="Available storage space is low, total: " + totalStr + " MB, used: "+ usedStr+ " MB ("+ pctStr+ "%)";
break;
case CapacityVO.CAPACITY_TYPE_STORAGE_ALLOCATED:
msgSubject="System Alert: Remaining unallocated Storage is low in pod " + pod.getName() + " of availablity zone "+ dc.getName();
totalStr=formatBytesToMegabytes(totalCapacity);
usedStr=formatBytesToMegabytes(usedCapacity);
msgContent="Unallocated storage space is low, total: " + totalStr + " MB, allocated: "+ usedStr+ " MB ("+ pctStr+ "%)";
break;
case CapacityVO.CAPACITY_TYPE_VIRTUAL_NETWORK_PUBLIC_IP:
msgSubject="System Alert: Number of unallocated public IPs is low in availablity zone " + dc.getName();
totalStr=Double.toString(totalCapacity);
usedStr=Double.toString(usedCapacity);
msgContent="Number of unallocated public IPs is low, total: " + totalStr + ", allocated: "+ usedStr+ " ("+ pctStr+ "%)";
break;
case CapacityVO.CAPACITY_TYPE_PRIVATE_IP:
msgSubject="System Alert: Number of unallocated private IPs is low in pod " + pod.getName() + " of availablity zone "+ dc.getName();
totalStr=Double.toString(totalCapacity);
usedStr=Double.toString(usedCapacity);
msgContent="Number of unallocated private IPs is low, total: " + totalStr + ", allocated: "+ usedStr+ " ("+ pctStr+ "%)";
break;
case CapacityVO.CAPACITY_TYPE_SECONDARY_STORAGE:
msgSubject="System Alert: Low Available Storage in availablity zone " + dc.getName();
totalStr=Double.toString(totalCapacity);
usedStr=Double.toString(usedCapacity);
msgContent="Available secondary storage space is low, total: " + totalStr + " MB, used: "+ usedStr+ " MB ("+ pctStr+ "%)";
break;
}
try {
_emailAlert.sendAlert(capacityType,dc.getId(),null,msgSubject,msgContent);
}
 catch (Exception ex) {
s_logger.error("Exception in CapacityChecker",ex);
}
}
