{
  if (action == StorageAction.TAKESNAPSHOT) {
    SnapshotInfo snapshotInfo=(SnapshotInfo)object;
    if (snapshotInfo.getHypervisorType() == Hypervisor.HypervisorType.KVM) {
      VolumeInfo volumeInfo=snapshotInfo.getBaseVolume();
      VirtualMachine vm=volumeInfo.getAttachedVM();
      if ((vm != null) && (vm.getState() == VirtualMachine.State.Running)) {
        Long hostId=vm.getHostId();
        return getEndPointFromHostId(hostId);
      }
    }
  }
 else   if (action == StorageAction.MIGRATEVOLUME) {
    VolumeInfo volume=(VolumeInfo)object;
    if (volume.getHypervisorType() == Hypervisor.HypervisorType.Hyperv) {
      VirtualMachine vm=volume.getAttachedVM();
      if ((vm != null) && (vm.getState() == VirtualMachine.State.Running)) {
        Long hostId=vm.getHostId();
        return getEndPointFromHostId(hostId);
      }
    }
  }
  return select(object);
}
