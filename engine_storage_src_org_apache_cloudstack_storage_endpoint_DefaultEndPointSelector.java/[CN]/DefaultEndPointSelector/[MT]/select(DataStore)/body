{
  if (store.getRole() == DataStoreRole.Primary) {
    return findEndpointForPrimaryStorage(store);
  }
 else   if (store.getRole() == DataStoreRole.Image || store.getRole() == DataStoreRole.ImageCache) {
    return findEndpointForImageStorage(store);
  }
 else {
    throw new CloudRuntimeException("not implemented yet");
  }
}
