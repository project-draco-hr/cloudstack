{
  File witnessFile=new File(witness);
  if (witnessFile.exists()) {
    int skipIndex=0;
    byte[] expected=new byte[actual.length];
    FileInputStream is=new FileInputStream(witnessFile);
    int bytesRead=is.read(expected);
    is.close();
    if (bytesRead < endCompare) {
      TestCase.assertEquals(bytesRead,actual.length);
    }
    int endScan=actual.length;
    if (endScan > endCompare) {
      endScan=endCompare;
    }
    for (int i=0; i < endScan; i++) {
      if ((skipIndex < skip.length) && (skip[skipIndex] == i)) {
        skipIndex++;
      }
 else {
        if (expected[i] != actual[i]) {
          TestCase.assertEquals("Difference at offset " + i,expected[i],actual[i]);
        }
      }
    }
  }
 else {
    FileOutputStream os=new FileOutputStream(witnessFile);
    os.write(actual);
    os.close();
    TestCase.fail("Writing witness file " + witness);
  }
}
