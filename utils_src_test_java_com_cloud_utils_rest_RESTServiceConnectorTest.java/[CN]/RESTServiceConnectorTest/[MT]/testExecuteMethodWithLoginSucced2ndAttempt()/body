{
  final GetMethod gm=mock(GetMethod.class);
  when(gm.getStatusCode()).thenReturn(HttpStatus.SC_UNAUTHORIZED).thenReturn(HttpStatus.SC_UNAUTHORIZED);
  final RESTValidationStrategy previousValidationStrategy=connector.validation;
  connector.validation=new RESTValidationStrategy(){
    @Override protected void login(    final String protocol,    final HttpClient client) throws CloudstackRESTException {
    }
  }
;
  connector.setAdminCredentials("admin","adminpass");
  connector.setControllerAddress("localhost");
  connector.executeMethod(gm);
  connector.validation=previousValidationStrategy;
  verify(gm,times(2)).getStatusCode();
}
