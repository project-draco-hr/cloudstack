{
  if (args.length < 2) {
    printHelp("DatabaseCreator");
    System.exit(1);
  }
  for (int i=0; i < args.length; i++) {
    if (args[i].endsWith("sql")) {
      File sqlScript=PropertiesUtil.findConfigFile(args[i]);
      if (sqlScript == null) {
        System.err.println("Unable to find " + args[i]);
        printHelp("DatabaseCreator");
        System.exit(1);
      }
      System.out.println("=============> Processing SQL file at " + sqlScript.getAbsolutePath());
      Connection conn=Transaction.getStandaloneConnection();
      try {
        ScriptRunner runner=new ScriptRunner(conn,false,true);
        FileReader reader=null;
        try {
          reader=new FileReader(sqlScript);
        }
 catch (        FileNotFoundException e) {
          System.err.println("Unable to read " + args[i] + ": "+ e.getMessage());
          System.exit(1);
        }
        try {
          runner.runScript(reader);
        }
 catch (        IOException e) {
          System.err.println("Unable to read " + args[i] + ": "+ e.getMessage());
          System.exit(1);
        }
catch (        SQLException e) {
          System.err.println("Unable to execute " + args[i] + ": "+ e.getMessage());
          System.exit(1);
        }
      }
  finally {
        try {
          conn.close();
        }
 catch (        SQLException e) {
          System.err.println("Unable to close DB connection: " + e.getMessage());
        }
      }
    }
 else {
      System.out.println("=============> Processing upgrade: " + args[i]);
      Class<?> clazz=null;
      try {
        clazz=Class.forName(args[i]);
        if (!SystemIntegrityChecker.class.isAssignableFrom(clazz)) {
          System.err.println("The class must be of SystemIntegrityChecker: " + clazz.getName());
          System.exit(1);
        }
      }
 catch (      ClassNotFoundException e) {
        System.err.println("Unable to find " + args[i] + ": "+ e.getMessage());
        System.exit(1);
      }
    }
  }
}
