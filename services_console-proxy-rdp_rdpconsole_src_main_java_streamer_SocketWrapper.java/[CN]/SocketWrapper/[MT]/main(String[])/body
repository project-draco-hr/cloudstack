{
  try {
    System.setProperty("streamer.Link.debug","true");
    System.setProperty("streamer.Element.debug","true");
    System.setProperty("rdpclient.MockServer.debug","true");
    Pipeline pipeline=new PipelineImpl("echo client");
    SocketWrapper socketWrapper=new SocketWrapper("socket");
    pipeline.add(socketWrapper);
    pipeline.add(new BaseElement("echo"));
    pipeline.link("socket","echo","socket");
    final byte[] mockData=new byte[]{0x01,0x02,0x03};
    MockServer server=new MockServer(new Packet[]{new Packet("Server hello"){
{
        type=SERVER;
        data=mockData;
      }
    }
,new Packet("Client hello"){
{
        type=CLIENT;
        data=mockData;
      }
    }
,new Packet("Server hello"){
{
        type=SERVER;
        data=mockData;
      }
    }
,new Packet("Client hello"){
{
        type=CLIENT;
        data=mockData;
      }
    }
});
    server.start();
    InetSocketAddress address=server.getAddress();
    socketWrapper.connect(address);
  }
 catch (  IOException e) {
    e.printStackTrace(System.err);
  }
}
