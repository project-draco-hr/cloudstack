{
  SearchBuilder<AclGroupAccountMapVO> groupSB=_aclGroupAccountMapDao.createSearchBuilder();
  groupSB.and("account",groupSB.entity().getAccountId(),Op.EQ);
  GenericSearchBuilder<AclGroupRoleMapVO,Long> roleSB=_aclGroupRoleMapDao.createSearchBuilder(Long.class);
  roleSB.selectFields(roleSB.entity().getAclRoleId());
  roleSB.join("accountgroupjoin",groupSB,groupSB.entity().getAclGroupId(),roleSB.entity().getAclGroupId(),JoinType.INNER);
  roleSB.done();
  SearchCriteria<Long> roleSc=roleSB.create();
  roleSc.setJoinParameters("accountgroupjoin","account",accountId);
  List<Long> roleIds=_aclGroupRoleMapDao.customSearch(roleSc,null);
  SearchBuilder<AclRoleVO> sb=_aclRoleDao.createSearchBuilder();
  sb.and("ids",sb.entity().getId(),Op.IN);
  SearchCriteria<AclRoleVO> sc=sb.create();
  sc.setParameters("ids",roleIds.toArray(new Object[roleIds.size()]));
  List<AclRoleVO> roles=_aclRoleDao.customSearch(sc,null);
  return new ArrayList<AclRole>(roles);
}
