{
  Account caller=CallContext.current().getCallingAccount();
  AclGroup group=_aclGroupDao.findById(groupId);
  if (group == null) {
    throw new InvalidParameterValueException("Unable to find acl group: " + groupId + "; failed to add roles to acl group.");
  }
  _accountMgr.checkAccess(caller,null,true,group);
  Transaction txn=Transaction.currentTxn();
  txn.start();
  for (  Long roleId : roleIds) {
    AclRole role=_aclRoleDao.findById(roleId);
    if (role == null) {
      throw new InvalidParameterValueException("Unable to find acl role: " + roleId + "; failed to add roles to acl group.");
    }
    _accountMgr.checkAccess(caller,null,true,role);
    AclGroupRoleMapVO grMap=_aclGroupRoleMapDao.findByGroupAndRole(groupId,roleId);
    if (grMap == null) {
      grMap=new AclGroupRoleMapVO(groupId,roleId);
      _aclGroupRoleMapDao.persist(grMap);
    }
  }
  txn.commit();
  return group;
}
