{
  Account caller=CallContext.current().getCallingAccount();
  AclGroup group=_aclGroupDao.findById(aclGroupId);
  if (group == null) {
    throw new InvalidParameterValueException("Unable to find acl group: " + aclGroupId + "; failed to revoke permission from group.");
  }
  _accountMgr.checkAccess(caller,null,true,group);
  Class entityClass=entityClassMap.get(entityType);
  if (entityClass == null) {
    throw new InvalidParameterValueException("Entity type " + entityType + " permission revoke is not supported yet");
  }
  ControlledEntity entity=(ControlledEntity)_entityMgr.findById(entityClass,entityId);
  if (entity == null) {
    throw new InvalidParameterValueException("Unable to find entity " + entityType + " by id: "+ entityId);
  }
  _accountMgr.checkAccess(caller,null,true,entity);
  AclEntityPermissionVO perm=_entityPermissionDao.findByGroupAndEntity(aclGroupId,entityType,entityId,accessType);
  if (perm != null) {
    _entityPermissionDao.remove(perm.getId());
  }
  return group;
}
