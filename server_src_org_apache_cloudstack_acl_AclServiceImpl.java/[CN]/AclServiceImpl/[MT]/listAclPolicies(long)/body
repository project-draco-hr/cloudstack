{
  SearchBuilder<AclGroupAccountMapVO> groupSB=_aclGroupAccountMapDao.createSearchBuilder();
  groupSB.and("account",groupSB.entity().getAccountId(),Op.EQ);
  GenericSearchBuilder<AclGroupPolicyMapVO,Long> policySB=_aclGroupPolicyMapDao.createSearchBuilder(Long.class);
  policySB.selectFields(policySB.entity().getAclPolicyId());
  policySB.join("accountgroupjoin",groupSB,groupSB.entity().getAclGroupId(),policySB.entity().getAclGroupId(),JoinType.INNER);
  policySB.done();
  SearchCriteria<Long> policySc=policySB.create();
  policySc.setJoinParameters("accountgroupjoin","account",accountId);
  List<Long> roleIds=_aclGroupPolicyMapDao.customSearch(policySc,null);
  SearchBuilder<AclPolicyVO> sb=_aclPolicyDao.createSearchBuilder();
  sb.and("ids",sb.entity().getId(),Op.IN);
  SearchCriteria<AclPolicyVO> sc=sb.create();
  sc.setParameters("ids",roleIds.toArray(new Object[roleIds.size()]));
  List<AclPolicyVO> policies=_aclPolicyDao.customSearch(sc,null);
  return new ArrayList<AclPolicy>(policies);
}
