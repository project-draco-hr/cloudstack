{
  if (_domainDao == null) {
    ComponentLocator locator=ComponentLocator.getLocator(ManagementServer.Name);
    _domainDao=locator.getDao(DomainDao.class);
    DomainSearch=createSearchBuilder();
    DomainSearch.and("domainId",DomainSearch.entity().getDomainId(),SearchCriteria.Op.EQ);
    SearchBuilder<DomainVO> domainSearch=_domainDao.createSearchBuilder();
    domainSearch.and("path",domainSearch.entity().getPath(),SearchCriteria.Op.LIKE);
    DomainSearch.join("domainSearch",domainSearch,DomainSearch.entity().getDomainId(),domainSearch.entity().getId());
    DomainSearch.done();
  }
  Filter searchFilter=new Filter(NetworkGroupRulesVO.class,"id",true,null,null);
  SearchCriteria<NetworkGroupRulesVO> sc=DomainSearch.create();
  if (!recursive) {
    sc.setParameters("domainId",domainId);
  }
  DomainVO domain=_domainDao.findById(domainId);
  if (domain != null) {
    sc.setJoinParameters("domainSearch","path",domain.getPath() + "%");
  }
  return listActiveBy(sc,searchFilter);
}
