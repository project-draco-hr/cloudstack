from cloudstackAPI import *
import cloudstackException
import cloudstackTestClient
import sys
if (__name__ == '__main__'):
    ' to logging the testclient\n    logger = logging.getLogger("test_async")\n    fh = logging.FileHandler("test.log")\n    logger.addHandler(fh)\n    logger.setLevel(logging.DEBUG)\n    testclient = cloudstackTestClient.cloudstackTestClient(mgtSvr="localhost", logging=logger)\n    '
    testclient = cloudstackTestClient.cloudstackTestClient(mgtSvr='localhost')
    testclient.dbConfigure()
    api = testclient.getApiClient()
    testclient.submitJob(jobs(1), 10, 10, 1)
    js = []
    for i in range(10):
        js.append(jobs(1))
    testclient.submitJobs(js, 10, 1)
    cmds = []
    for i in range(20):
        cmd = destroyVirtualMachine.destroyVirtualMachineCmd()
        cmd.id = (4 + i)
        cmds.append(cmd)
    asyncJobResult = testclient.submitCmdsAndWait(cmds)
    for (handle, jobStatus) in asyncJobResult.iteritems():
        if jobStatus.status:
            print jobStatus.result.id, jobStatus.result.templatename, jobStatus.startTime, jobStatus.endTime
        else:
            print jobStatus.result, jobStatus.startTime, jobStatus.endTime
        print jobStatus.duration
