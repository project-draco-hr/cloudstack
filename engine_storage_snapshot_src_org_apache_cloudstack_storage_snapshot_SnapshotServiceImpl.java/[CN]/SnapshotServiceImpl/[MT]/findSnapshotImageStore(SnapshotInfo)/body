{
  if (snapshot.getParent() == null) {
    return dataStoreMgr.getImageStore(snapshot.getDataCenterId());
  }
 else {
    SnapshotInfo parentSnapshot=snapshot.getParent();
    SnapshotDataStoreVO parentSnapshotOnBackupStore=_snapshotStoreDao.findBySnapshot(parentSnapshot.getId(),DataStoreRole.Image);
    if (parentSnapshotOnBackupStore == null) {
      return dataStoreMgr.getImageStore(snapshot.getDataCenterId());
    }
    return dataStoreMgr.getDataStore(parentSnapshotOnBackupStore.getDataStoreId(),parentSnapshotOnBackupStore.getRole());
  }
}
