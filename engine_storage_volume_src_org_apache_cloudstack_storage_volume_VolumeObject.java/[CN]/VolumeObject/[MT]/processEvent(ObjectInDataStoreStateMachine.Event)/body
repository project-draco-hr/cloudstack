{
  if (this.dataStore == null) {
    return;
  }
  try {
    Volume.Event volEvent=null;
    if (this.dataStore.getRole() == DataStoreRole.Image) {
      ojbectInStoreMgr.update(this,event);
      if (event == ObjectInDataStoreStateMachine.Event.CreateRequested) {
        volEvent=Volume.Event.UploadRequested;
      }
 else       if (event == ObjectInDataStoreStateMachine.Event.OperationSuccessed) {
        volEvent=Volume.Event.CopySucceeded;
      }
 else       if (event == ObjectInDataStoreStateMachine.Event.OperationFailed) {
        volEvent=Volume.Event.CopyFailed;
      }
    }
 else {
      if (event == ObjectInDataStoreStateMachine.Event.CreateRequested || event == ObjectInDataStoreStateMachine.Event.CreateOnlyRequested) {
        volEvent=Volume.Event.CreateRequested;
      }
 else       if (event == ObjectInDataStoreStateMachine.Event.CopyingRequested) {
        volEvent=Volume.Event.CopyRequested;
      }
    }
    if (event == ObjectInDataStoreStateMachine.Event.DestroyRequested) {
      volEvent=Volume.Event.DestroyRequested;
    }
 else     if (event == ObjectInDataStoreStateMachine.Event.ExpungeRequested) {
      volEvent=Volume.Event.ExpungingRequested;
    }
 else     if (event == ObjectInDataStoreStateMachine.Event.OperationSuccessed) {
      volEvent=Volume.Event.OperationSucceeded;
    }
 else     if (event == ObjectInDataStoreStateMachine.Event.OperationFailed) {
      volEvent=Volume.Event.OperationFailed;
    }
 else     if (event == ObjectInDataStoreStateMachine.Event.ResizeRequested) {
      volEvent=Volume.Event.ResizeRequested;
    }
    this.stateTransit(volEvent);
  }
 catch (  Exception e) {
    s_logger.debug("Failed to update state",e);
    throw new CloudRuntimeException("Failed to update state:" + e.toString());
  }
}
