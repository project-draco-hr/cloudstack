{
  try {
    if (this.dataStore.getRole() == DataStoreRole.Primary) {
      if (answer instanceof CopyCmdAnswer) {
        CopyCmdAnswer cpyAnswer=(CopyCmdAnswer)answer;
        VolumeVO vol=this.volumeDao.findById(this.getId());
        VolumeObjectTO newVol=(VolumeObjectTO)cpyAnswer.getNewData();
        vol.setPath(newVol.getPath());
        vol.setSize(newVol.getSize());
        vol.setPoolId(this.getDataStore().getId());
        volumeDao.update(vol.getId(),vol);
      }
 else       if (answer instanceof CreateObjectAnswer) {
        CreateObjectAnswer createAnswer=(CreateObjectAnswer)answer;
        VolumeObjectTO newVol=(VolumeObjectTO)createAnswer.getData();
        VolumeVO vol=this.volumeDao.findById(this.getId());
        vol.setPath(newVol.getPath());
        vol.setSize(newVol.getSize());
        vol.setPoolId(this.getDataStore().getId());
        volumeDao.update(vol.getId(),vol);
      }
    }
 else {
      if (answer instanceof DownloadAnswer) {
        DownloadAnswer dwdAnswer=(DownloadAnswer)answer;
        VolumeDataStoreVO volStore=this.volumeStoreDao.findByStoreVolume(this.dataStore.getId(),this.getId());
        volStore.setInstallPath(dwdAnswer.getInstallPath());
        volStore.setChecksum(dwdAnswer.getCheckSum());
        this.volumeStoreDao.update(volStore.getId(),volStore);
      }
 else       if (answer instanceof CopyCmdAnswer) {
        CopyCmdAnswer cpyAnswer=(CopyCmdAnswer)answer;
        VolumeDataStoreVO volStore=this.volumeStoreDao.findByStoreVolume(this.dataStore.getId(),this.getId());
        VolumeObjectTO newVol=(VolumeObjectTO)cpyAnswer.getNewData();
        volStore.setInstallPath(newVol.getPath());
        volStore.setSize(newVol.getSize());
        this.volumeStoreDao.update(volStore.getId(),volStore);
      }
    }
  }
 catch (  RuntimeException ex) {
    if (event == ObjectInDataStoreStateMachine.Event.OperationFailed) {
      objectInStoreMgr.delete(this);
    }
    throw ex;
  }
  this.processEvent(event);
}
