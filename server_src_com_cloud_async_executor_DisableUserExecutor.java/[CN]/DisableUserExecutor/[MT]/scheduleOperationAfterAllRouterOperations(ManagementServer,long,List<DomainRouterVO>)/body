{
  AsyncJobManager asyncMgr=getAsyncJobMgr();
  AsyncJobVO job=getJob();
  Transaction txn=Transaction.currentTxn();
  try {
    txn.start();
    asyncMgr.updateAsyncJobStatus(job.getId(),routers.size(),"");
    for (    DomainRouterVO router : routers) {
      if (s_logger.isInfoEnabled())       s_logger.info("Serialize DisableUser operation with previous activities on router " + router.getId());
      asyncMgr.syncAsyncJobExecution(job.getId(),"Router",router.getId());
    }
    txn.commit();
  }
 catch (  Exception e) {
    txn.rollback();
    s_logger.warn("Unexpected exception " + e.getMessage(),e);
    asyncMgr.completeAsyncJob(getJob().getId(),AsyncJobResult.STATUS_FAILED,BaseCmd.INTERNAL_ERROR,e.getMessage());
  }
}
