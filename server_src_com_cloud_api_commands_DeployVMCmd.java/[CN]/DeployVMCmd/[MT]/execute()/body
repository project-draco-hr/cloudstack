{
  try {
    String password=null;
    if (templateId != null) {
      VMTemplateVO template=ApiDBUtils.findTemplateById(templateId);
      if (template.getEnablePassword()) {
        password=BaseCmd._mgr.generateRandomPassword();
      }
    }
    UserVm result=BaseCmd._mgr.deployVirtualMachine(this,password);
    UserVmResponse response=ApiResponseHelper.createUserVmResponse(result);
    response.setPassword(password);
    response.setResponseName(getName());
    this.setResponseObject(response);
  }
 catch (  ResourceAllocationException ex) {
    throw new ServerApiException(BaseCmd.INTERNAL_ERROR,ex.getMessage());
  }
catch (  ExecutionException ex1) {
    throw new ServerApiException(BaseCmd.INTERNAL_ERROR,ex1.getMessage());
  }
}
