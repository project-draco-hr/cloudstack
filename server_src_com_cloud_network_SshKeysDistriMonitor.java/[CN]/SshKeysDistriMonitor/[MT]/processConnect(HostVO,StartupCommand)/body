{
  if (cmd instanceof StartupRoutingCommand) {
    if (((StartupRoutingCommand)cmd).getHypervisorType() == HypervisorType.KVM || ((StartupRoutingCommand)cmd).getHypervisorType() == HypervisorType.XenServer) {
      Map<String,String> configs=_configDao.getConfiguration("management-server",new HashMap<String,Object>());
      String pubKey=configs.get("ssh.publickey");
      String prvKey=configs.get("ssh.privatekey");
      if (!_routerMgr.sendSshKeysToHost(host.getId(),pubKey,prvKey)) {
        s_logger.debug("Failed to send keys to agent: " + host.getId());
        throw new ConnectionException(true,"Unable to send keys to the agent");
      }
    }
  }
}
