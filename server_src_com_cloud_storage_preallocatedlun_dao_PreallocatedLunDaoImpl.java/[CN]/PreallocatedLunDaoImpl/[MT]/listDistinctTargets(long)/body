{
  String DistinctTargetSearchSql="SELECT * FROM ext_lun_alloc where data_center_id = ? GROUP BY target_iqn";
  Transaction txn=Transaction.currentTxn();
  try {
    PreparedStatement ps=txn.prepareAutoCloseStatement(DistinctTargetSearchSql);
    ps.setLong(1,dataCenterId);
    ResultSet rs=ps.executeQuery();
    List<PreallocatedLunVO> lst=new ArrayList<PreallocatedLunVO>();
    while (rs.next()) {
      lst.add(toEntityBean(rs,false));
    }
    return lst;
  }
 catch (  SQLException e) {
    throw new CloudRuntimeException("Unable to execute " + DistinctTargetSearchSql,e);
  }
}
