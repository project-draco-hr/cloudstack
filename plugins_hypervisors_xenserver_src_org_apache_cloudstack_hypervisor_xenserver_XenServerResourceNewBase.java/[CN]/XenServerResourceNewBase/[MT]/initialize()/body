{
  StartupCommand[] cmds=super.initialize();
  Connection conn=getConnection();
  Pool pool;
  try {
    pool=Pool.getByUuid(conn,_host.pool);
    Pool.Record poolr=pool.getRecord(conn);
    Host.Record masterRecord=poolr.master.getRecord(conn);
    if (_host.uuid.equals(masterRecord.uuid)) {
      _listener=new VmEventListener(true);
    }
 else {
      _listener=new VmEventListener(false);
    }
  }
 catch (  XenAPIException e) {
    throw new CloudRuntimeException("Unable to determine who is the master",e);
  }
catch (  XmlRpcException e) {
    throw new CloudRuntimeException("Unable to determine who is the master",e);
  }
  return cmds;
}
