{
  s_logger.debug("delete snapshot chain for snapshot: " + snapshot.getId());
  boolean result=false;
  while (snapshot != null && (snapshot.getState() == Snapshot.State.Destroying || snapshot.getState() == Snapshot.State.Destroyed || snapshot.getState() == Snapshot.State.Error)) {
    SnapshotInfo child=snapshot.getChild();
    if (child != null) {
      s_logger.debug("the snapshot has child, can't delete it on the storage");
      break;
    }
    s_logger.debug("Snapshot: " + snapshot.getId() + " doesn't have children, so it's ok to delete it and its parents");
    SnapshotInfo parent=snapshot.getParent();
    result=this.snapshotSvr.deleteSnapshot(snapshot);
    snapshot=parent;
  }
  return result;
}
