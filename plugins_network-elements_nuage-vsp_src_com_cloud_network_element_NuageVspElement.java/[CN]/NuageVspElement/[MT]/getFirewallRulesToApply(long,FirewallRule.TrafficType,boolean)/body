{
  List<FirewallRuleVO> firewallRulesToApply=_firewallRulesDao.listByNetworkPurposeTrafficType(networkId,FirewallRule.Purpose.Firewall,trafficType);
  for (  FirewallRuleVO rule : firewallRulesToApply) {
    rule.setSourceCidrList(_firewallRulesCidrsDao.getSourceCidrs(rule.getId()));
  }
  return Lists.transform(firewallRulesToApply,new Function<FirewallRuleVO,Map<String,Object>>(){
    @Override public Map<String,Object> apply(    FirewallRuleVO firewallRuleVO){
      return getACLRuleDetails(firewallRuleVO,egressDefaultPolicy);
    }
  }
);
}
