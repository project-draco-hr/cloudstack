{
  if (vpc.getState().equals(Vpc.State.Inactive)) {
    Domain vpcDomain=_domainDao.findById(vpc.getDomainId());
    HostVO nuageVspHost=getNuageVspHost(getPhysicalNetworkId(vpc.getZoneId()));
    String preConfiguredDomainTemplateName;
    VpcDetailVO domainTemplateNameDetail=_vpcDetailsDao.findDetail(vpc.getId(),NuageVspManager.nuageDomainTemplateDetailName);
    if (domainTemplateNameDetail != null) {
      preConfiguredDomainTemplateName=domainTemplateNameDetail.getValue();
    }
 else {
      preConfiguredDomainTemplateName=_configDao.getValue(NuageVspManager.NuageVspVpcDomainTemplateName.key());
    }
    ShutDownVpcVspCommand cmd=new ShutDownVpcVspCommand(vpcDomain.getUuid(),vpc.getUuid(),preConfiguredDomainTemplateName);
    Answer answer=_agentMgr.easySend(nuageVspHost.getId(),cmd);
    if (answer == null || !answer.getResult()) {
      s_logger.error("ShutDownVpcVspCommand for VPC " + vpc.getUuid() + " failed on Nuage VSD "+ nuageVspHost.getDetail("hostname"));
      if ((null != answer) && (null != answer.getDetails())) {
        throw new ResourceUnavailableException(answer.getDetails(),Vpc.class,vpc.getId());
      }
    }
  }
  return true;
}
