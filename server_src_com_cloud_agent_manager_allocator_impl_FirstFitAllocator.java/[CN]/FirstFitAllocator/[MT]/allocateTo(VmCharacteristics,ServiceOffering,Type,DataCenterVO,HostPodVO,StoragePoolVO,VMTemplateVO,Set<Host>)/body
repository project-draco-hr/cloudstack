{
  if (type == Host.Type.Storage) {
    return null;
  }
  s_logger.debug("Looking for hosts associated with storage pool " + sp.getId());
  List<StoragePoolHostVO> poolhosts=_storagePoolHostDao.listByPoolId(sp.getId());
  List<HostVO> hosts=new ArrayList<HostVO>();
  for (  StoragePoolHostVO poolhost : poolhosts) {
    hosts.add(_hostDao.findById(poolhost.getHostId()));
  }
  long podId=pod.getId();
  List<HostVO> podHosts=new ArrayList<HostVO>(hosts.size());
  Iterator<HostVO> it=hosts.iterator();
  while (it.hasNext()) {
    HostVO host=it.next();
    if (host.getPodId() == podId && !avoid.contains(host)) {
      if (s_logger.isDebugEnabled()) {
        s_logger.debug("Adding host " + host + " as possible pod host");
      }
      podHosts.add(host);
    }
  }
  return allocateTo(offering,template,avoid,podHosts);
}
