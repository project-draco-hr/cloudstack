{
  if (!(_storageLayer.exists(localStoragePath) && _storageLayer.isDirectory(localStoragePath))) {
    return null;
  }
  File path=new File(localStoragePath);
  if (!(path.canWrite() && path.canRead() && path.canExecute())) {
    return null;
  }
  StoragePool pool=null;
  try {
    pool=conn.storagePoolLookupByUUIDString(uuid);
  }
 catch (  LibvirtException e) {
  }
  if (pool == null) {
    LibvirtStoragePoolDef spd=new LibvirtStoragePoolDef(poolType.DIR,uuid,uuid,null,null,localStoragePath);
    try {
      pool=conn.storagePoolDefineXML(spd.toString(),0);
      pool.create(0);
    }
 catch (    LibvirtException e) {
      if (pool != null) {
        try {
          pool.destroy();
          pool.undefine();
        }
 catch (        LibvirtException e1) {
        }
        pool=null;
      }
    }
  }
  if (pool == null) {
    return null;
  }
  try {
    StoragePoolInfo spi=pool.getInfo();
    if (spi.state != StoragePoolState.VIR_STORAGE_POOL_RUNNING) {
      pool.create(0);
    }
    spi=pool.getInfo();
    if (spi.state != StoragePoolState.VIR_STORAGE_POOL_RUNNING) {
      return null;
    }
    com.cloud.agent.api.StoragePoolInfo pInfo=new com.cloud.agent.api.StoragePoolInfo(uuid,hostIp,localStoragePath,localStoragePath,StoragePoolType.Filesystem,spi.capacity,spi.available);
    return pInfo;
  }
 catch (  LibvirtException e) {
  }
  return null;
}
