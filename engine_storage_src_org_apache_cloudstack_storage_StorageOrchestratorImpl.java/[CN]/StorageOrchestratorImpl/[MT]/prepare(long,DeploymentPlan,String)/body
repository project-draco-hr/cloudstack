{
  VirtualMachine vm=_vmDao.findById(vmId);
  List<VolumeVO> vols=_volumeDao.findUsableVolumesForInstance(vm.getId());
  if (s_logger.isDebugEnabled()) {
    s_logger.debug("Prepare " + vols.size() + " volumes for "+ vm.getInstanceName());
  }
  try {
    prepareVolumes(vols,plan.getPoolId(),reservationId);
  }
 catch (  NoTransitionException e) {
    s_logger.debug("Failed to prepare volume: " + e.toString());
  }
}
