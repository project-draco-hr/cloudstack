{
  long max=-1;
  ResourceLimitVO limit=_resourceLimitDao.findByOwnerIdAndType(accountId,ResourceOwnerType.Account,type);
  if (limit != null) {
    max=limit.getMax().longValue();
  }
 else {
    try {
      if (type == Resource.ResourceType.public_ip) {
        max=Long.parseLong(_configDao.getValue(Config.DefaultMaxAccountPublicIPs.key()));
      }
 else       if (type == ResourceType.snapshot) {
        max=Long.parseLong(_configDao.getValue(Config.DefaultMaxAccountSnapshots.key()));
      }
 else       if (type == ResourceType.template) {
        max=Long.parseLong(_configDao.getValue(Config.DefaultMaxAccountTemplates.key()));
      }
 else       if (type == ResourceType.user_vm) {
        max=Long.parseLong(_configDao.getValue(Config.DefaultMaxAccountUserVms.key()));
      }
 else       if (type == ResourceType.volume) {
        max=Long.parseLong(_configDao.getValue(Config.DefaultMaxAccountVolumes.key()));
      }
 else {
        throw new InvalidParameterValueException("Unsupported resource type " + type);
      }
    }
 catch (    NumberFormatException nfe) {
      s_logger.error("Invalid value is set for the default account limit.");
    }
  }
  return max;
}
