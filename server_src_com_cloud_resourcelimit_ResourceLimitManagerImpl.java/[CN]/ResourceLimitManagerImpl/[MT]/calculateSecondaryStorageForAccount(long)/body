{
  long totalVolumesSize=_volumeDao.secondaryStorageUsedForAccount(accountId);
  long totalSnapshotsSize=_snapshotDao.secondaryStorageUsedForAccount(accountId);
  long totalTemplatesSize=0;
  SearchCriteria<SumCount> sc=templateSizeSearch.create();
  sc.setParameters("downloadState",Status.DOWNLOADED);
  sc.setParameters("destroyed",false);
  sc.setJoinParameters("templates","accountId",accountId);
  List<SumCount> templates=_vmTemplateStoreDao.customSearch(sc,null);
  if (templates != null) {
    totalTemplatesSize=templates.get(0).sum;
  }
  return totalVolumesSize + totalSnapshotsSize + totalTemplatesSize;
}
