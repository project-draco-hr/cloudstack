{
  if (SnapshotOperation.REVERT.equals(op)) {
    return StrategyPriority.CANT_HANDLE;
  }
  long volumeId=snapshot.getVolumeId();
  VolumeVO volumeVO=_volumeDao.findByIdIncludingRemoved(volumeId);
  long storagePoolId=volumeVO.getPoolId();
  DataStore dataStore=_dataStoreMgr.getDataStore(storagePoolId,DataStoreRole.Primary);
  if (dataStore != null) {
    Map<String,String> mapCapabilities=dataStore.getDriver().getCapabilities();
    if (mapCapabilities != null) {
      String value=mapCapabilities.get(DataStoreCapabilities.STORAGE_SYSTEM_SNAPSHOT.toString());
      Boolean supportsStorageSystemSnapshots=new Boolean(value);
      if (supportsStorageSystemSnapshots) {
        return StrategyPriority.HIGHEST;
      }
    }
  }
  return StrategyPriority.CANT_HANDLE;
}
