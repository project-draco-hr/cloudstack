{
  HostVO hostVO=_hostDao.findById(hostId);
  if (hostVO != null) {
    return hostId;
  }
  long zoneId=volumeVO.getDataCenterId();
  List<? extends Cluster> clusters=_mgr.searchForClusters(zoneId,new Long(0),Long.MAX_VALUE,HypervisorType.XenServer.toString());
  if (clusters == null) {
    throw new CloudRuntimeException("Unable to locate an applicable cluster");
  }
  for (  Cluster cluster : clusters) {
    if (cluster.getAllocationState() == AllocationState.Enabled) {
      List<HostVO> hosts=_hostDao.findByClusterId(cluster.getId());
      if (hosts != null) {
        for (        HostVO host : hosts) {
          if (host.getResourceState() == ResourceState.Enabled) {
            return host.getId();
          }
        }
      }
    }
  }
  throw new CloudRuntimeException("Unable to locate an applicable cluster");
}
