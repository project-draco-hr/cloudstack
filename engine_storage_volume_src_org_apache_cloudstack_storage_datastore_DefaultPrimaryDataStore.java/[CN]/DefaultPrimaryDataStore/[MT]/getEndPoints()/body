{
  Long clusterId=pdsv.getClusterId();
  if (clusterId == null) {
    pdsv=dataStoreDao.findById(pdsv.getId());
    clusterId=pdsv.getClusterId();
    if (clusterId == null) {
      return new ArrayList<EndPoint>();
    }
  }
  List<EndPoint> endpoints=new ArrayList<EndPoint>();
  List<HostVO> hosts=hostDao.findHypervisorHostInCluster(clusterId);
  for (  HostVO host : hosts) {
    HypervisorHostEndPoint ep=new HypervisorHostEndPoint(host.getId(),host.getPrivateIpAddress());
    ComponentContext.inject(ep);
    endpoints.add(ep);
  }
  Collections.shuffle(endpoints);
  return endpoints;
}
