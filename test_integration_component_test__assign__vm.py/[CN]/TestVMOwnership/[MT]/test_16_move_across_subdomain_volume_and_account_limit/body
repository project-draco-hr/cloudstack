@attr(tags=['advanced'])
@log_test_exceptions
def test_16_move_across_subdomain_volume_and_account_limit(self):
    'Test as domain admin, stop a VM from subdomain1 and attempt to move it to subdomain2 volumes are attached and limit reached\n        '
    update_resource_limit(self.apiclient, 0, account=self.sdomain_account_user2['account'].name, domainid=self.sdomain_account_user2['domain'].id, max=0)
    userapiclient = self.testClient.getUserApiClient(account=self.sdomain_account_user1['account'].name, domain=self.sdomain_account_user1['domain'].name, type=2)
    self.create_vm(self.sdomain_account_user1['account'], self.sdomain_account_user1['domain'], snapshot=True, volume=self.sdomain_account_user1['volume'])
    self.assertRaises(Exception, self.virtual_machine.assign_virtual_machine, userapiclient, self.sdomain_account_user2['account'].name, self.sdomain_account_user2['domain'].id)
    self.virtual_machine.detach_volume(self.apiclient, self.sdomain_account_user1['volume'])
