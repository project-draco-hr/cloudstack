{
  try {
    lbvserver vserver=new lbvserver();
    vserver.set_name(virtualServerName);
    vserver.set_ipv46(srcIp);
    vserver.set_port(srcPort);
    vserver.set_servicetype(lbProtocol);
    vserver.set_lbmethod(lbMethod);
    apiCallResult=lbvserver.add(_netscalerService,vserver);
    if (apiCallResult.errorcode != 0) {
      throw new ExecutionException("Failed to create new virtual server:" + virtualServerName);
    }
  }
 catch (  nitro_exception e) {
    if (e.getErrorCode() != NitroError.NS_RESOURCE_EXISTS) {
      throw new ExecutionException("Failed to create new virtual server:" + virtualServerName + " due to "+ e.getMessage());
    }
  }
catch (  Exception e) {
    throw new ExecutionException("Failed to create new virtual server:" + virtualServerName + " due to "+ e.getMessage());
  }
}
