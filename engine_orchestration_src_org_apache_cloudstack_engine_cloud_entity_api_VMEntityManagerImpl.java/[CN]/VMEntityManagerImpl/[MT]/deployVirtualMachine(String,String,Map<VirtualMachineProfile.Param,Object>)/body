{
  VMReservationVO vmReservation=_reservationDao.findByReservationId(reservationId);
  long vmId=vmReservation.getVmId();
  VMInstanceVO vm=_vmDao.findById(vmId);
  Long poolId=null;
  Map<Long,Long> storage=vmReservation.getVolumeReservation();
  if (storage != null) {
    List<Long> volIdList=new ArrayList<Long>(storage.keySet());
    if (volIdList != null && !volIdList.isEmpty()) {
      poolId=storage.get(volIdList.get(0));
    }
  }
  DataCenterDeployment reservedPlan=new DataCenterDeployment(vm.getDataCenterId(),vmReservation.getPodId(),vmReservation.getClusterId(),vmReservation.getHostId(),null,null);
  try {
    VMInstanceVO vmDeployed=_itMgr.start(vm,params,_userDao.findById(new Long(caller)),_accountDao.findById(vm.getAccountId()),reservedPlan);
  }
 catch (  Exception ex) {
    DataCenterDeployment plan=new DataCenterDeployment(vm.getDataCenterId(),null,null,null,null,null);
    _itMgr.start(vm,params,_userDao.findById(new Long(caller)),_accountDao.findById(vm.getAccountId()),plan);
  }
}
