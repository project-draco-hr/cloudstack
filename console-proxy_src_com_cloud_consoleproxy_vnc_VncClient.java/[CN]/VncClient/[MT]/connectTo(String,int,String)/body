{
  if (port < 100)   port+=5900;
  SimpleLogger.info("Connecting to VNC server " + host + ":"+ port+ "...");
  this.socket=new Socket(host,port);
  is=new DataInputStream(socket.getInputStream());
  os=new DataOutputStream(socket.getOutputStream());
  handshake();
  authenticate(password);
  initialize();
  sender=new VncClientPacketSender(os,screen,this);
  BufferedImageCanvas canvas=new BufferedImageCanvas(sender,screen.getFramebufferWidth(),screen.getFramebufferHeight());
  canvas.addMouseListener(sender);
  canvas.addMouseMotionListener(sender);
  canvas.addKeyListener(sender);
  Frame frame=createVncClientMainWindow(canvas,screen.getDesktopName());
  new Thread(sender).start();
  receiver=new VncServerPacketReceiver(is,canvas,screen,this,sender);
  try {
    receiver.run();
  }
  finally {
    frame.setVisible(false);
    frame.dispose();
    this.shutdown();
  }
}
