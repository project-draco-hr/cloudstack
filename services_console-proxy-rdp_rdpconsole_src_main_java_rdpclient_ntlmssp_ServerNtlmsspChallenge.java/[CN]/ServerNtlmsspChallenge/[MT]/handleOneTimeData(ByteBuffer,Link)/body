{
  if (buf == null)   return;
  if (verbose)   System.out.println("[" + this + "] INFO: Data received: "+ buf+ ".");
  TSRequest request=new TSRequest("TSRequest");
  request.readTag(buf);
  ByteBuffer negoToken=((NegoItem)request.negoTokens.tags[0]).negoToken.value;
  ntlmState.challengeMessage=negoToken.toByteArray();
  parseNtlmChallenge(negoToken);
  negoToken.unref();
  buf.unref();
  switchOff();
}
