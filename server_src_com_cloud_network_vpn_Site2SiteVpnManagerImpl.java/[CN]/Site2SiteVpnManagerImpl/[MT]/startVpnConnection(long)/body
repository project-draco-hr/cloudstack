{
  Site2SiteVpnConnectionVO conn=_vpnConnectionDao.findById(id);
  if (conn.getState() != State.Pending && conn.getState() != State.Disconnected) {
    throw new InvalidParameterValueException("Site to site VPN connection " + id + " not in correct state(pending or disconnected) to process!");
  }
  List<? extends Site2SiteVpnServiceProvider> elements=_networkMgr.getSite2SiteVpnElements();
  boolean result=true;
  for (  Site2SiteVpnServiceProvider element : elements) {
    result=result & element.startSite2SiteVpn(conn);
  }
  if (result) {
    conn.setState(State.Connected);
    _vpnConnectionDao.persist(conn);
    return conn;
  }
  conn.setState(State.Error);
  _vpnConnectionDao.persist(conn);
  return null;
}
