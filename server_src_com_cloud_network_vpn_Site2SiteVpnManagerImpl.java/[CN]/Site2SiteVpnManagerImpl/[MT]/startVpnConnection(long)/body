{
  Site2SiteVpnConnectionVO conn=_vpnConnectionDao.findById(id);
  if (conn.getState() != State.Pending && conn.getState() != State.Disconnected) {
    throw new InvalidParameterValueException("Site to site VPN connection " + id + " not in correct state(pending or disconnected) to process!");
  }
  Site2SiteVpnGatewayVO vpnGateway=_vpnGatewayDao.findById(conn.getVpnGatewayId());
  Network network=_networkDao.findById(vpnGateway.getNetworkId());
  List<? extends Site2SiteVpnServiceProvider> elements=_networkMgr.getSite2SiteVpnElements();
  boolean result=true;
  for (  Site2SiteVpnServiceProvider element : elements) {
    result=result & element.startSite2SiteVpn(network,conn);
  }
  if (result) {
    conn.setState(State.Connected);
    _vpnConnectionDao.persist(conn);
    return conn;
  }
  return null;
}
