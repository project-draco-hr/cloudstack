{
  boolean isVpc=getIsVpc(network);
  long id=getRouterId(network,isVpc);
  String routerName=getRouterName(isVpc,id);
  RuleChain egressChain=getChain(String.valueOf(network.getId()),getAccountUuid(network),routerName,RuleChainCode.ACL_EGRESS);
  int totalRules=0;
  for (  Rule rule : egressChain.getRules()) {
    if (rule.getNwProto() != 0) {
      totalRules++;
    }
  }
  if (totalRules > 0) {
    return egressChain;
  }
 else {
    for (    Rule rule : egressChain.getRules()) {
      rule.delete();
    }
  }
  int pos=1;
  egressChain.addRule().type(DtoRule.Accept).dlType(0x0806).position(pos++).create();
  egressChain.addRule().type(DtoRule.Accept).nwProto(SimpleFirewallRule.stringToProtocolNumber("icmp")).nwDstAddress(network.getGateway()).nwDstLength(32).position(pos++).create();
  egressChain.addRule().type(DtoRule.Drop).position(pos).create();
  return egressChain;
}
