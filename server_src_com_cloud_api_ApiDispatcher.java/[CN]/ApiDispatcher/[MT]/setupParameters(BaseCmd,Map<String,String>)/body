{
  Map<String,Object> unpackedParams=cmd.unpackParams(params);
  Field[] fields=cmd.getClass().getDeclaredFields();
  for (  Field field : fields) {
    Parameter parameterAnnotation=field.getAnnotation(Parameter.class);
    if ((parameterAnnotation == null) || !parameterAnnotation.expose()) {
      continue;
    }
    Object paramObj=unpackedParams.get(parameterAnnotation.name());
    if (paramObj == null) {
      if (parameterAnnotation.required()) {
        throw new ServerApiException(BaseCmd.PARAM_ERROR,"Unable to execute API command " + cmd.getName() + " due to missing parameter "+ parameterAnnotation.name());
      }
      continue;
    }
    try {
      setFieldValue(field,cmd,paramObj,parameterAnnotation);
    }
 catch (    IllegalArgumentException argEx) {
      if (s_logger.isDebugEnabled()) {
        s_logger.debug("Unable to execute API command " + cmd.getName() + " due to invalid value "+ paramObj+ " for parameter "+ parameterAnnotation.name());
      }
      throw new ServerApiException(BaseCmd.PARAM_ERROR,"Unable to execute API command " + cmd.getName() + " due to invalid value "+ paramObj+ " for parameter "+ parameterAnnotation.name());
    }
catch (    ParseException parseEx) {
      if (s_logger.isDebugEnabled()) {
        s_logger.debug("Invalid date parameter " + paramObj + " passed to command "+ cmd.getName());
      }
      throw new ServerApiException(BaseCmd.PARAM_ERROR,"Unable to parse date " + paramObj + " for command "+ cmd.getName()+ ", please pass dates in the format yyyy-MM-dd");
    }
catch (    CloudRuntimeException cloudEx) {
      throw new ServerApiException(BaseCmd.INTERNAL_ERROR,"Internal error executing API command " + cmd.getName());
    }
  }
}
