{
  ComponentLocator locator=ComponentLocator.getLocator(ManagementServer.Name);
  Class<?> fc=field.getType();
  Object instance=null;
  if (PluggableService.class.isAssignableFrom(fc)) {
    instance=locator.getPluggableService(fc);
  }
  if (instance == null) {
    throw new CloudRuntimeException("Unable to plug service " + fc.getSimpleName() + " in command "+ cmd.getClass().getSimpleName());
  }
  try {
    field.setAccessible(true);
    field.set(cmd,instance);
  }
 catch (  IllegalArgumentException e) {
    s_logger.error("IllegalArgumentException at plugService for command " + cmd.getCommandName() + ", field "+ field.getName());
    throw new CloudRuntimeException("Internal error at plugService for command " + cmd.getCommandName() + " [Illegal argumet at field "+ field.getName()+ "]");
  }
catch (  IllegalAccessException e) {
    s_logger.error("Error at plugService for command " + cmd.getCommandName() + ", field "+ field.getName()+ " is not accessible.");
    throw new CloudRuntimeException("Internal error at plugService for command " + cmd.getCommandName() + " [field "+ field.getName()+ " is not accessible]");
  }
}
