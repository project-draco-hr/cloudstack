{
  setupParameters(cmd,params);
  Implementation impl=cmd.getClass().getAnnotation(Implementation.class);
  String methodName=impl.createMethod();
  Object mgr=_mgmtServer;
switch (impl.manager()) {
case ConfigManager:
    mgr=_configMgr;
  break;
case NetworkGroupManager:
mgr=_networkGroupMgr;
break;
case NetworkManager:
mgr=_networkMgr;
break;
case SnapshotManager:
mgr=_snapshotMgr;
break;
case StorageManager:
mgr=_storageMgr;
break;
case UserVmManager:
mgr=_userVmMgr;
break;
}
try {
Method method=mgr.getClass().getMethod(methodName,cmd.getClass());
method.invoke(mgr,cmd);
return cmd.getId();
}
 catch (NoSuchMethodException nsme) {
s_logger.warn("Exception executing method " + methodName + " for command "+ cmd.getClass().getSimpleName(),nsme);
throw new CloudRuntimeException("Unable to execute method " + methodName + " for command "+ cmd.getClass().getSimpleName()+ ", unable to find implementation.");
}
catch (InvocationTargetException ite) {
s_logger.warn("Exception executing method " + methodName + " for command "+ cmd.getClass().getSimpleName(),ite);
throw new CloudRuntimeException("Unable to execute method " + methodName + " for command "+ cmd.getClass().getSimpleName()+ ", internal error in the implementation.");
}
catch (IllegalAccessException iae) {
s_logger.warn("Exception executing method " + methodName + " for command "+ cmd.getClass().getSimpleName(),iae);
throw new CloudRuntimeException("Unable to execute method " + methodName + " for command "+ cmd.getClass().getSimpleName()+ ", internal error in the implementation.");
}
catch (IllegalArgumentException iArgEx) {
s_logger.warn("Exception executing method " + methodName + " for command "+ cmd.getClass().getSimpleName(),iArgEx);
throw new CloudRuntimeException("Unable to execute method " + methodName + " for command "+ cmd.getClass().getSimpleName()+ ", internal error in the implementation.");
}
}
