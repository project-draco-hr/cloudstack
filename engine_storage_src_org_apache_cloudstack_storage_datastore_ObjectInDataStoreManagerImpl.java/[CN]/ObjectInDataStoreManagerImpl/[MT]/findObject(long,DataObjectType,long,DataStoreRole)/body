{
  DataObjectInStore vo=null;
  if (role == DataStoreRole.Image || role == DataStoreRole.ImageCache) {
switch (type) {
case TEMPLATE:
      vo=templateDataStoreDao.findByStoreTemplate(dataStoreId,objId);
    break;
case SNAPSHOT:
  vo=snapshotDataStoreDao.findByStoreSnapshot(role,dataStoreId,objId);
break;
case VOLUME:
vo=volumeDataStoreDao.findByStoreVolume(dataStoreId,objId);
break;
}
}
 else if (type == DataObjectType.TEMPLATE && role == DataStoreRole.Primary) {
vo=templatePoolDao.findByPoolTemplate(dataStoreId,objId);
}
 else if (type == DataObjectType.SNAPSHOT && role == DataStoreRole.Primary) {
vo=snapshotDataStoreDao.findByStoreSnapshot(role,dataStoreId,objId);
}
 else {
s_logger.debug("Invalid data or store type: " + type + " "+ role);
throw new CloudRuntimeException("Invalid data or store type: " + type + " "+ role);
}
return vo;
}
