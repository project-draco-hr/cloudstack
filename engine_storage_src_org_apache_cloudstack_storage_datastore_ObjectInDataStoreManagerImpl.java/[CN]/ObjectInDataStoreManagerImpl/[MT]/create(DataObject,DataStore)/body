{
  if (dataStore.getRole() == DataStoreRole.Primary) {
    if (obj.getType() == DataObjectType.TEMPLATE) {
      VMTemplateStoragePoolVO vo=new VMTemplateStoragePoolVO(dataStore.getId(),obj.getId());
      vo=templatePoolDao.persist(vo);
    }
  }
 else {
switch (obj.getType()) {
case TEMPLATE:
      TemplateDataStoreVO ts=new TemplateDataStoreVO();
    ts.setTemplateId(obj.getId());
  ts.setDataStoreId(dataStore.getId());
ts=templateDataStoreDao.persist(ts);
break;
case SNAPSHOT:
SnapshotDataStoreVO ss=new SnapshotDataStoreVO();
ss.setSnapshotId(obj.getId());
ss.setDataStoreId(dataStore.getId());
ss=snapshotDataStoreDao.persist(ss);
break;
case VOLUME:
VolumeDataStoreVO vs=new VolumeDataStoreVO();
vs.setVolumeId(obj.getId());
vs.setDataStoreId(dataStore.getId());
vs=volumeDataStoreDao.persist(vs);
break;
}
}
return this.get(obj,dataStore);
}
