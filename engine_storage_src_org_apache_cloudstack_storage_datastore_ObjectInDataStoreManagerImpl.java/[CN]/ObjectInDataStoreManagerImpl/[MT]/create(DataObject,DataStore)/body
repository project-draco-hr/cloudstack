{
  ObjectInDataStoreVO vo=new ObjectInDataStoreVO();
  vo.setDataStoreId(dataStore.getId());
  vo.setDataStoreRole(dataStore.getRole());
  vo.setObjectId(obj.getId());
  vo.setSize(obj.getSize());
  vo.setObjectType(obj.getType());
  vo=objectDataStoreDao.persist(vo);
  if (obj.getType() == DataObjectType.TEMPLATE) {
    return imageFactory.getTemplate(obj.getId(),dataStore);
  }
 else   if (obj.getType() == DataObjectType.VOLUME) {
    return volumeFactory.getVolume(obj.getId(),dataStore);
  }
  throw new CloudRuntimeException("unknown type");
}
