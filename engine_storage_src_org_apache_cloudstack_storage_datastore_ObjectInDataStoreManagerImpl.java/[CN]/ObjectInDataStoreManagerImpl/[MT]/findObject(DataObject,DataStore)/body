{
  DataObjectInStore vo=null;
  SearchCriteriaService<ObjectInDataStoreVO,ObjectInDataStoreVO> sc=SearchCriteria2.create(ObjectInDataStoreVO.class);
  if (store.getRole() == DataStoreRole.Image) {
    sc.addAnd(sc.getEntity().getDataStoreUuid(),Op.EQ,store.getUuid());
    sc.addAnd(sc.getEntity().getDataStoreRole(),Op.EQ,store.getRole());
    sc.addAnd(sc.getEntity().getObjectUuid(),Op.EQ,obj.getUuid());
    sc.addAnd(sc.getEntity().getObjectType(),Op.EQ,obj.getType());
    vo=sc.find();
  }
 else   if (obj.getType() == DataObjectType.TEMPLATE && store.getRole() == DataStoreRole.Primary) {
    vo=templatePoolDao.findByPoolTemplate(store.getId(),obj.getId());
  }
 else {
    s_logger.debug("unknown type: " + obj.getType() + " "+ store.getRole());
    throw new CloudRuntimeException("unknown type");
  }
  return vo;
}
