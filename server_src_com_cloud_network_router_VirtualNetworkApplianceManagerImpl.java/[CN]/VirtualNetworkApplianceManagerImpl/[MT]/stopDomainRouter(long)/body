{
  UserContext context=UserContext.current();
  Account account=context.getCaller();
  long accountId=account.getId();
  long userId=context.getCallerUserId();
  DomainRouterVO router=_routerDao.findById(routerId);
  if (router == null) {
    throw new PermissionDeniedException("Unable to stop router with id " + routerId + ". Permission denied.");
  }
  _accountMgr.checkAccess(account,router);
  UserVO user=_userDao.findById(context.getCallerUserId());
  if (!_itMgr.stop(router,user,account)) {
    return null;
  }
  return router;
}
