{
  DataCenterVO dcVo=_dcDao.findById(router.getDataCenterId());
  List<NicIpAliasVO> ipAliasVOList=_nicIpAliasDao.getAliasIpForVm(router.getId());
  List<DnsmasqTO> ipList=new ArrayList<DnsmasqTO>();
  NicVO router_guest_nic=_nicDao.findByNtwkIdAndInstanceId(network.getId(),router.getId());
  String cidr=NetUtils.getCidrFromGatewayAndNetmask(router_guest_nic.getGateway(),router_guest_nic.getNetmask());
  String[] cidrPair=cidr.split("\\/");
  String cidrAddress=cidrPair[0];
  long cidrSize=Long.parseLong(cidrPair[1]);
  String startIpOfSubnet=NetUtils.getIpRangeStartIpFromCidr(cidrAddress,cidrSize);
  ipList.add(new DnsmasqTO(router_guest_nic.getIp4Address(),router_guest_nic.getGateway(),router_guest_nic.getNetmask(),startIpOfSubnet));
  for (  NicIpAliasVO ipAliasVO : ipAliasVOList) {
    DnsmasqTO dnsmasqTO=new DnsmasqTO(ipAliasVO.getIp4Address(),ipAliasVO.getGateway(),ipAliasVO.getNetmask(),ipAliasVO.getStartIpOfSubnet());
    ipList.add(dnsmasqTO);
  }
  DataCenterVO dcvo=_dcDao.findById(router.getDataCenterId());
  DnsMasqConfigCommand dnsMasqConfigCmd=new DnsMasqConfigCommand(network.getNetworkDomain(),ipList,dcvo.getDns1(),dcvo.getDns2(),dcvo.getInternalDns1(),dcvo.getInternalDns2());
  dnsMasqConfigCmd.setAccessDetail(NetworkElementCommand.ROUTER_IP,getRouterControlIp(router.getId()));
  dnsMasqConfigCmd.setAccessDetail(NetworkElementCommand.ROUTER_NAME,router.getInstanceName());
  dnsMasqConfigCmd.setAccessDetail(NetworkElementCommand.ROUTER_GUEST_IP,getRouterIpInNetwork(network.getId(),router.getId()));
  dnsMasqConfigCmd.setAccessDetail(NetworkElementCommand.ZONE_NETWORK_TYPE,dcVo.getNetworkType().toString());
  cmds.addCommand("dhcpConfig",dnsMasqConfigCmd);
}
