{
  if (event == VirtualMachine.Event.FollowAgentPowerOnReport && newState == State.Running) {
    if (vo.getType() == VirtualMachine.Type.DomainRouter) {
      if (opaque != null && opaque instanceof Pair<?,?>) {
        Pair<?,?> pair=(Pair<?,?>)opaque;
        Object first=pair.first();
        Object second=pair.second();
        if (first != null && second != null && first instanceof Long && second instanceof Long) {
          Long hostId=(Long)first;
          Long powerHostId=(Long)second;
          if (hostId.longValue() != powerHostId.longValue()) {
            s_logger.info("Schedule a router reboot task as router " + vo.getId() + " is powered-on out-of-band. we need to reboot to refresh network rules");
            _executor.schedule(new RebootTask(vo.getId()),1000,TimeUnit.MICROSECONDS);
          }
        }
      }
    }
  }
  return true;
}
