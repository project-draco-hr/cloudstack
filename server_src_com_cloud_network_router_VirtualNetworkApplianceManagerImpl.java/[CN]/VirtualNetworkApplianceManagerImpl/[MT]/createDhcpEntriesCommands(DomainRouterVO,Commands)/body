{
  long networkId=router.getNetworkId();
  List<UserVmVO> vms=_userVmDao.listByNetworkId(networkId);
  if (vms != null && !vms.isEmpty()) {
    for (    UserVmVO vm : vms) {
      NicVO nic=_nicDao.findByInstanceIdAndNetworkId(networkId,vm.getId());
      if (nic != null) {
        s_logger.debug("Creating dhcp entry for vm " + vm + " on domR "+ router+ ".");
        DhcpEntryCommand dhcpCommand=new DhcpEntryCommand(nic.getMacAddress(),nic.getIp4Address(),vm.getName());
        dhcpCommand.setAccessDetail(NetworkElementCommand.ROUTER_IP,router.getPrivateIpAddress());
        dhcpCommand.setAccessDetail(NetworkElementCommand.ROUTER_NAME,router.getInstanceName());
        cmds.addCommand("dhcp",dhcpCommand);
      }
    }
  }
}
