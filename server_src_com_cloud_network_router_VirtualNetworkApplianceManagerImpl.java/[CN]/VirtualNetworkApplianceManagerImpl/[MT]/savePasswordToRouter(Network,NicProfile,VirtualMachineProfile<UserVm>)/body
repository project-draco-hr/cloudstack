{
  DomainRouterVO router=_routerDao.findByNetwork(network.getId());
  if (router == null) {
    s_logger.warn("Unable save password, router doesn't exist in network " + network.getId());
    throw new CloudRuntimeException("Unable to save password to router");
  }
  UserVm userVm=profile.getVirtualMachine();
  String password=(String)profile.getParameter(Param.VmPassword);
  String encodedPassword=PasswordGenerator.rot13(password);
  Commands cmds=new Commands(OnError.Continue);
  SavePasswordCommand cmd=new SavePasswordCommand(encodedPassword,nic.getIp4Address(),userVm.getHostName());
  cmd.setAccessDetail(NetworkElementCommand.ROUTER_IP,router.getPrivateIpAddress());
  cmd.setAccessDetail(NetworkElementCommand.ROUTER_GUEST_IP,router.getGuestIpAddress());
  cmd.setAccessDetail(NetworkElementCommand.ROUTER_NAME,router.getInstanceName());
  DataCenterVO dcVo=_dcDao.findById(router.getDataCenterIdToDeployIn());
  cmd.setAccessDetail(NetworkElementCommand.ZONE_NETWORK_TYPE,dcVo.getNetworkType().toString());
  cmds.addCommand("password",cmd);
  return sendCommandsToRouter(router,cmds);
}
