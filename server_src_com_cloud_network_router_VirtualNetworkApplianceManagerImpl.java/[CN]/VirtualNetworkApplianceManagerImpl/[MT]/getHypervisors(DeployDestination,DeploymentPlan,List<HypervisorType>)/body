{
  List<HypervisorType> hypervisors=new ArrayList<HypervisorType>();
  HypervisorType defaults=_resourceMgr.getDefaultHypervisor(dest.getDataCenter().getId());
  if (defaults != HypervisorType.None) {
    hypervisors.add(defaults);
  }
  if (dest.getCluster() != null) {
    if (dest.getCluster().getHypervisorType() == HypervisorType.Ovm) {
      hypervisors.add(getClusterToStartDomainRouterForOvm(dest.getCluster().getPodId()));
    }
 else {
      hypervisors.add(dest.getCluster().getHypervisorType());
    }
  }
 else {
    hypervisors=_resourceMgr.getSupportedHypervisorTypes(dest.getDataCenter().getId(),true,plan.getPodId());
  }
  StringBuilder hTypesStr=new StringBuilder();
  if (supportedHypervisors != null && !supportedHypervisors.isEmpty()) {
    hypervisors.retainAll(supportedHypervisors);
    for (    HypervisorType hType : supportedHypervisors) {
      hTypesStr.append(hType).append(" ");
    }
  }
  if (hypervisors.isEmpty()) {
    String errMsg=(hTypesStr.capacity() > 0) ? "supporting hypervisors " + hTypesStr.toString() : "";
    if (plan.getPodId() != null) {
      throw new InsufficientServerCapacityException("Unable to create virtual router, " + "there are no clusters in the pod " + errMsg,Pod.class,plan.getPodId());
    }
    throw new InsufficientServerCapacityException("Unable to create virtual router, " + "there are no clusters in the zone " + errMsg,DataCenter.class,dest.getDataCenter().getId());
  }
  return hypervisors;
}
