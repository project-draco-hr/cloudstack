{
  final State oldState=transition.getCurrentState();
  final State newState=transition.getToState();
  final VirtualMachine.Event event=transition.getEvent();
  boolean reprovision_out_of_band=RouterReprovisionOnOutOfBandMigration.value();
  if ((vo.getType() == VirtualMachine.Type.DomainRouter) && ((oldState == State.Stopped) || (reprovision_out_of_band && isOutOfBandMigrated(opaque))) && (event == VirtualMachine.Event.FollowAgentPowerOnReport)&& (newState == State.Running)) {
    s_logger.info("Schedule a router reboot task as router " + vo.getId() + " is powered-on out-of-band. we need to reboot to refresh network rules");
    _rebootRouterExecutor.execute(new RebootTask(vo.getId()));
  }
 else {
    if (isOutOfBandMigrated(opaque)) {
      final String title="Router has been migrated out of band: " + vo.getInstanceName();
      final String context="An out of band migration of router " + vo.getInstanceName() + "("+ vo.getUuid()+ ") was detected. No automated action was performed.";
      _alertMgr.sendAlert(AlertManager.AlertType.ALERT_TYPE_DOMAIN_ROUTER,vo.getDataCenterId(),vo.getPodIdToDeployIn(),title,context);
    }
  }
  return true;
}
