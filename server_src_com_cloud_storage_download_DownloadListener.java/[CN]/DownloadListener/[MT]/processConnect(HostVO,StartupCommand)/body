{
  if (cmd instanceof StartupRoutingCommand) {
    downloadMonitor.handleSysTemplateDownload(agent);
  }
 else   if (cmd instanceof StartupStorageCommand) {
    StartupStorageCommand storage=(StartupStorageCommand)cmd;
    if (storage.getResourceType() == Storage.StorageResourceType.SECONDARY_STORAGE) {
      downloadMonitor.addSystemVMTemplatesToHost(agent,storage.getTemplateInfo());
      downloadMonitor.handleTemplateSync(agent.getId());
    }
  }
 else   if (cmd instanceof StartupSecondaryStorageCommand) {
    downloadMonitor.handleTemplateSync(agent.getDataCenterId());
  }
}
