{
  DataTO data=cmd.getData();
  VolumeObjectTO volume=(VolumeObjectTO)data;
  try {
    Connection conn=hypervisorResource.getConnection();
    PrimaryDataStoreTO primaryStore=(PrimaryDataStoreTO)data.getDataStore();
    SR poolSr=hypervisorResource.getStorageRepository(conn,primaryStore.getUuid());
    VDI.Record vdir=new VDI.Record();
    vdir.nameLabel=volume.getName();
    vdir.SR=poolSr;
    vdir.type=Types.VdiType.USER;
    vdir.virtualSize=volume.getSize();
    VDI vdi;
    vdi=VDI.create(conn,vdir);
    vdir=vdi.getRecord(conn);
    VolumeObjectTO newVol=new VolumeObjectTO();
    newVol.setName(vdir.nameLabel);
    newVol.setSize(vdir.virtualSize);
    newVol.setPath(vdir.uuid);
    return new CreateObjectAnswer(newVol);
  }
 catch (  Exception e) {
    s_logger.debug("create volume failed: " + e.toString());
    return new CreateObjectAnswer(e.toString());
  }
}
