{
  String mVip=sfConnection.getManagementVip();
  int mPort=sfConnection.getManagementPort();
  String clusterAdminUsername=sfConnection.getClusterAdminUsername();
  String clusterAdminPassword=sfConnection.getClusterAdminPassword();
  AccountDetailVO accountDetail=_accountDetailsDao.findDetail(volumeInfo.getAccountId(),SolidFireUtil.ACCOUNT_ID);
  long sfAccountId=Long.parseLong(accountDetail.getValue());
  long storagePoolId=volumeInfo.getDataStore().getId();
  final Iops iops;
  Long minIops=volumeInfo.getMinIops();
  Long maxIops=volumeInfo.getMaxIops();
  if (minIops == null || minIops <= 0 || maxIops == null || maxIops <= 0) {
    long defaultMaxIops=getDefaultMaxIops(storagePoolId);
    iops=new Iops(getDefaultMinIops(storagePoolId),defaultMaxIops,getDefaultBurstIops(storagePoolId,defaultMaxIops));
  }
 else {
    iops=new Iops(volumeInfo.getMinIops(),volumeInfo.getMaxIops(),getDefaultBurstIops(storagePoolId,volumeInfo.getMaxIops()));
  }
  long volumeSize=volumeInfo.getSize();
  Integer hypervisorSnapshotReserve=volumeInfo.getHypervisorSnapshotReserve();
  if (hypervisorSnapshotReserve != null) {
    if (hypervisorSnapshotReserve < 25) {
      hypervisorSnapshotReserve=25;
    }
    volumeSize+=volumeSize * (hypervisorSnapshotReserve / 100f);
  }
  long sfVolumeId=SolidFireUtil.createSolidFireVolume(mVip,mPort,clusterAdminUsername,clusterAdminPassword,getSolidFireVolumeName(volumeInfo.getName()),sfAccountId,volumeSize,true,NumberFormat.getNumberInstance().format(volumeInfo.getSize().toString()),iops.getMinIops(),iops.getMaxIops(),iops.getBurstIops());
  return SolidFireUtil.getSolidFireVolume(mVip,mPort,clusterAdminUsername,clusterAdminPassword,sfVolumeId);
}
