{
  return Transaction.execute(new TransactionCallback<Boolean>(){
    @Override public Boolean doInTransaction(    TransactionStatus status){
      for (      String key : details.keySet()) {
        String value=details.get(key);
        if (value == null || value.isEmpty()) {
          throw new InvalidParameterValueException("Value for the key " + key + " is either null or empty");
        }
        DetailDaoHelper newDetailDaoHelper=new DetailDaoHelper(resourceType);
        ResourceDetail detail=newDetailDaoHelper.createDetail(_taggedResourceMgr.getResourceId(resourceId,resourceType),key,value);
        if (detail == null) {
          throw new UnsupportedOperationException("ResourceType " + resourceType + " doesn't support metadata");
        }
        newDetailDaoHelper.addDetail(detail);
      }
      return true;
    }
  }
);
}
