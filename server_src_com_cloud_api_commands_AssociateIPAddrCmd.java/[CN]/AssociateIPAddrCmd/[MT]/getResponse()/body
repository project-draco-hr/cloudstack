{
  IPAddressResponse response=new IPAddressResponse();
  IPAddressVO ipAddress=(IPAddressVO)getResponseObject();
  VlanVO vlan=ApiDBUtils.findVlanById(ipAddress.getVlanDbId());
  boolean forVirtualNetworks=vlan.getVlanType().equals(VlanType.VirtualNetwork);
  IPAddressResponse ipResponse=new IPAddressResponse();
  ipResponse.setIpAddress(ipAddress.getAddress());
  if (ipAddress.getAllocated() != null) {
    ipResponse.setAllocated(ipAddress.getAllocated());
  }
  ipResponse.setZoneId(ipAddress.getDataCenterId());
  ipResponse.setZoneName(ApiDBUtils.findZoneById(ipAddress.getDataCenterId()).getName());
  ipResponse.setSourceNat(ipAddress.isSourceNat());
  Account accountTemp=ApiDBUtils.findAccountById(ipAddress.getAccountId());
  if (accountTemp != null) {
    ipResponse.setAccountName(accountTemp.getAccountName());
    ipResponse.setDomainId(accountTemp.getDomainId());
    ipResponse.setDomainName(ApiDBUtils.findDomainById(accountTemp.getDomainId()).getName());
  }
  ipResponse.setForVirtualNetwork(forVirtualNetworks);
  Account account=(Account)UserContext.current().getAccountObject();
  if ((account == null) || isAdmin(account.getType())) {
    ipResponse.setVlanId(ipAddress.getVlanDbId());
    ipResponse.setVlanName(ApiDBUtils.findVlanById(ipAddress.getVlanDbId()).getVlanId());
  }
  return SerializerHelper.toSerializedString(response);
}
