{
  VMTemplateVO template=(VMTemplateVO)getResponseObject();
  ListResponse response=new ListResponse();
  List<ResponseObject> responses=new ArrayList<ResponseObject>();
  List<DataCenterVO> zones=null;
  if (zoneId != null) {
    zones=new ArrayList<DataCenterVO>();
    zones.add(ApiDBUtils.findZoneById(zoneId));
  }
 else {
    zones=ApiDBUtils.listZones();
  }
  for (  DataCenterVO zone : zones) {
    TemplateResponse templateResponse=new TemplateResponse();
    templateResponse.setId(template.getId());
    templateResponse.setName(template.getName());
    templateResponse.setDisplayText(template.getDisplayText());
    templateResponse.setPublic(template.isPublicTemplate());
    VMTemplateHostVO isoHostRef=ApiDBUtils.findTemplateHostRef(template.getId(),zone.getId());
    if (isoHostRef != null) {
      templateResponse.setCreated(isoHostRef.getCreated());
      templateResponse.setReady(isoHostRef.getDownloadState() == Status.DOWNLOADED);
    }
    templateResponse.setFeatured(template.isFeatured());
    templateResponse.setBootable(template.isBootable());
    templateResponse.setOsTypeId(template.getGuestOSId());
    templateResponse.setOsTypeName(ApiDBUtils.findGuestOSById(template.getGuestOSId()).getName());
    Account owner=ApiDBUtils.findAccountById(template.getAccountId());
    if (owner != null) {
      templateResponse.setAccountId(owner.getId());
      templateResponse.setAccount(owner.getAccountName());
      templateResponse.setDomainId(owner.getDomainId());
    }
    templateResponse.setZoneId(zone.getId());
    templateResponse.setZoneName(zone.getName());
    templateResponse.setResponseName("iso");
    responses.add(templateResponse);
  }
  response.setResponseName(getName());
  response.setResponses(responses);
  return response;
}
