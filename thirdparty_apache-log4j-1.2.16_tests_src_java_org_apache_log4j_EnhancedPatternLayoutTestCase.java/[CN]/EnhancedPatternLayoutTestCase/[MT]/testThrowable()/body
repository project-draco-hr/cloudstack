{
  String OUTPUT_FILE="output/patternLayout.throwable";
  String WITNESS_FILE="witness/pattern/enhancedPatternLayout.throwable";
  EnhancedPatternLayout layout=new EnhancedPatternLayout("%m%n");
  Appender appender=new FileAppender(layout,OUTPUT_FILE,false);
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  root.debug("starting throwable pattern test");
  Exception ex=new Exception("Test Exception");
  root.debug("plain pattern, no exception");
  root.debug("plain pattern, with exception",ex);
  layout.setConversionPattern("%m%n%throwable");
  layout.activateOptions();
  root.debug("%throwable, no exception");
  root.debug("%throwable, with exception",ex);
  layout.setConversionPattern("%m%n%throwable{short}");
  layout.activateOptions();
  root.debug("%throwable{short}, no exception");
  root.debug("%throwable{short}, with exception",ex);
  layout.setConversionPattern("%m%n%throwable{none}");
  layout.activateOptions();
  root.debug("%throwable{none}, no exception");
  root.debug("%throwable{none}, with exception",ex);
  layout.setConversionPattern("%m%n%throwable{0}");
  layout.activateOptions();
  root.debug("%throwable{0}, no exception");
  root.debug("%throwable{0}, with exception",ex);
  layout.setConversionPattern("%m%n%throwable{1}");
  layout.activateOptions();
  root.debug("%throwable{1}, no exception");
  root.debug("%throwable{1}, with exception",ex);
  layout.setConversionPattern("%m%n%throwable{100}");
  layout.activateOptions();
  root.debug("%throwable{100}, no exception");
  root.debug("%throwable{100}, with exception",ex);
  String[] trace=new ThrowableInformation(ex).getThrowableStrRep();
  layout.setConversionPattern("%m%n%throwable{" + (2 - trace.length) + "}");
  layout.activateOptions();
  root.debug("%throwable{-n}, no exception");
  root.debug("%throwable{-n}, with exception",ex);
  Transformer.transform(OUTPUT_FILE,FILTERED,new Filter[]{new EnhancedLineNumberFilter(),new SunReflectFilter(),new EnhancedJunitTestRunnerFilter(),new MDCOrderFilter()});
  assertTrue(compare(FILTERED,WITNESS_FILE));
}
