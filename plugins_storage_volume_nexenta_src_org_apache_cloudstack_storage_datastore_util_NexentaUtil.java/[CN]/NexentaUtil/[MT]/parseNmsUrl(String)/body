{
  URI uri;
  try {
    uri=new URI(nmsUrl);
  }
 catch (  URISyntaxException e) {
    throw new IllegalArgumentException("Invalid URI: " + nmsUrl);
  }
  boolean isAuto=false;
  String schema=uri.getScheme();
  if (schema == null || schema.isEmpty() || "auto".equalsIgnoreCase(schema)) {
    schema="http";
    isAuto=true;
  }
  String username, password, userInfo=uri.getUserInfo();
  if (userInfo == null) {
    username=DEFAULT_NMS_USER;
    password=DEFAULT_NMS_PASSWORD;
  }
 else {
    if (userInfo.indexOf(':') < 0) {
      username=userInfo;
      password=DEFAULT_NMS_PASSWORD;
    }
 else {
      String[] parts=userInfo.split(":",2);
      username=parts[0];
      password=parts[1];
    }
  }
  String host=uri.getHost();
  if (host == null) {
    throw new IllegalArgumentException(String.format("NMS host required: %s.",nmsUrl));
  }
  int port=uri.getPort();
  if (port == -1) {
    port=DEFAULT_NMS_PORT;
  }
  return new NexentaNmsUrl(isAuto,schema,username,password,host,port);
}
