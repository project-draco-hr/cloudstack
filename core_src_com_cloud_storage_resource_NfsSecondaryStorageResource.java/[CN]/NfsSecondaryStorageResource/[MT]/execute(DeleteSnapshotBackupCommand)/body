{
  String secondaryStorageUrl=cmd.getSecondaryStorageUrl();
  Long accountId=cmd.getAccountId();
  Long volumeId=cmd.getVolumeId();
  String name=cmd.getSnapshotUuid();
  DataStoreTO dstore=cmd.getDataStore();
  if (dstore instanceof NfsTO) {
    final String result=deleteSnapshotBackupFromLocalFileSystem(secondaryStorageUrl,accountId,volumeId,name,cmd.isAll());
    if (result != null) {
      s_logger.warn(result);
      return new Answer(cmd,false,result);
    }
  }
 else   if (dstore instanceof S3TO) {
    final String result=deleteSnapshotBackupfromS3((S3TO)dstore,secondaryStorageUrl,accountId,volumeId,name,cmd.isAll());
    if (result != null) {
      s_logger.warn(result);
      return new Answer(cmd,false,result);
    }
  }
 else   if (dstore instanceof SwiftTO) {
    String filename;
    if (cmd.isAll()) {
      filename="";
    }
 else {
      filename=name;
    }
    String result=swiftDelete((SwiftTO)dstore,"V-" + volumeId.toString(),filename);
    if (result != null) {
      String errMsg="failed to delete snapshot " + filename + " , err="+ result;
      s_logger.warn(errMsg);
      return new Answer(cmd,false,errMsg);
    }
  }
 else {
    return new Answer(cmd,false,"Unsupported image data store: " + dstore);
  }
  return new Answer(cmd,true,"success");
}
