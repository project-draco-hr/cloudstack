{
  if (!_inSystemVM) {
    return new Answer(cmd,true,null);
  }
  List<String> iptablesCfg=new ArrayList<String>();
  iptablesCfg.add("iptables -F HTTP");
  for (  PortConfig pCfg : cmd.getPortConfigs()) {
    if (pCfg.isAdd()) {
      iptablesCfg.add("iptables -A HTTP -i " + pCfg.getIntf() + " -s "+ pCfg.getSourceIp()+ " -p tcp -m state --state NEW -m tcp --dport "+ pCfg.getPort()+ " -j ACCEPT");
    }
  }
  boolean success=true;
  StringBuilder result=new StringBuilder();
  for (  String rule : iptablesCfg) {
    Script command=new Script("/bin/bash",s_logger);
    command.add("-c");
    command.add(rule);
    String tmpresult=command.execute();
    if (tmpresult != null) {
      result.append(tmpresult);
      success=false;
    }
  }
  return new Answer(cmd,success,result.toString());
}
