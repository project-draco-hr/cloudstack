{
  String url=(String)dsInfos.get("url");
  Long zoneId=(Long)dsInfos.get("zoneId");
  Long podId=(Long)dsInfos.get("podId");
  Long clusterId=(Long)dsInfos.get("clusterId");
  String storagePoolName=(String)dsInfos.get("name");
  String providerName=(String)dsInfos.get("providerName");
  Long capacityBytes=(Long)dsInfos.get("capacityBytes");
  Long capacityIops=(Long)dsInfos.get("capacityIops");
  String tags=(String)dsInfos.get("tags");
  Map<String,String> details=(Map<String,String>)dsInfos.get("details");
  String storageIp=getStorageIp(url);
  int storagePort=getDefaultStoragePort(url);
  StoragePoolType storagetype=getStorageType(url);
  String accesspath=getAccessPath(url);
  String protocoltype=getProtocolType(url);
  String[] mp=accesspath.split("/");
  String mountpoint=mp[1];
  String uuid=null;
  if (details.get("esaccountid") != null)   ElastistorUtil.setElastistorAccountId(details.get("esaccountid"));
  if (details.get("esapikey") != null)   ElastistorUtil.setElastistorApiKey(details.get("esapikey"));
  if (details.get("esdefaultgateway") != null)   ElastistorUtil.setElastistorGateway(details.get("esdefaultgateway"));
  if (details.get("estntinterface") != null)   ElastistorUtil.setElastistorInterface(details.get("estntinterface"));
  if (details.get("esmanagementip") != null)   ElastistorUtil.setElastistorManagementIp(details.get("esmanagementip"));
  if (details.get("espoolid") != null)   ElastistorUtil.setElastistorPoolId(details.get("espoolid"));
  if (details.get("essubnet") != null)   ElastistorUtil.setElastistorSubnet(details.get("essubnet"));
  if (capacityBytes == null || capacityBytes <= 0) {
    throw new IllegalArgumentException("'capacityBytes' must be present and greater than 0.");
  }
  if (capacityIops == null || capacityIops <= 0) {
    throw new IllegalArgumentException("'capacityIops' must be present and greater than 0.");
  }
  List<StoragePoolVO> storagePoolVO=_storagePoolDao.listAll();
  for (  StoragePoolVO poolVO : storagePoolVO) {
    if (storagePoolName.equals(poolVO.getName())) {
      throw new IllegalArgumentException("storage pool with that name already exists in elastistor,please specify a unique name .");
    }
    if (storageIp.equals(poolVO.getHostAddress())) {
      throw new IllegalArgumentException("storage pool with that ip already exists in elastistor,please specify a unique ip .");
    }
  }
  PrimaryDataStoreParameters parameters=new PrimaryDataStoreParameters();
  parameters=createElastistorVolume(parameters,storagePoolName,storageIp,capacityBytes,capacityIops,protocoltype,mountpoint);
  parameters.setHost(storageIp);
  parameters.setPort(storagePort);
  if (protocoltype.contentEquals("nfs")) {
    parameters.setPath(accesspath);
  }
  parameters.setType(storagetype);
  parameters.setZoneId(zoneId);
  parameters.setPodId(podId);
  parameters.setName(storagePoolName);
  parameters.setProviderName(providerName);
  parameters.setManaged(false);
  parameters.setCapacityBytes(capacityBytes);
  parameters.setUsedBytes(0);
  parameters.setCapacityIops(capacityIops);
  parameters.setHypervisorType(HypervisorType.Any);
  parameters.setTags(tags);
  parameters.setDetails(details);
  parameters.setClusterId(clusterId);
  return _dataStoreHelper.createPrimaryDataStore(parameters);
}
