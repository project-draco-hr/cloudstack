{
  assert(conn != null);
  Transaction txn=new Transaction(name,false,CONNECTED_DB);
  txn._conn=conn;
  txn._prev=tls.get();
  tls.set(txn);
  txn.takeOver(name,true);
  try {
    s_logger.debug("Registering txn" + System.identityHashCode(txn));
    JmxUtil.registerMBean("Transaction","txn" + System.identityHashCode(txn),new TransactionMBeanImpl(txn));
  }
 catch (  Exception e) {
    s_logger.error("Unable to register MBean",e);
  }
  return txn;
}
