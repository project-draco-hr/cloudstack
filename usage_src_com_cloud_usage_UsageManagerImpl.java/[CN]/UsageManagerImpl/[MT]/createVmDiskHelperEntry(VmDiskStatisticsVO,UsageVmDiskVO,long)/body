{
  long currentAccountedIORead=0L;
  long currentAccountedIOWrite=0L;
  long currentAccountedBytesRead=0L;
  long currentAccountedBytesWrite=0L;
  if (usageVmDiskStat != null) {
    if (s_logger.isDebugEnabled()) {
      s_logger.debug("getting current accounted bytes for... accountId: " + usageVmDiskStat.getAccountId() + " in zone: "+ vmDiskStat.getDataCenterId()+ "; aiw: "+ vmDiskStat.getAggIOWrite()+ "; air: "+ usageVmDiskStat.getAggIORead()+ "; abw: "+ vmDiskStat.getAggBytesWrite()+ "; abr: "+ usageVmDiskStat.getAggBytesRead());
    }
    currentAccountedIORead=usageVmDiskStat.getAggIORead();
    currentAccountedIOWrite=usageVmDiskStat.getAggIOWrite();
    currentAccountedBytesRead=usageVmDiskStat.getAggBytesRead();
    currentAccountedBytesWrite=usageVmDiskStat.getAggBytesWrite();
  }
  long ioRead=vmDiskStat.getAggIORead() - currentAccountedIORead;
  long ioWrite=vmDiskStat.getAggIOWrite() - currentAccountedIOWrite;
  long bytesRead=vmDiskStat.getAggBytesRead() - currentAccountedBytesRead;
  long bytesWrite=vmDiskStat.getAggBytesWrite() - currentAccountedBytesWrite;
  if (ioRead < 0) {
    s_logger.warn("Calculated negative value for io read: " + ioRead + ", vm disk stats say: "+ vmDiskStat.getAggIORead()+ ", previous vm disk usage was: "+ currentAccountedIORead);
    ioRead=0;
  }
  if (ioWrite < 0) {
    s_logger.warn("Calculated negative value for io write: " + ioWrite + ", vm disk stats say: "+ vmDiskStat.getAggIOWrite()+ ", previous vm disk usage was: "+ currentAccountedIOWrite);
    ioWrite=0;
  }
  if (bytesRead < 0) {
    s_logger.warn("Calculated negative value for bytes read: " + bytesRead + ", vm disk stats say: "+ vmDiskStat.getAggBytesRead()+ ", previous vm disk usage was: "+ currentAccountedBytesRead);
    bytesRead=0;
  }
  if (bytesWrite < 0) {
    s_logger.warn("Calculated negative value for bytes write: " + bytesWrite + ", vm disk stats say: "+ vmDiskStat.getAggBytesWrite()+ ", previous vm disk usage was: "+ currentAccountedBytesWrite);
    bytesWrite=0;
  }
  long vmId=0;
  if (vmDiskStat.getVmId() != null) {
    vmId=vmDiskStat.getVmId();
  }
  UsageVmDiskVO usageVmDiskVO=new UsageVmDiskVO(vmDiskStat.getAccountId(),vmDiskStat.getDataCenterId(),vmId,vmDiskStat.getVolumeId(),ioRead,ioWrite,vmDiskStat.getAggIORead(),vmDiskStat.getAggIOWrite(),bytesRead,bytesWrite,vmDiskStat.getAggBytesRead(),vmDiskStat.getAggBytesWrite(),timestamp);
  if (s_logger.isDebugEnabled()) {
    s_logger.debug("creating vmDiskHelperEntry... accountId: " + vmDiskStat.getAccountId() + " in zone: "+ vmDiskStat.getDataCenterId()+ "; aiw: "+ vmDiskStat.getAggIOWrite()+ "; air: "+ vmDiskStat.getAggIORead()+ "; curAIR: "+ currentAccountedIORead+ "; curAIW: "+ currentAccountedIOWrite+ "; uir: "+ ioRead+ "; uiw: "+ ioWrite+ "; abw: "+ vmDiskStat.getAggBytesWrite()+ "; abr: "+ vmDiskStat.getAggBytesRead()+ "; curABR: "+ currentAccountedBytesRead+ "; curABW: "+ currentAccountedBytesWrite+ "; ubr: "+ bytesRead+ "; ubw: "+ bytesWrite);
  }
  usageVmDisks.add(usageVmDiskVO);
}
