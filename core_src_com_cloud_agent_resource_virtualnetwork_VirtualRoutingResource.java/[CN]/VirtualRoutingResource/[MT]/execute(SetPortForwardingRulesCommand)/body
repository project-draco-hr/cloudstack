{
  String routerIp=cmd.getAccessDetail(RoutingCommand.ROUTER_IP);
  String routerName=cmd.getAccessDetail(RoutingCommand.ROUTER_NAME);
  String[] results=new String[cmd.getRules().length];
  int i=0;
  for (  PortForwardingRuleTO rule : cmd.getRules()) {
    String result=null;
    if (rule.getProtocol().equalsIgnoreCase(NetUtils.NAT_PROTO)) {
      setStaticNat(!rule.revoked(),routerName,routerIp,rule.getSrcIp(),rule.getDstIp());
    }
 else {
      result=setPortForwardRule(!rule.revoked(),routerName,routerIp,rule.getProtocol(),rule.getSrcIp(),Integer.toString(rule.getSrcPortRange()[0]),rule.getDstIp(),Integer.toString(rule.getDstPortRange()[0]));
    }
    results[i++]=(result == null || result.isEmpty()) ? "Failed" : null;
  }
  return new SetPortForwardingRulesAnswer(cmd,results);
}
