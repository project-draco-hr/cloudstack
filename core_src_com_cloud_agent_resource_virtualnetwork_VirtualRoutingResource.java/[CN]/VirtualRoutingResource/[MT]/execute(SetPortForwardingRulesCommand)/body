{
  String routerIp=cmd.getAccessDetail(NetworkElementCommand.ROUTER_IP);
  String[] results=new String[cmd.getRules().length];
  int i=0;
  for (  PortForwardingRuleTO rule : cmd.getRules()) {
    String result=null;
    final Script command=new Script(_firewallPath,_timeout,s_logger);
    command.add(routerIp);
    command.add(rule.revoked() ? "-D" : "-A");
    if (rule.isOneToOneNat()) {
      command.add(" -l ",rule.getSrcIp());
      command.add(" -r ",rule.getDstIp());
      command.add(" -P ",rule.getProtocol().toLowerCase());
      command.add(" -d ",rule.getStringDstPortRange());
      command.add(" -G ");
    }
 else {
      command.add("-P ",rule.getProtocol().toLowerCase());
      command.add("-l ",rule.getSrcIp());
      command.add("-p ",rule.getStringSrcPortRange());
      command.add("-r ",rule.getDstIp());
      command.add("-d ",rule.getStringDstPortRange());
    }
    result=command.execute();
    results[i++]=(!(result == null || result.isEmpty())) ? "Failed" : null;
  }
  return new SetPortForwardingRulesAnswer(cmd,results);
}
