{
  NicTO nic=cmd.getNic();
  String routerIP=cmd.getAccessDetail(NetworkElementCommand.ROUTER_IP);
  String routerGIP=cmd.getAccessDetail(NetworkElementCommand.ROUTER_GUEST_IP);
  String gateway=cmd.getAccessDetail(NetworkElementCommand.GUEST_NETWORK_GATEWAY);
  String cidr=Long.toString(NetUtils.getCidrSize(nic.getNetmask()));
  String domainName=cmd.getNetworkDomain();
  String dns=cmd.getDefaultDns1();
  if (dns == null || dns.isEmpty()) {
    dns=cmd.getDefaultDns2();
  }
 else {
    String dns2=cmd.getDefaultDns2();
    if (dns2 != null && !dns2.isEmpty()) {
      dns+="," + dns2;
    }
  }
  String dev="eth" + nic.getDeviceId();
  String netmask=NetUtils.getSubNet(routerGIP,nic.getNetmask());
  String args=" -C";
  args+=" -M " + nic.getMac();
  args+=" -d " + dev;
  args+=" -i " + routerGIP;
  args+=" -g " + gateway;
  args+=" -m " + cidr;
  args+=" -n " + netmask;
  if (dns != null && !dns.isEmpty()) {
    args+=" -s " + dns;
  }
  if (domainName != null && !domainName.isEmpty()) {
    args+=" -e " + domainName;
  }
  ExecutionResult result=_vrDeployer.executeInVR(routerIP,"vpc_guestnw.sh",args);
  if (!result.isSuccess()) {
    return new SetupGuestNetworkAnswer(cmd,false,"Creating guest network failed due to " + result.getDetails());
  }
  return new SetupGuestNetworkAnswer(cmd,true,"success");
}
