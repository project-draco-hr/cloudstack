{
  String args;
  if (cmd.isNat()) {
    if (cmd.isCreate())     args="-A";
 else     args="-D";
    args+=" -l " + cmd.getPublicIpAddress();
    args+=" -i " + cmd.getRouterIpAddress();
    args+=" -r " + cmd.getPrivateIpAddress();
    args+=" -G " + cmd.getProtocol();
  }
 else {
    if (cmd.isEnable()) {
      args="-A";
    }
 else {
      args="-D";
    }
    args+=" -P " + cmd.getProtocol().toLowerCase();
    args+=" -l " + cmd.getPublicIpAddress();
    args+=" -p " + cmd.getPublicPort();
    args+=" -n " + cmd.getRouterName();
    args+=" -i " + cmd.getRouterIpAddress();
    args+=" -r " + cmd.getPrivateIpAddress();
    args+=" -d " + cmd.getPrivatePort();
    args+=" -N " + cmd.getVlanNetmask();
    String oldPrivateIP=cmd.getOldPrivateIP();
    String oldPrivatePort=cmd.getOldPrivatePort();
    if (oldPrivateIP != null) {
      args+=" -w " + oldPrivateIP;
    }
    if (oldPrivatePort != null) {
      args+=" -x " + oldPrivatePort;
    }
  }
  final Script command=new Script(_firewallPath,_timeout,s_logger);
  String[] argsArray=args.split(" ");
  for (  String param : argsArray) {
    command.add(param);
  }
  String result=command.execute();
  return new Answer(cmd,result == null,result);
}
