{
  if (routerIpAddress == null) {
    s_logger.warn("SetFirewallRuleCommand did nothing because Router IP address was null when creating rule for public IP: " + publicIpAddress);
    return null;
  }
  if (oldPrivateIP == null) {
    oldPrivateIP="";
  }
  if (oldPrivatePort == null) {
    oldPrivatePort="";
  }
  final Script command=new Script(_firewallPath,_timeout,s_logger);
  command.add(enable ? "-A" : "-D");
  command.add("-P",protocol);
  command.add("-l",publicIpAddress);
  command.add("-p",publicPort);
  command.add("-n",routerName);
  command.add("-i",routerIpAddress);
  command.add("-r",privateIpAddress);
  command.add("-d",privatePort);
  command.add("-N",vlanNetmask);
  command.add("-w",oldPrivateIP);
  command.add("-x",oldPrivatePort);
  return command.execute();
}
