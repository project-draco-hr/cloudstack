{
  String[] results=new String[cmd.getRules().length];
  String routerAccessIp=cmd.getRouterAccessIp();
  if (routerAccessIp == null) {
    return new SetFirewallRulesAnswer(cmd,false,results);
  }
  List<ConfigItem> cfg=generateConfig(cmd);
  ConfigItem c=cfg.get(0);
  ExecutionResult result=_vrDeployer.executeInVR(routerAccessIp,c.getScript(),c.getArgs());
  if (!result.isSuccess()) {
    for (int i=0; i < results.length; i++) {
      results[i]="Failed: " + result.getDetails();
    }
    return new SetFirewallRulesAnswer(cmd,false,results);
  }
  return new SetFirewallRulesAnswer(cmd,true,results);
}
