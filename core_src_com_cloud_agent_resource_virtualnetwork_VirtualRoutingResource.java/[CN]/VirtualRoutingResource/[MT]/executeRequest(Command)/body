{
  try {
    ExecutionResult rc=_vrDeployer.prepareCommand((NetworkElementCommand)cmd);
    if (!rc.isSuccess()) {
      s_logger.error("Failed to prepare VR command due to " + rc.getDetails());
      return new Answer(cmd,false,rc.getDetails());
    }
    Answer answer;
    if (cmd instanceof SetPortForwardingRulesVpcCommand) {
      answer=execute((SetPortForwardingRulesVpcCommand)cmd);
    }
 else     if (cmd instanceof SetPortForwardingRulesCommand) {
      answer=execute((SetPortForwardingRulesCommand)cmd);
    }
 else     if (cmd instanceof SetStaticRouteCommand) {
      answer=execute((SetStaticRouteCommand)cmd);
    }
 else     if (cmd instanceof SetStaticNatRulesCommand) {
      answer=execute((SetStaticNatRulesCommand)cmd);
    }
 else     if (cmd instanceof LoadBalancerConfigCommand) {
      answer=execute((LoadBalancerConfigCommand)cmd);
    }
 else     if (cmd instanceof SavePasswordCommand) {
      answer=execute((SavePasswordCommand)cmd);
    }
 else     if (cmd instanceof DhcpEntryCommand) {
      answer=execute((DhcpEntryCommand)cmd);
    }
 else     if (cmd instanceof CreateIpAliasCommand) {
      answer=execute((CreateIpAliasCommand)cmd);
    }
 else     if (cmd instanceof DnsMasqConfigCommand) {
      answer=execute((DnsMasqConfigCommand)cmd);
    }
 else     if (cmd instanceof DeleteIpAliasCommand) {
      answer=execute((DeleteIpAliasCommand)cmd);
    }
 else     if (cmd instanceof VmDataCommand) {
      answer=execute((VmDataCommand)cmd);
    }
 else     if (cmd instanceof CheckRouterCommand) {
      answer=execute((CheckRouterCommand)cmd);
    }
 else     if (cmd instanceof SetFirewallRulesCommand) {
      answer=execute((SetFirewallRulesCommand)cmd);
    }
 else     if (cmd instanceof BumpUpPriorityCommand) {
      answer=execute((BumpUpPriorityCommand)cmd);
    }
 else     if (cmd instanceof RemoteAccessVpnCfgCommand) {
      answer=execute((RemoteAccessVpnCfgCommand)cmd);
    }
 else     if (cmd instanceof VpnUsersCfgCommand) {
      answer=execute((VpnUsersCfgCommand)cmd);
    }
 else     if (cmd instanceof GetDomRVersionCmd) {
      answer=execute((GetDomRVersionCmd)cmd);
    }
 else     if (cmd instanceof Site2SiteVpnCfgCommand) {
      answer=execute((Site2SiteVpnCfgCommand)cmd);
    }
 else     if (cmd instanceof CheckS2SVpnConnectionsCommand) {
      answer=execute((CheckS2SVpnConnectionsCommand)cmd);
    }
 else     if (cmd instanceof SetMonitorServiceCommand) {
      answer=execute((SetMonitorServiceCommand)cmd);
    }
 else     if (cmd instanceof SetupGuestNetworkCommand) {
      answer=execute((SetupGuestNetworkCommand)cmd);
    }
 else     if (cmd instanceof SetNetworkACLCommand) {
      answer=execute((SetNetworkACLCommand)cmd);
    }
 else     if (cmd instanceof SetSourceNatCommand) {
      answer=execute((SetSourceNatCommand)cmd);
    }
 else     if (cmd instanceof IpAssocVpcCommand) {
      answer=execute((IpAssocVpcCommand)cmd);
    }
 else     if (cmd instanceof IpAssocCommand) {
      answer=execute((IpAssocCommand)cmd);
    }
 else {
      answer=Answer.createUnsupportedCommandAnswer(cmd);
    }
    rc=_vrDeployer.cleanupCommand((NetworkElementCommand)cmd);
    if (!rc.isSuccess()) {
      s_logger.error("Failed to clean up VR command due to " + rc.getDetails());
      answer=new Answer(cmd,false,rc.getDetails());
    }
    return answer;
  }
 catch (  final IllegalArgumentException e) {
    return new Answer(cmd,false,e.getMessage());
  }
 finally {
    ExecutionResult rc=_vrDeployer.cleanupCommand((NetworkElementCommand)cmd);
    if (!rc.isSuccess()) {
      s_logger.error("Failed to cleanup VR command due to " + rc.getDetails());
    }
  }
}
