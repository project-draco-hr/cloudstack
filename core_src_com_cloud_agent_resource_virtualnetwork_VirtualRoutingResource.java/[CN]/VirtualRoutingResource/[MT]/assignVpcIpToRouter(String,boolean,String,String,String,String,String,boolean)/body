{
  String args="";
  String snatArgs="";
  if (add) {
    args+=" -A ";
    snatArgs+=" -A ";
  }
 else {
    args+=" -D ";
    snatArgs+=" -D ";
  }
  args+=" -l ";
  args+=pubIP;
  args+=" -c ";
  args+=nicname;
  args+=" -g ";
  args+=gateway;
  args+=" -m ";
  args+=netmask;
  args+=" -n ";
  args+=subnet;
  String result=routerProxy("vpc_ipassoc.sh",routerIP,args);
  if (result != null) {
    throw new InternalErrorException("KVM plugin \"vpc_ipassoc\" failed:" + result);
  }
  if (sourceNat) {
    snatArgs+=" -l " + pubIP;
    snatArgs+=" -c " + nicname;
    result=routerProxy("vpc_privateGateway.sh",routerIP,snatArgs);
    if (result != null) {
      throw new InternalErrorException("KVM plugin \"vpc_privateGateway\" failed:" + result);
    }
  }
}
