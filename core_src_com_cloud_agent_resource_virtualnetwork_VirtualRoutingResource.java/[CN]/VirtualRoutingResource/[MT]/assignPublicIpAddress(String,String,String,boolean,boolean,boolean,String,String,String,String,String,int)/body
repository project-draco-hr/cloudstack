{
  final Script command=new Script(_ipassocPath,_timeout,s_logger);
  command.add(privateIpAddress);
  if (add) {
    command.add("-A");
  }
 else {
    command.add("-D");
  }
  String cidrSize=Long.toString(NetUtils.getCidrSize(vlanNetmask));
  if (sourceNat) {
    command.add("-f");
    command.add("-l",publicIpAddress + "/" + cidrSize);
  }
 else   if (firstIP) {
    command.add("-f");
    command.add("-l",publicIpAddress + "/" + cidrSize);
  }
 else {
    command.add("-l",publicIpAddress);
  }
  String publicNic="eth" + nicNum;
  command.add("-c",publicNic);
  return command.execute();
}
