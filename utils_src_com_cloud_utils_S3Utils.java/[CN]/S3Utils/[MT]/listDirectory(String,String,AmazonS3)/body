{
  List<S3ObjectSummary> objects=new ArrayList<S3ObjectSummary>();
  ListObjectsRequest listObjectsRequest=new ListObjectsRequest().withBucketName(bucketName).withPrefix(directory + SEPARATOR);
  ObjectListing ol=client.listObjects(listObjectsRequest);
  if (ol.isTruncated()) {
    do {
      objects.addAll(ol.getObjectSummaries());
      listObjectsRequest.setMarker(ol.getNextMarker());
      ol=client.listObjects(listObjectsRequest);
    }
 while (ol.isTruncated());
  }
 else {
    objects.addAll(ol.getObjectSummaries());
  }
  if (objects.isEmpty()) {
    return emptyList();
  }
  return unmodifiableList(objects);
}
