{
  DbTestDao testDao=ComponentLocator.inject(DbTestDao.class);
  Transaction txn=Transaction.open("SingleConnectionThread");
  Connection conn=null;
  try {
    conn=Transaction.getStandaloneConnectionWithException();
    txn.transitToUserManagedConnection(conn);
    testDao.create(1,1,"Record 1");
    Connection checkConn=Transaction.currentTxn().getConnection();
    if (checkConn != conn) {
      Assert.fail("A new db connection is acquired instead of using old one after create sql");
    }
    testDao.update(2,2,"Record 1");
    Connection checkConn2=Transaction.currentTxn().getConnection();
    if (checkConn2 != conn) {
      Assert.fail("A new db connection is acquired instead of using old one after update sql");
    }
  }
 catch (  SQLException e) {
    Assert.fail(e.getMessage());
  }
 finally {
    txn.transitToAutoManagedConnection(Transaction.CLOUD_DB);
    txn.close();
    if (conn != null) {
      try {
        conn.close();
      }
 catch (      SQLException e) {
        throw new CloudRuntimeException("Problem with close db connection",e);
      }
    }
  }
}
