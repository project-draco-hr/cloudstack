{
  BlockableVectorAppender blockableAppender=new BlockableVectorAppender();
  AsyncAppender async=new AsyncAppender();
  async.addAppender(blockableAppender);
  async.setBufferSize(5);
  async.setLocationInfo(false);
  async.activateOptions();
  Logger rootLogger=Logger.getRootLogger();
  rootLogger.addAppender(async);
  StringBuffer buf=new StringBuffer("Hello");
synchronized (blockableAppender.getMonitor()) {
    rootLogger.info(buf);
    buf.append(", World.");
  }
  async.close();
  Vector events=blockableAppender.getVector();
  LoggingEvent event=(LoggingEvent)events.get(0);
  PatternLayout layout=new PatternLayout();
  layout.setConversionPattern("%m");
  layout.activateOptions();
  String msg=layout.format(event);
  assertEquals("Hello",msg);
}
