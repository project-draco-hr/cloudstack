{
  DataTO srcData=cmd.getSrcTO();
  DataTO destData=cmd.getDestTO();
  TemplateObjectTO template=(TemplateObjectTO)srcData;
  DataStoreTO imageStore=template.getDataStore();
  VolumeObjectTO volume=(VolumeObjectTO)destData;
  PrimaryDataStoreTO primaryStore=(PrimaryDataStoreTO)volume.getDataStore();
  KVMPhysicalDisk BaseVol=null;
  KVMStoragePool primaryPool=null;
  KVMPhysicalDisk vol=null;
  try {
    primaryPool=storagePoolMgr.getStoragePool(primaryStore.getPoolType(),primaryStore.getUuid());
    String templatePath=template.getPath();
    if (primaryPool.getType() == StoragePoolType.CLVM) {
      vol=templateToPrimaryDownload(templatePath,primaryPool);
    }
 else {
      BaseVol=primaryPool.getPhysicalDisk(templatePath);
      vol=storagePoolMgr.createDiskFromTemplate(BaseVol,UUID.randomUUID().toString(),primaryPool);
    }
    if (vol == null) {
      return new CopyCmdAnswer(" Can't create storage volume on storage pool");
    }
    VolumeObjectTO newVol=new VolumeObjectTO();
    newVol.setPath(vol.getName());
    newVol.setSize(volume.getSize());
    return new CopyCmdAnswer(newVol);
  }
 catch (  CloudRuntimeException e) {
    s_logger.debug("Failed to create volume: " + e.toString());
    return new CopyCmdAnswer(e.toString());
  }
}
