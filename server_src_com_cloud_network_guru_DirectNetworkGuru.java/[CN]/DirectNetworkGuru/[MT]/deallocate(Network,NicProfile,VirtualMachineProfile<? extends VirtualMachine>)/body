{
  if (s_logger.isDebugEnabled()) {
    s_logger.debug("Deallocate network: networkId: " + nic.getNetworkId() + ", ip: "+ nic.getIp4Address());
  }
  if (nic.getIp4Address() != null) {
    IPAddressVO ip=_ipAddressDao.findByIpAndSourceNetworkId(nic.getNetworkId(),nic.getIp4Address());
    if (ip != null) {
      Transaction txn=Transaction.currentTxn();
      txn.start();
      _networkMgr.markIpAsUnavailable(ip.getId());
      _ipAddressDao.unassignIpAddress(ip.getId());
      txn.commit();
    }
  }
  if (nic.getIp6Address() != null) {
    _ipv6Mgr.revokeDirectIpv6Address(nic.getNetworkId(),nic.getIp6Address());
  }
  nic.deallocate();
}
