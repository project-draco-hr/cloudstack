{
  if (_vmSnapshotMgr.hasActiveVMSnapshotTasks(vm.getId())) {
    s_logger.error("State transit with event: " + e + " failed due to: "+ vm.getInstanceName()+ " has active VM snapshots tasks");
    return false;
  }
  vm.setReservationId(reservationId);
  return _stateMachine.transitTo(vm,e,new Pair<Long,Long>(vm.getHostId(),hostId),_vmDao);
}
