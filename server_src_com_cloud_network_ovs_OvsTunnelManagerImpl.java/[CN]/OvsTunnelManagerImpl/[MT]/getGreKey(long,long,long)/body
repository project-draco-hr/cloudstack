{
  OvsTunnelAccountVO ta=null;
  int key;
  try {
    key=_tunnelDao.askKey(from,to);
    ta=new OvsTunnelAccountVO(from,to,key,account);
    OvsTunnelAccountVO lock=_tunnelAccountDao.acquireInLockTable(Long.valueOf(1));
    if (lock == null) {
      s_logger.warn("Cannot lock table ovs_tunnel_account");
      return -1;
    }
    _tunnelAccountDao.persist(ta);
    _tunnelAccountDao.releaseFromLockTable(lock.getId());
  }
 catch (  EntityExistsException e) {
    ta=_tunnelAccountDao.getByFromToAccount(from,to,account);
    if (ta == null) {
      key=-1;
    }
 else {
      key=ta.getKey();
    }
  }
  return key;
}
