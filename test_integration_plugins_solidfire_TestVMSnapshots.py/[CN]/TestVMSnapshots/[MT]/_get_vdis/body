def _get_vdis(self, xen_vdis, only_active_expected=False):
    expected_number_of_vdis = (1 if only_active_expected else 3)
    self.assertEqual(len(xen_vdis), expected_number_of_vdis, 'The list had an unexpected number of items in it.')
    active_vdi = None
    snapshot_vdi = None
    base_vdi = None
    for temp_vdi in xen_vdis:
        temp = self.xen_session.xenapi.VDI.get_record(temp_vdi)
        if (temp['name_label'] == 'base copy'):
            base_vdi = temp
        elif (temp['is_a_snapshot'] == True):
            snapshot_vdi = temp
        else:
            active_vdi = temp
    self.assertNotEqual(active_vdi, None, 'The active VDI could not be located.')
    if only_active_expected:
        self.assertEqual(snapshot_vdi, None, 'The snapshot VDI should not be present.')
        self.assertEqual(base_vdi, None, 'The base VDI should not be present.')
    else:
        self.assertNotEqual(snapshot_vdi, None, 'The snapshot VDI could not be located.')
        self.assertNotEqual(base_vdi, None, 'The base VDI could not be located.')


    class VdiCollection(object):
        pass
    vdis = VdiCollection()
    vdis.active_vdi = active_vdi
    vdis.snapshot_vdi = snapshot_vdi
    vdis.base_vdi = base_vdi
    return vdis
