def stopVM(self, vm):
    'Stop VM and verify that it is indeed in stopped state'
    try:
        vm.stop(self.apiclient)
    except Exception as e:
        self.fail(('Failed to stop VM: %s' % e))
    retriesCount = 10
    while True:
        vmlist = VirtualMachine.list(self.apiclient, id=vm.id)
        if (str(vmlist[0].state).lower() == 'stopped'):
            break
        elif (retriesCount == 0):
            self.fail('Failed to stop VM even after 10 minutes')
        else:
            retriesCount -= 1
            time.sleep(60)
            continue
    return
