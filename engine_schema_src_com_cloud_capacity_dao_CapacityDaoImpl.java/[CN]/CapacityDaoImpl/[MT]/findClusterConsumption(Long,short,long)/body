{
  TransactionLegacy txn=TransactionLegacy.currentTxn();
  StringBuilder sql=new StringBuilder(FIND_CLUSTER_CONSUMPTION_RATIO);
  PreparedStatement pstmt=null;
  try {
    pstmt=txn.prepareAutoCloseStatement(sql.toString());
    pstmt.setLong(1,computeRequested);
    pstmt.setLong(2,clusterId);
    pstmt.setShort(3,capacityType);
    ResultSet rs=pstmt.executeQuery();
    while (rs.next()) {
      return rs.getFloat(1);
    }
  }
 catch (  Exception e) {
    logger.warn("Error checking cluster threshold",e);
  }
  return 0;
}
