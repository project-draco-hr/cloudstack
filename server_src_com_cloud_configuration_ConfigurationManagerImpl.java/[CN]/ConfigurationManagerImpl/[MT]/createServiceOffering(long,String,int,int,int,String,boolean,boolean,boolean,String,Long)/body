{
  String networkRateStr=_configDao.getValue("network.throttling.rate");
  String multicastRateStr=_configDao.getValue("multicast.throttling.rate");
  int networkRate=((networkRateStr == null) ? 200 : Integer.parseInt(networkRateStr));
  int multicastRate=((multicastRateStr == null) ? 10 : Integer.parseInt(multicastRateStr));
  NetworkOffering.GuestIpType guestIpType=useVirtualNetwork ? NetworkOffering.GuestIpType.Virtualized : NetworkOffering.GuestIpType.DirectSingle;
  tags=cleanupTags(tags);
  ServiceOfferingVO offering=new ServiceOfferingVO(name,cpu,ramSize,speed,networkRate,multicastRate,offerHA,displayText,guestIpType,localStorageRequired,false,tags,false,domainId);
  if ((offering=_serviceOfferingDao.persist(offering)) != null) {
    saveConfigurationEvent(userId,null,EventTypes.EVENT_SERVICE_OFFERING_CREATE,"Successfully created new service offering with name: " + name + ".","soId=" + offering.getId(),"name=" + name,"numCPUs=" + cpu,"ram=" + ramSize,"cpuSpeed=" + speed,"displayText=" + displayText,"guestIPType=" + guestIpType,"localStorageRequired=" + localStorageRequired,"offerHA=" + offerHA,"useVirtualNetwork=" + useVirtualNetwork,"tags=" + tags);
    return offering;
  }
 else {
    return null;
  }
}
