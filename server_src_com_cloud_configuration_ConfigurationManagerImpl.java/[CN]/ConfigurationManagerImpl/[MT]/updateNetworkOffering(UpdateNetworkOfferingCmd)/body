{
  String displayText=cmd.getDisplayText();
  Long id=cmd.getId();
  String name=cmd.getNetworkOfferingName();
  String availabilityStr=cmd.getAvailability();
  Integer sortKey=cmd.getSortKey();
  Availability availability=null;
  UserContext.current().setEventDetails(" Id: " + id);
  NetworkOfferingVO offeringToUpdate=_networkOfferingDao.findById(id);
  if (offeringToUpdate == null) {
    throw new InvalidParameterValueException("unable to find network offering " + id);
  }
  if (offeringToUpdate.isSystemOnly()) {
    throw new InvalidParameterValueException("Can't update system network offerings");
  }
  if (offeringToUpdate.isDefault() && offeringToUpdate.getGuestType() == GuestIpType.Direct) {
    throw new InvalidParameterValueException("Can't update Default Direct network offering");
  }
  NetworkOfferingVO offering=_networkOfferingDao.createForUpdate(id);
  if (name != null) {
    offering.setName(name);
  }
  if (displayText != null) {
    offering.setDisplayText(displayText);
  }
  if (sortKey != null) {
    offering.setSortKey(sortKey);
  }
  if (availabilityStr != null) {
    for (    Availability avlb : Availability.values()) {
      if (avlb.name().equalsIgnoreCase(availabilityStr)) {
        availability=avlb;
      }
    }
    if (availability == null) {
      throw new InvalidParameterValueException("Invalid value for Availability. Supported types: " + Availability.Required + ", "+ Availability.Optional+ ", "+ Availability.Unavailable);
    }
 else {
      offering.setAvailability(availability);
    }
  }
  if (_networkOfferingDao.update(id,offering)) {
    offering=_networkOfferingDao.findById(id);
    return offering;
  }
 else {
    return null;
  }
}
