{
  String endIp=cmd.getEndIp();
  String gateway=cmd.getGateway();
  String name=cmd.getPodName();
  String startIp=cmd.getStartIp();
  String netmask=cmd.getNetmask();
  Long zoneId=cmd.getZoneId();
  String cidr=NetUtils.ipAndNetMaskToCidr(gateway,netmask);
  DataCenterVO zone=_zoneDao.findById(zoneId);
  if (zone == null) {
    throw new InvalidParameterValueException("Failed to create pod " + name + " -- unable to find zone "+ zoneId);
  }
  if (endIp != null && startIp == null) {
    throw new InvalidParameterValueException("Failed to create pod " + name + " -- if an end IP is specified, a start IP must be specified.");
  }
  Long userId=UserContext.current().getUserId();
  if (userId == null) {
    userId=Long.valueOf(User.UID_SYSTEM);
  }
  return createPod(userId.longValue(),name,zoneId,gateway,cidr,startIp,endIp);
}
