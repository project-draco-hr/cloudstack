{
  tags=cleanupTags(tags);
  ServiceOfferingVO offering=new ServiceOfferingVO(name,cpu,ramSize,speed,networkRate,null,offerHA,limitResourceUse,volatileVm,displayText,localStorageRequired,false,tags,isSystem,vm_type,domainId,hostTag,deploymentPlanner);
  if ((bytesRate != null) && (bytesRate > 0))   offering.setBytesRate(bytesRate);
  if ((iopsRate != null) && (iopsRate > 0))   offering.setIopsRate(iopsRate);
  if ((offering=_serviceOfferingDao.persist(offering)) != null) {
    if (details != null) {
      _serviceOfferingDetailsDao.persist(offering.getId(),details);
    }
    UserContext.current().setEventDetails("Service offering id=" + offering.getId());
    return offering;
  }
 else {
    return null;
  }
}
