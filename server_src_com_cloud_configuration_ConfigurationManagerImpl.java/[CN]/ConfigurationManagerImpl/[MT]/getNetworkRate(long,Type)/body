{
  NetworkOffering no=getNetworkOffering(networkOfferingId);
  if (no == null) {
    throw new InvalidParameterValueException("Unable to find network offering by id=" + networkOfferingId);
  }
  if (vmType != null && vmType == VirtualMachine.Type.DomainRouter && no.getTrafficType() == TrafficType.Public && no.getGuestType() == null) {
    List<? extends NetworkOffering> guestOfferings=_networkOfferingDao.listByTrafficTypeAndGuestType(false,TrafficType.Guest,GuestIpType.Virtual);
    if (!guestOfferings.isEmpty()) {
      no=guestOfferings.get(0);
    }
  }
  Integer networkRate;
  if (no.getRateMbps() != null) {
    networkRate=no.getRateMbps();
  }
 else {
    networkRate=Integer.parseInt(_configDao.getValue(Config.NetworkThrottlingRate.key()));
  }
  if (networkRate == 0) {
    networkRate=-1;
  }
  return networkRate;
}
