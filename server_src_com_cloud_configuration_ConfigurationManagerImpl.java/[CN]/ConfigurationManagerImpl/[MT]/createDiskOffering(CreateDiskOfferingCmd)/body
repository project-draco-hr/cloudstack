{
  Long domainId=cmd.getDomainId();
  String name=cmd.getOfferingName();
  String description=cmd.getDisplayText();
  int numGibibytes=cmd.getDiskSize().intValue();
  String tags=cmd.getTags();
  if (domainId == null) {
    domainId=Long.valueOf(DomainVO.ROOT_DOMAIN);
  }
  if ((numGibibytes != 0) && (numGibibytes < 1)) {
    throw new InvalidParameterValueException("Please specify a disk size of at least 1 Gb.");
  }
 else   if (numGibibytes > _maxVolumeSizeInGb) {
    throw new InvalidParameterValueException("The maximum size for a disk is " + _maxVolumeSizeInGb + " Gb.");
  }
  long diskSize=numGibibytes * 1024;
  tags=cleanupTags(tags);
  DiskOfferingVO newDiskOffering=new DiskOfferingVO(domainId,name,description,diskSize,tags);
  return _diskOfferingDao.persist(newDiskOffering);
}
