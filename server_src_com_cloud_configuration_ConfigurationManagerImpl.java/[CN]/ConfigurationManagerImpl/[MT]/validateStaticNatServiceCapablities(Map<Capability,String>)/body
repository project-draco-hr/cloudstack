{
  if (staticNatServiceCapabilityMap != null && !staticNatServiceCapabilityMap.isEmpty()) {
    if (staticNatServiceCapabilityMap.keySet().size() > 2) {
      throw new InvalidParameterValueException("Only " + Capability.ElasticIp.getName() + " and "+ Capability.AssociatePublicIP.getName()+ " capabilitiy can be sepcified for static nat service");
    }
    boolean eipEnabled=false;
    boolean eipDisabled=false;
    boolean associatePublicIP=true;
    for (    Capability capability : staticNatServiceCapabilityMap.keySet()) {
      String value=staticNatServiceCapabilityMap.get(capability);
      if (capability == Capability.ElasticIp) {
        eipEnabled=value.contains("true");
        eipDisabled=value.contains("false");
        if (!eipEnabled && !eipDisabled) {
          throw new InvalidParameterValueException("Unknown specified value for " + Capability.ElasticIp.getName());
        }
      }
 else       if (capability == Capability.AssociatePublicIP) {
        if (value.contains("true")) {
          associatePublicIP=true;
        }
 else         if (value.contains("false")) {
          associatePublicIP=false;
        }
 else {
          throw new InvalidParameterValueException("Unknown specified value for " + Capability.AssociatePublicIP.getName());
        }
      }
 else {
        throw new InvalidParameterValueException("Only " + Capability.ElasticIp.getName() + " and "+ Capability.AssociatePublicIP.getName()+ " capabilitiy can be sepcified for static nat service");
      }
      if (eipDisabled && associatePublicIP) {
        throw new InvalidParameterValueException("Capability " + Capability.AssociatePublicIP.getName() + " can only be set when capability "+ Capability.ElasticIp.getName()+ " is true");
      }
    }
  }
}
