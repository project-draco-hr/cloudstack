{
  DataCenterVO zone=_zoneDao.findById(zoneId);
  if (zone != null) {
    List<NetworkOfferingVO> ntwkOff=_networkOfferingDao.listSystemNetworkOfferings();
    for (    NetworkOfferingVO offering : ntwkOff) {
      DataCenterDeployment plan=new DataCenterDeployment(zone.getId(),null,null,null);
      NetworkVO userNetwork=new NetworkVO();
      Account systemAccount=_accountDao.findById(Account.ACCOUNT_ID_SYSTEM);
      BroadcastDomainType broadcastDomainType=null;
      if (offering.getGuestIpType() != GuestIpType.DirectPodBased) {
        if (offering.getTrafficType() == TrafficType.Management) {
          broadcastDomainType=BroadcastDomainType.Native;
        }
 else         if (offering.getTrafficType() == TrafficType.Public) {
          broadcastDomainType=BroadcastDomainType.Vlan;
        }
 else         if (offering.getTrafficType() == TrafficType.Control) {
          broadcastDomainType=BroadcastDomainType.LinkLocal;
        }
        userNetwork.setBroadcastDomainType(broadcastDomainType);
        _networkMgr.setupNetwork(systemAccount,offering,userNetwork,plan,null,null,true);
      }
    }
  }
  if (zone != null && zone.getNetworkType() == NetworkType.Basic) {
    DataCenterDeployment plan=new DataCenterDeployment(zone.getId(),null,null,null);
    NetworkVO userNetwork=new NetworkVO();
    userNetwork.setBroadcastDomainType(BroadcastDomainType.Native);
    Account systemAccount=_accountDao.findById(Account.ACCOUNT_ID_SYSTEM);
    List<NetworkOfferingVO> networkOffering=_networkOfferingDao.findByType(GuestIpType.DirectPodBased);
    if (networkOffering == null || networkOffering.isEmpty()) {
      throw new CloudRuntimeException("No default DirectPodBased network offering is found");
    }
    _networkMgr.setupNetwork(systemAccount,networkOffering.get(0),userNetwork,plan,null,null,true);
  }
}
