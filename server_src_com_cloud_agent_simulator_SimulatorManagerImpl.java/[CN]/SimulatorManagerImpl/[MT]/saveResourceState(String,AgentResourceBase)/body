{
  s_logger.info("Attempting to save resource state");
  File dir;
  if (path == null) {
    path=getAgentPath();
  }
  dir=new File(path);
  if (!dir.exists()) {
    s_logger.info("Creating new agent directory path: " + dir.getAbsolutePath());
    dir.mkdir();
  }
  Gson gson=new GsonBuilder().serializeSpecialFloatingPointValues().serializeNulls().create();
  Writer writer;
  try {
    String filePrefix=getFilePrefix(resource);
    s_logger.info("Saving resource with instanceid: " + resource.getInstanceId() + " to path: "+ dir.getAbsolutePath());
    writer=new OutputStreamWriter(new FileOutputStream(new File(dir.getAbsolutePath(),filePrefix + "." + resource.getInstanceId()+ ".json")));
    gson.toJson(resource,writer);
    writer.close();
  }
 catch (  FileNotFoundException e) {
    s_logger.error("FileNotFoundException " + e.getMessage());
  }
catch (  IOException e) {
    s_logger.error("IOException: " + e.getMessage());
  }
  s_logger.info("Finished save resource state");
  return true;
}
