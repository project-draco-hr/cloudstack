{
  HashMap<String,HashMap<String,Long>> groupDetails=new HashMap<String,HashMap<String,Long>>();
  Host host=Host.getByUuid(conn,_host.uuid);
  Set<PGPU> pgpus=host.getPGPUs(conn);
  Iterator<PGPU> iter=pgpus.iterator();
  while (iter.hasNext()) {
    PGPU pgpu=iter.next();
    GPUGroup gpuGroup=pgpu.getGPUGroup(conn);
    Set<VGPUType> enabledVGPUTypes=gpuGroup.getEnabledVGPUTypes(conn);
    String groupName=gpuGroup.getNameLabel(conn);
    HashMap<String,Long> gpuCapacity=new HashMap<String,Long>();
    if (groupDetails.get(groupName) != null) {
      gpuCapacity=groupDetails.get(groupName);
    }
    if (enabledVGPUTypes != null) {
      Iterator<VGPUType> it=enabledVGPUTypes.iterator();
      while (it.hasNext()) {
        VGPUType type=it.next();
        String modelName=type.getModelName(conn);
        Long remainingCapacity=pgpu.getRemainingCapacity(conn,type);
        if (gpuCapacity.get(modelName) != null) {
          long newRemainingCapacity=gpuCapacity.get(modelName) + remainingCapacity;
          gpuCapacity.put(modelName,newRemainingCapacity);
        }
 else {
          gpuCapacity.put(modelName,remainingCapacity);
        }
      }
    }
    groupDetails.put(groupName,gpuCapacity);
  }
  return groupDetails;
}
