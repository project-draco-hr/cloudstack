{
  Deflater deflater=new Deflater();
  deflater.setInput(data,off,len);
  int bufSize=len + len / 100 + 12;
  byte[] buf=new byte[bufSize];
  deflater.finish();
  int compressedSize=deflater.deflate(buf);
  recordCompactLen(compressedSize);
  rec.write(buf,0,compressedSize);
}
