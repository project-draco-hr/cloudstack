{
  byte[] challenge=new byte[16];
  readFully(challenge);
  if (pw.length() > 8)   pw=pw.substring(0,8);
  int firstZero=pw.indexOf(0);
  if (firstZero != -1)   pw=pw.substring(0,firstZero);
  byte[] key={0,0,0,0,0,0,0,0};
  System.arraycopy(pw.getBytes(),0,key,0,pw.length());
  DesCipher des=new DesCipher(key);
  des.encrypt(challenge,0,challenge,0);
  des.encrypt(challenge,8,challenge,8);
  os.write(challenge);
  readSecurityResult("VNC authentication");
}
