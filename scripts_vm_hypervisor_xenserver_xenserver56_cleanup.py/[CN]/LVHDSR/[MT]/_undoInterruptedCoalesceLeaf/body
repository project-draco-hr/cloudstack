def _undoInterruptedCoalesceLeaf(self, childUuid, parentUuid):
    Util.log('*** UNDO LEAF-COALESCE')
    parent = self.getVDI(parentUuid)
    if (not parent):
        parent = self.getVDI(childUuid)
        if (not parent):
            raise util.SMException(('Neither %s nor %s found' % (parentUuid, childUuid)))
        Util.log(('Renaming parent back: %s -> %s' % (childUuid, parentUuid)))
        parent.rename(parentUuid)
    util.fistpoint.activate('LVHDRT_coaleaf_undo_after_rename', self.uuid)
    child = self.getVDI(childUuid)
    if (not child):
        child = self.getVDI((self.TMP_RENAME_PREFIX + childUuid))
        if (not child):
            raise util.SMException(('Neither %s nor %s found' % (childUuid, (self.TMP_RENAME_PREFIX + childUuid))))
        Util.log(('Renaming child back to %s' % childUuid))
        child.rename(childUuid)
        Util.log('Updating the VDI record')
        child.setConfig(VDI.DB_VHD_PARENT, parentUuid)
        child.setConfig(VDI.DB_VDI_TYPE, lvhdutil.VDI_TYPE_VHD)
        child.updateConfig()
        util.fistpoint.activate('LVHDRT_coaleaf_undo_after_rename2', self.uuid)
        ns = (lvhdutil.NS_PREFIX_LVM + self.uuid)
        (cCnt, cBcnt) = RefCounter.check(child.uuid, ns)
        (pCnt, pBcnt) = RefCounter.check(parent.uuid, ns)
        pCnt = (pCnt + cBcnt)
        RefCounter.set(parent.uuid, pCnt, 0, ns)
        util.fistpoint.activate('LVHDRT_coaleaf_undo_after_refcount', self.uuid)
    parent.deflate()
    child.inflateFully()
    util.fistpoint.activate('LVHDRT_coaleaf_undo_after_deflate', self.uuid)
    if child.hidden:
        child._setHidden(False)
    if (not parent.hidden):
        parent._setHidden(True)
    if (not parent.lvReadonly):
        self.lvmCache.setReadonly(parent.lvName, True)
    util.fistpoint.activate('LVHDRT_coaleaf_undo_end', self.uuid)
    Util.log('*** leaf-coalesce undo successful')
    if util.fistpoint.is_active('LVHDRT_coaleaf_stop_after_recovery'):
        child.setConfigUpdate(VDI.DB_LEAFCLSC, VDI.LEAFCLSC_DISABLED)
