def _coalesce(self, vdi):
    self.journaler.create(vdi.JRN_COALESCE, vdi.uuid, '1')
    vdi._coalesceBegin()
    self.journaler.remove(vdi.JRN_COALESCE, vdi.uuid)
    util.fistpoint.activate('LVHDRT_before_create_relink_journal', self.uuid)
    if (not self.journaler.get(vdi.JRN_RELINK, vdi.uuid)):
        self.journaler.create(vdi.JRN_RELINK, vdi.uuid, '1')
    self.lock()
    try:
        self.scan()
        vdi._relinkSkip()
    finally:
        self.unlock()
    vdi.parent._reloadChildren(vdi)
    self.journaler.remove(vdi.JRN_RELINK, vdi.uuid)
