def coalesce(self, vdi, dryRun):
    'Coalesce vdi onto parent'
    Util.log(('Coalescing %s -> %s' % (vdi.toString(), vdi.parent.toString())))
    if dryRun:
        return
    try:
        self._coalesce(vdi)
    except util.SMException as e:
        if isinstance(e, AbortException):
            self.cleanup()
            raise
        else:
            self._failedCoalesceTargets.append(vdi)
            Util.logException('coalesce')
            Util.log('Coalesce failed, skipping')
    self.cleanup()
