def get_coalesceable_leaves(session, srUuid, vdiUuids):
    coalesceable = []
    sr = SR.getInstance(srUuid, session)
    sr.scanLocked()
    for uuid in vdiUuids:
        vdi = sr.getVDI(uuid)
        if (not vdi):
            raise util.SMException(('VDI %s not found' % uuid))
        if vdi.isLeafCoalesceable():
            coalesceable.append(uuid)
    return coalesceable
