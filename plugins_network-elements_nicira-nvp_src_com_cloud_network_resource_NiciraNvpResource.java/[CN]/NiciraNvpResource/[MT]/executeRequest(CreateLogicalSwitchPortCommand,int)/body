{
  final String logicalSwitchUuid=cmd.getLogicalSwitchUuid();
  final String attachmentUuid=cmd.getAttachmentUuid();
  try {
    final List<NiciraNvpTag> tags=new ArrayList<NiciraNvpTag>();
    tags.add(new NiciraNvpTag("cs_account",cmd.getOwnerName()));
    final LogicalSwitchPort logicalSwitchPort=new LogicalSwitchPort(attachmentUuid,tags,true);
    final LogicalSwitchPort newPort=niciraNvpApi.createLogicalSwitchPort(logicalSwitchUuid,logicalSwitchPort);
    try {
      niciraNvpApi.updateLogicalSwitchPortAttachment(cmd.getLogicalSwitchUuid(),newPort.getUuid(),new VifAttachment(attachmentUuid));
    }
 catch (    final NiciraNvpApiException ex) {
      s_logger.warn("modifyLogicalSwitchPort failed after switchport was created, removing switchport");
      niciraNvpApi.deleteLogicalSwitchPort(cmd.getLogicalSwitchUuid(),newPort.getUuid());
      throw ex;
    }
    return new CreateLogicalSwitchPortAnswer(cmd,true,"Logical switch port " + newPort.getUuid() + " created",newPort.getUuid());
  }
 catch (  final NiciraNvpApiException e) {
    if (numRetries > 0) {
      return retry(cmd,--numRetries);
    }
 else {
      return new CreateLogicalSwitchPortAnswer(cmd,e);
    }
  }
}
