{
  final Script s=new Script(_qemuImgPath,timeout);
  s.add("convert");
  s.add("-O");
  s.add(destFile.getFormat().toString());
  if (options != null && !options.isEmpty()) {
    s.add("-o");
    final StringBuffer optionsBuffer=new StringBuffer();
    for (    final Map.Entry<String,String> option : options.entrySet()) {
      optionsBuffer.append(option.getKey()).append('=').append(option.getValue()).append(',');
    }
    String optionsStr=optionsBuffer.toString();
    optionsStr=optionsStr.replaceAll(",$","");
    s.add(optionsStr);
  }
  s.add(srcFile.getFileName());
  s.add(destFile.getFileName());
  final String result=s.execute();
  if (result != null) {
    throw new QemuImgException(result);
  }
  if (srcFile.getSize() < destFile.getSize()) {
    this.resize(destFile,destFile.getSize());
  }
}
