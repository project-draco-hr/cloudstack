{
  Script s=new Script(_qemuImgPath,timeout);
  s.add("create");
  if (options != null && !options.isEmpty()) {
    s.add("-o");
    final StringBuilder optionsStr=new StringBuilder();
    for (    Map.Entry<String,String> option : options.entrySet()) {
      optionsStr.append(option.getKey()).append('=').append(option.getValue()).append(',');
    }
    s.add(optionsStr.toString());
  }
  s.add("-f");
  if (backingFile != null) {
    s.add(backingFile.getFormat().toString());
    s.add("-b");
    s.add(backingFile.getFileName());
  }
 else {
    s.add(file.getFormat().toString());
  }
  s.add(file.getFileName());
  if (file.getSize() != 0L) {
    s.add(Long.toString(file.getSize()));
  }
 else   if (backingFile == null) {
    throw new QemuImgException("No size was passed, and no backing file was passed");
  }
  String result=s.execute();
  if (result != null) {
    throw new QemuImgException(result);
  }
}
