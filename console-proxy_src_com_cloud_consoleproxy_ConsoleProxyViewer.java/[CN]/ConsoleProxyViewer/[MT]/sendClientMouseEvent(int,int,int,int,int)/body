{
  if (code == 2)   modifiers|=MouseEvent.BUTTON3_MASK;
 else   modifiers|=MouseEvent.BUTTON1_MASK;
  int id=0;
  if (event == 1)   id=MouseEvent.MOUSE_MOVED;
 else   if (event == 2)   id=MouseEvent.MOUSE_PRESSED;
 else   if (event == 3)   id=MouseEvent.MOUSE_RELEASED;
 else   if (event == 8)   id=MouseEvent.MOUSE_PRESSED;
  long curTicks=System.currentTimeMillis();
  MouseEvent mouseEvent=new MouseEvent(vc,id,curTicks,modifiers,x,y,1,false);
synchronized (this) {
    if (rfb != null && !rfb.closed()) {
      try {
        rfb.writePointerEvent(mouseEvent);
        if (event == 8) {
          if (s_logger.isTraceEnabled())           s_logger.trace("Replay mouse double click event at " + x + ","+ y);
          mouseEvent=new MouseEvent(vc,MouseEvent.MOUSE_RELEASED,curTicks,modifiers,x,y,1,false);
          rfb.writePointerEvent(mouseEvent);
          mouseEvent=new MouseEvent(vc,MouseEvent.MOUSE_PRESSED,curTicks,modifiers,x,y,1,false);
          rfb.writePointerEvent(mouseEvent);
          mouseEvent=new MouseEvent(vc,MouseEvent.MOUSE_RELEASED,curTicks,modifiers,x,y,1,false);
          rfb.writePointerEvent(mouseEvent);
        }
      }
 catch (      IOException e) {
        s_logger.warn("Exception while sending mouse event. ",e);
      }
    }
  }
}
