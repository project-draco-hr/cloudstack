{
  int width=Math.max(tileWidth,tileWidth * tileList.size());
  BufferedImage bufferedImage=new BufferedImage(width,tileHeight,BufferedImage.TYPE_3BYTE_BGR);
  if (s_logger.isTraceEnabled())   s_logger.trace("Create merged image, w: " + width + ", h: "+ tileHeight);
  if (vc != null && vc.memImage != null) {
synchronized (vc.memImage) {
      Graphics2D g=bufferedImage.createGraphics();
      int i=0;
      for (      TileInfo tile : tileList) {
        Rectangle rc=tile.getTileRect();
        if (s_logger.isTraceEnabled())         s_logger.trace("Merge tile into jpeg from (" + rc.x + ","+ rc.y+ ","+ (rc.x + rc.width)+ ","+ (rc.y + rc.height)+ ") to ("+ i * tileWidth + ",0)");
        g.drawImage(vc.memImage,i * tileWidth,0,i * tileWidth + rc.width,rc.height,rc.x,rc.y,rc.x + rc.width,rc.y + rc.height,null);
        i++;
      }
    }
  }
  byte[] imgBits=null;
  try {
    imgBits=jpegFromImage(bufferedImage);
    if (s_logger.isTraceEnabled())     s_logger.trace("Merge jpeg image size: " + imgBits.length + ", tiles: "+ tileList.size());
  }
 catch (  IOException e) {
  }
  return imgBits;
}
