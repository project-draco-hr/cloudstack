{
  GenericDao<?,Long> dao=_daoMap.get(resourceType);
  if (dao == null) {
    throw new CloudRuntimeException("Dao is not loaded for the resource type " + resourceType);
  }
  Class<?> claz=DbUtil.getEntityBeanType(dao);
  Long identityId=null;
  while (claz != null && claz != Object.class) {
    try {
      String tableName=DbUtil.getTableName(claz);
      if (tableName == null) {
        throw new InvalidParameterValueException("Unable to find resource of type " + resourceType + " in the database");
      }
      identityId=_identityDao.getIdentityId(tableName,resourceId);
      if (identityId != null) {
        break;
      }
    }
 catch (    Exception ex) {
    }
    claz=claz.getSuperclass();
  }
  if (identityId == null) {
    throw new InvalidParameterValueException("Unable to find resource by id " + resourceId + " and type "+ resourceType);
  }
  return identityId;
}
