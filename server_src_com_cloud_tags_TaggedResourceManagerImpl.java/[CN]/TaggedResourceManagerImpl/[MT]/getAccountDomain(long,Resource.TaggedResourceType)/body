{
  String tableName=_resourceMap.get(resourceType);
  if (tableName == null) {
    throw new InvalidParameterValueException("Unable to find resource of type " + resourceType + " in the database");
  }
  Pair<Long,Long> pair=_identityDao.getAccountDomainInfo(tableName,resourceId);
  Long accountId=pair.first();
  Long domainId=pair.second();
  if (accountId == null) {
    accountId=Account.ACCOUNT_ID_SYSTEM;
  }
  if (domainId == null) {
    domainId=Domain.ROOT_DOMAIN;
  }
  return new Pair<Long,Long>(accountId,domainId);
}
