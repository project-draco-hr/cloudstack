{
  if (!_isEnabled) {
    return;
  }
  List<AccountVO> accounts=_accountDao.listAll();
  for (  AccountVO acnt : accounts) {
    if (_vlanMappingDirtyDao.isDirty(acnt.getId())) {
      s_logger.warn("Vlan mapping for account " + acnt.getAccountName() + " id "+ acnt.getId()+ " is dirty");
    }
  }
  if (states.size() == 0) {
    s_logger.info("Nothing to do, Ovs fullsync is happy");
    return;
  }
  Set<Long> vmIds=new HashSet<Long>();
  for (  Pair<String,Long> state : states) {
    if (state.second() == -1) {
      s_logger.warn("Ovs fullsync get wrong seqno for " + state.first());
      continue;
    }
    VmFlowLogVO log=_flowLogDao.findByName(state.first());
    if (log.getLogsequence() != state.second()) {
      s_logger.debug("Ovs fullsync detected unmatch seq number for " + state.first() + ", run sync");
      VMInstanceVO vo=_instanceDao.findById(log.getInstanceId());
      if (vo == null) {
        s_logger.warn("Ovs can't find " + state.first() + " in vm_instance!");
        continue;
      }
      if (vo.getType() != VirtualMachine.Type.User && vo.getType() != VirtualMachine.Type.DomainRouter) {
        s_logger.warn("Ovs fullsync: why we sync a " + vo.getType().toString() + " VM???");
        continue;
      }
      vmIds.add(new Long(vo.getId()));
    }
  }
  if (vmIds.size() > 0) {
    scheduleFlowUpdateToHosts(vmIds,true,null);
  }
}
