{
  Long accountId=cmd.getAccountId();
  Long volumeId=cmd.getVolumeId();
  String secondaryStoragePoolURL=cmd.getSecondaryStoragePoolURL();
  String details=null;
  boolean success=false;
  VmwareContext context=hostService.getServiceContext(cmd);
  try {
    details=deleteSnapshotDirOnSecondaryStorage(accountId,volumeId,secondaryStoragePoolURL);
    if (details == null) {
      success=true;
    }
  }
 catch (  Throwable e) {
    if (e instanceof RemoteException) {
      hostService.invalidateServiceContext(context);
    }
    s_logger.error("Unexpecpted exception ",e);
    details="DeleteSnapshotDirCommand exception: " + StringUtils.getExceptionStackInfo(e);
    return new Answer(cmd,false,details);
  }
  return new Answer(cmd,success,details);
}
