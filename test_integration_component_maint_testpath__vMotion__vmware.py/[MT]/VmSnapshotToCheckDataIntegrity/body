def VmSnapshotToCheckDataIntegrity(self, vm):
    "\n    This method takes VMSnapshot of the VM post migration\n    to check data integrity.\n    VM snapshot is not possible if VM's volumes have snapshots.\n    So, first we will check if there are any volume\n    snapshots after migration and delete them if\n    there are any. Once VM snapshot is successful,\n    Delete the VM snapshot\n    "
    volumes = list_volumes(self.apiclient, virtualmachineid=vm.id, listall=True)
    for vol in volumes:
        snapshot = Snapshot.list(self.apiclient, volumeid=vol.id, listall=True)
        if snapshot:
            for snap in snapshot:
                try:
                    Snapshot.deletesnap(self.apiclient, snapid=snap.id)
                except Exception as e:
                    raise Exception(('Warning: Exception during Volume snapshot deletion : %s' % e))
    try:
        vm_snapshot = VmSnapshot.create(self.apiclient, vmid=vm.id)
    except Exception as e:
        raise Exception(('Warning: Exception during VM snapshot creation : %s' % e))
    try:
        VmSnapshot.deleteVMSnapshot(self.apiclient, vmsnapshotid=vm_snapshot.id)
    except Exception as e:
        raise Exception(('Warning: Exception during VM snapshot deletion : %s' % e))
    return
