def setUp(self):
    self.apiclient = self.testClient.getApiClient()
    self.dbclient = self.testClient.getDbConnection()
    portable_ip_range_services = getPortableIpRangeServices(self.config)
    if (portable_ip_range_services is FAILED):
        self.skipTest('Failed to read config values related to portable ip range')
    self.cleanup = []
    try:
        self.account = Account.create(self.apiclient, self.services['account'], domainid=self.domain.id, admin=True)
        portable_ip_range_services['regionid'] = self.region.id
        new_portable_ip_range = PortablePublicIpRange.create(self.apiclient, portable_ip_range_services)
        self.cleanup.append(new_portable_ip_range)
        self.network_offering = NetworkOffering.create(self.apiclient, self.services['network_offering'], conservemode=False)
        self.network_offering.update(self.apiclient, state='Enabled')
        self.network = Network.create(self.apiclient, self.services['network'], accountid=self.account.name, domainid=self.account.domainid, networkofferingid=self.network_offering.id, zoneid=self.zone.id)
        self.cleanup.append(self.network_offering)
    except Exception as e:
        self.cleanup.append(self.account)
        self.fail(('Exception in setupClass: %s' % e))
    return
