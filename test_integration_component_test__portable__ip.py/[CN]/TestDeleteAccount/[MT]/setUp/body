def setUp(self):
    self.apiclient = self.testClient.getApiClient()
    self.dbclient = self.testClient.getDbConnection()
    self.cleanup = []
    try:
        self.account = Account.create(self.apiclient, self.services['account'], domainid=self.domain.id, admin=True)
        self.cleanup.append(self.account)
        self.debug(('portable ip range services: %s' % self.services['portableiprange']))
        new_portable_ip_range = PortablePublicIpRange.create(self.apiclient, self.services['portableiprange'])
        self.cleanup.append(new_portable_ip_range)
        self.network_offering = NetworkOffering.create(self.apiclient, self.services['network_offering'], conservemode=False)
        self.network_offering.update(self.apiclient, state='Enabled')
        self.network = Network.create(self.apiclient, self.services['network'], accountid=self.account.name, domainid=self.account.domainid, networkofferingid=self.network_offering.id, zoneid=self.zone.id)
        self.cleanup.append(self.network_offering)
    except Exception as e:
        self.fail(('Exception in setupClass: %s' % e))
    return
