{
  HypervisorType[] hypervisors=new HypervisorType[]{HypervisorType.KVM,Hypervisor.HypervisorType.LXC};
  for (  HypervisorType hypervisor : hypervisors) {
    try {
      Connect conn=LibvirtConnection.getConnectionByType(hypervisor.toString());
      if (conn.domainLookupByName(vmName) != null) {
        return conn;
      }
    }
 catch (    Exception e) {
      s_logger.debug("Can not find " + hypervisor.toString() + " connection for Instance: "+ vmName+ ", continuing.");
    }
  }
  s_logger.warn("Can not find a connection for Instance " + vmName + ". Assuming the default connection.");
  return getConnection();
}
