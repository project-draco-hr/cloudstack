{
  FirewallRuleVO rule=_firewallDao.findById(ruleId);
  if (rule == null || rule.getPurpose() != Purpose.NetworkACL) {
    throw new InvalidParameterValueException("Unable to find " + ruleId + " having purpose "+ Purpose.NetworkACL);
  }
  _accountMgr.checkAccess(caller,null,true,rule);
  _firewallMgr.revokeRule(rule,caller,userId,false);
  boolean success=false;
  if (apply) {
    List<FirewallRuleVO> rules=_firewallDao.listByNetworkAndPurpose(rule.getNetworkId(),Purpose.NetworkACL);
    success=_firewallMgr.applyFirewallRules(rules,false,caller);
  }
 else {
    success=true;
  }
  return success;
}
