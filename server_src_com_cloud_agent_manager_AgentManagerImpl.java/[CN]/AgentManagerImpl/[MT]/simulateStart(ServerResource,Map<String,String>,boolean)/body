{
  StartupCommand[] cmds=resource.initialize();
  if (cmds == null)   return null;
  AgentAttache attache=null;
  if (s_logger.isDebugEnabled()) {
    s_logger.debug("Startup request from directly connected host: " + new Request(0l,-1l,-1l,cmds,true,false,true).toString());
  }
  try {
    attache=handleDirectConnect(resource,cmds,details,old);
  }
 catch (  IllegalArgumentException ex) {
    s_logger.warn("Unable to connect due to ",ex);
    throw ex;
  }
catch (  Exception e) {
    s_logger.warn("Unable to connect due to ",e);
  }
  if (attache == null) {
    resource.disconnected();
    return null;
  }
  StartupAnswer[] answers=new StartupAnswer[cmds.length];
  for (int i=0; i < answers.length; i++) {
    answers[i]=new StartupAnswer(cmds[i],attache.getId(),_pingInterval);
  }
  attache.process(answers);
  return attache;
}
