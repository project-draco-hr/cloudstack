{
  if (_dcDao.findById(zoneId) == null) {
    throw new InvalidParameterValueException("Can't find zone with id " + zoneId);
  }
  Map<String,String> details=hostDetails;
  String guid=details.get("guid");
  List<HostVO> currentHosts=_hostDao.listBy(hostType,zoneId);
  for (  HostVO currentHost : currentHosts) {
    if (currentHost.getGuid().equals(guid)) {
      return currentHost;
    }
  }
  AgentAttache attache=simulateStart(null,resource,hostDetails,true,null,null,false);
  return _hostDao.findById(attache.getId());
}
