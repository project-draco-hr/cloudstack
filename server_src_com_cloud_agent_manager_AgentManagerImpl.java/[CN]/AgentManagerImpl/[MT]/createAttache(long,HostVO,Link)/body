{
  s_logger.debug("create ConnectedAgentAttache for " + id);
  final AgentAttache attache=new ConnectedAgentAttache(this,id,link,server.getStatus() == Status.Maintenance || server.getStatus() == Status.ErrorInMaintenance || server.getStatus() == Status.PrepareForMaintenance);
  link.attach(attache);
  AgentAttache old=null;
synchronized (_agents) {
    old=_agents.get(id);
    _agents.put(id,attache);
  }
  if (old != null) {
    old.disconnect(Status.Removed);
  }
  return attache;
}
