{
  try {
    Host h=_hostDao.findById(hostId);
    Status status=h.getStatus();
    if (status.equals(Status.Up) || status.equals(Status.Connecting)) {
      return null;
    }
    final Answer answer=send(hostId,cmd,timeout);
    if (answer == null) {
      s_logger.warn("send returns null answer");
      return null;
    }
    if (!answer.getResult()) {
      s_logger.warn("Unable to execute command: " + cmd.toString() + " due to "+ answer.getDetails());
      return null;
    }
    if (s_logger.isDebugEnabled() && answer.getDetails() != null) {
      s_logger.debug("Details from executing " + cmd.getClass().toString() + ": "+ answer.getDetails());
    }
    return answer;
  }
 catch (  final AgentUnavailableException e) {
    s_logger.warn(e.getMessage());
    return null;
  }
catch (  final OperationTimedoutException e) {
    s_logger.warn("Operation timed out: " + e.getMessage());
    return null;
  }
catch (  final Exception e) {
    s_logger.warn("Exception while sending",e);
    return null;
  }
}
