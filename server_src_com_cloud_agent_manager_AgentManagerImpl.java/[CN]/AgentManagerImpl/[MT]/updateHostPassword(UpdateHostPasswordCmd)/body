{
  if (upasscmd.getClusterId() == null) {
    AgentAttache agent=this.findAttache(upasscmd.getHostId());
    if (!(agent instanceof DirectAgentAttache)) {
      return false;
    }
    UpdateHostPasswordCommand cmd=new UpdateHostPasswordCommand(upasscmd.getUsername(),upasscmd.getPassword());
    agent.updatePassword(cmd);
  }
 else {
    List<HostVO> hosts=_hostDao.listByCluster(upasscmd.getClusterId());
    for (    HostVO h : hosts) {
      AgentAttache agent=this.findAttache(h.getId());
      if (!(agent instanceof DirectAgentAttache)) {
        continue;
      }
      UpdateHostPasswordCommand cmd=new UpdateHostPasswordCommand(upasscmd.getUsername(),upasscmd.getPassword());
      agent.updatePassword(cmd);
    }
  }
  return true;
}
