{
  String sql="UPDATE async_job SET job_status=" + JobInfo.Status.FAILED.ordinal() + ", job_result_code="+ jobResultCode+ ", job_result='"+ jobResultMessage+ "' where job_status="+ JobInfo.Status.IN_PROGRESS.ordinal()+ " AND (job_executing_msid=? OR (job_executing_msid IS NULL AND job_init_msid=?))";
  Transaction txn=Transaction.currentTxn();
  PreparedStatement pstmt=null;
  try {
    pstmt=txn.prepareAutoCloseStatement(sql);
    pstmt.setLong(1,msid);
    pstmt.setLong(2,msid);
    pstmt.execute();
  }
 catch (  SQLException e) {
    s_logger.warn("Unable to reset job status for management server " + msid,e);
  }
catch (  Throwable e) {
    s_logger.warn("Unable to reset job status for management server " + msid,e);
  }
}
