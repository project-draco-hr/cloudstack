{
  final String escapedUsername=LdapUtils.escapeLDAPSearchFilter(username);
  try {
    final LdapUser user=getUser(escapedUsername);
    final String principal=user.getPrincipal();
    final LdapContext context=_ldapContextFactory.createUserContext(principal,password);
    closeContext(context);
    return true;
  }
 catch (  NamingException|IOException|NoLdapUserMatchingQueryException e) {
    s_logger.debug("Exception while doing an LDAP bind for user " + " " + username,e);
    s_logger.info("Failed to authenticate user: " + username + ". incorrect password.");
    return false;
  }
}
