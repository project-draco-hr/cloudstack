{
  try {
    underlying.check(1);
    int avail_in=underlying.getend() - underlying.getptr();
    if (avail_in > bytesIn)     avail_in=bytesIn;
    if (inflater.needsInput()) {
      inflater.setInput(underlying.getbuf(),underlying.getptr(),avail_in);
    }
    int n=inflater.inflate(b,end,bufSize - end);
    end+=n;
    if (inflater.needsInput()) {
      bytesIn-=avail_in;
      underlying.setptr(underlying.getptr() + avail_in);
    }
  }
 catch (  java.util.zip.DataFormatException e) {
    throw new Exception("ZlibInStream: inflate failed");
  }
}
