{
  if (dataObject == null || host == null || dataStore == null) {
    return;
  }
  long sfVolumeId=getSolidFireVolumeId(dataObject);
  long clusterId=host.getClusterId();
  long storagePoolId=dataStore.getId();
  ClusterVO cluster=_clusterDao.findById(clusterId);
  GlobalLock lock=GlobalLock.getInternLock(cluster.getUuid());
  if (!lock.lock(SolidFireUtil.s_lockTimeInSeconds)) {
    String errMsg="Couldn't lock the DB (in revokeAccess) on the following string: " + cluster.getUuid();
    s_logger.debug(errMsg);
    throw new CloudRuntimeException(errMsg);
  }
  try {
    ClusterDetailsVO clusterDetail=_clusterDetailsDao.findDetail(clusterId,SolidFireUtil.getVagKey(storagePoolId));
    String vagId=clusterDetail != null ? clusterDetail.getValue() : null;
    if (vagId != null) {
      SolidFireUtil.SolidFireConnection sfConnection=SolidFireUtil.getSolidFireConnection(storagePoolId,_storagePoolDetailsDao);
      SolidFireUtil.SolidFireVag sfVag=SolidFireUtil.getSolidFireVag(sfConnection,Long.parseLong(vagId));
      long[] volumeIds=SolidFireUtil.getNewVolumeIds(sfVag.getVolumeIds(),sfVolumeId,false);
      SolidFireUtil.modifySolidFireVag(sfConnection,sfVag.getId(),sfVag.getInitiators(),volumeIds);
    }
  }
  finally {
    lock.unlock();
    lock.releaseRef();
  }
}
