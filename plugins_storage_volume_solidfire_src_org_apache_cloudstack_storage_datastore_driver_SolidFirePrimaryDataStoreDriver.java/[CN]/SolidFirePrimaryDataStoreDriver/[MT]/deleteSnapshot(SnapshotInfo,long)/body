{
  String errMsg=null;
  long snapshotId=snapshotInfo.getId();
  try {
    SolidFireUtil.SolidFireConnection sfConnection=SolidFireUtil.getSolidFireConnection(storagePoolId,_storagePoolDetailsDao);
    SnapshotDetailsVO snapshotDetails=_snapshotDetailsDao.findDetail(snapshotId,DiskTO.VOLUME_ID);
    long volumeId=Long.parseLong(snapshotDetails.getValue());
    SolidFireUtil.deleteSolidFireVolume(sfConnection,volumeId);
    _snapshotDetailsDao.removeDetails(snapshotId);
    StoragePoolVO storagePool=_storagePoolDao.findById(storagePoolId);
    long usedBytes=getUsedBytes(storagePool);
    storagePool.setUsedBytes(usedBytes < 0 ? 0 : usedBytes);
    _storagePoolDao.update(storagePoolId,storagePool);
  }
 catch (  Exception ex) {
    s_logger.debug(SolidFireUtil.LOG_PREFIX + "Failed to delete SolidFire volume. CloudStack snapshot ID: " + snapshotId,ex);
    errMsg=ex.getMessage();
  }
  return errMsg;
}
