{
  if (dataObject.getType() == DataObjectType.VOLUME) {
    return Long.parseLong(((VolumeInfo)dataObject).getFolder());
  }
  if (dataObject.getType() == DataObjectType.SNAPSHOT) {
    SnapshotDetailsVO snapshotDetails=_snapshotDetailsDao.findDetail(dataObject.getId(),SolidFireUtil.VOLUME_ID);
    if (snapshotDetails == null || snapshotDetails.getValue() == null) {
      throw new CloudRuntimeException("Unable to locate the volume ID associated with the following snapshot ID: " + dataObject.getId());
    }
    return Long.parseLong(snapshotDetails.getValue());
  }
  throw new CloudRuntimeException("Invalid DataObjectType (" + dataObject.getType() + ") passed to getSolidFireVolumeId(DataObject)");
}
