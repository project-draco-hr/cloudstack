{
  assert(tableName != null);
  PreparedStatement pstmt=null;
  TransactionLegacy txn=TransactionLegacy.open(TransactionLegacy.CLOUD_DB);
  try {
    Long domainId=null;
    Long accountId=null;
    try {
      pstmt=txn.prepareAutoCloseStatement(String.format("SELECT domain_id FROM `%s` WHERE id=?",tableName));
      pstmt.setLong(1,identityId);
      ResultSet rs=pstmt.executeQuery();
      if (rs.next()) {
        if (rs.getLong(1) != 0) {
          domainId=rs.getLong(1);
        }
      }
    }
 catch (    SQLException e) {
    }
    try {
      String account="account_id";
      if (resourceType == ResourceObjectType.Project) {
        account="project_account_id";
      }
      pstmt=txn.prepareAutoCloseStatement(String.format("SELECT " + account + " FROM `%s` WHERE id=?",tableName));
      pstmt.setLong(1,identityId);
      ResultSet rs=pstmt.executeQuery();
      if (rs.next()) {
        if (rs.getLong(1) != 0) {
          accountId=rs.getLong(1);
        }
      }
    }
 catch (    SQLException e) {
    }
    return new Pair<Long,Long>(accountId,domainId);
  }
  finally {
    txn.close();
  }
}
