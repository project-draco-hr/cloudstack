{
  assert(tableName != null);
  assert(identityString != null);
  PreparedStatement pstmt=null;
  Transaction txn=Transaction.open(Transaction.CLOUD_DB);
  try {
    try {
      try {
        pstmt=txn.prepareAutoCloseStatement(String.format("SELECT uuid FROM `%s`",tableName));
        pstmt.executeQuery();
      }
 catch (      SQLException e) {
        throw new InvalidParameterValueException("uuid field doesn't exist in table " + tableName);
      }
      pstmt=txn.prepareAutoCloseStatement(String.format("SELECT id FROM `%s` WHERE id=? OR uuid=?",tableName));
      long id=0;
      try {
        id=Long.parseLong(identityString);
      }
 catch (      NumberFormatException e) {
      }
      pstmt.setLong(1,id);
      pstmt.setString(2,identityString);
      ResultSet rs=pstmt.executeQuery();
      if (rs.next()) {
        return rs.getLong(1);
      }
 else {
        if (id == -1L)         return id;
        throw new InvalidParameterValueException("Object " + tableName + "(uuid: "+ identityString+ ") does not exist.");
      }
    }
 catch (    SQLException e) {
      s_logger.error("Unexpected exception ",e);
    }
  }
  finally {
    txn.close();
  }
  return null;
}
