{
  if (!pullMode)   throw new RuntimeException("This link is not in pull mode.");
  if (paused) {
    if (verbose)     System.out.println("[" + this + "] INFO: Cannot pull, link is paused.");
    if (block) {
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException e) {
      }
    }
    return null;
  }
  if (cacheBuffer != null && (expectedPacketSize == 0 || (expectedPacketSize > 0 && cacheBuffer.length >= expectedPacketSize))) {
    if (verbose)     System.out.println("[" + this + "] INFO: Data pulled from cache buffer: "+ cacheBuffer+ ".");
    ByteBuffer tmp=cacheBuffer;
    cacheBuffer=null;
    return tmp;
  }
  pause();
  source.poll(block);
  resume();
  if (cacheBuffer != null && (expectedPacketSize == 0 || (expectedPacketSize > 0 && cacheBuffer.length >= expectedPacketSize))) {
    if (verbose)     System.out.println("[" + this + "] INFO: Data pulled from source: "+ cacheBuffer+ ".");
    ByteBuffer tmp=cacheBuffer;
    cacheBuffer=null;
    return tmp;
  }
 else {
    return null;
  }
}
