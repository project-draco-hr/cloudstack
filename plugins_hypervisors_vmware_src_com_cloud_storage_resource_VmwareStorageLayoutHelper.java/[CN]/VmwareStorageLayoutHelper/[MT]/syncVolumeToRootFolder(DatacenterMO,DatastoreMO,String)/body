{
  String fileDsFullPath=ds.searchFileInSubFolders(vmdkName + ".vmdk",false);
  if (fileDsFullPath == null)   throw new Exception("Unable to find " + vmdkName + ".vmdk in datastore: "+ ds.getName());
  DatastoreFile srcDsFile=new DatastoreFile(fileDsFullPath);
  String companionFilePath=srcDsFile.getCompanionPath(vmdkName + "-flat.vmdk");
  if (ds.fileExists(companionFilePath)) {
    String targetPath=getLegacyDatastorePathFromVmdkFileName(ds,vmdkName + "-flat.vmdk");
    s_logger.info("Fixup folder-synchronization. move " + companionFilePath + " -> "+ targetPath);
    ds.moveDatastoreFile(companionFilePath,dcMo.getMor(),ds.getMor(),targetPath,dcMo.getMor(),true);
  }
  companionFilePath=srcDsFile.getCompanionPath(vmdkName + "-delta.vmdk");
  if (ds.fileExists(companionFilePath)) {
    String targetPath=getLegacyDatastorePathFromVmdkFileName(ds,vmdkName + "-delta.vmdk");
    s_logger.info("Fixup folder-synchronization. move " + companionFilePath + " -> "+ targetPath);
    ds.moveDatastoreFile(companionFilePath,dcMo.getMor(),ds.getMor(),targetPath,dcMo.getMor(),true);
  }
  String targetPath=getLegacyDatastorePathFromVmdkFileName(ds,vmdkName + ".vmdk");
  s_logger.info("Fixup folder-synchronization. move " + fileDsFullPath + " -> "+ targetPath);
  ds.moveDatastoreFile(fileDsFullPath,dcMo.getMor(),ds.getMor(),targetPath,dcMo.getMor(),true);
}
