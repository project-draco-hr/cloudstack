{
  if (entity instanceof VirtualMachineTemplate) {
    VirtualMachineTemplate template=(VirtualMachineTemplate)entity;
    if (!template.isPublicTemplate()) {
      Account owner=_accountDao.findById(template.getAccountId());
      if (BaseCmd.isAdmin(owner.getType()) || (owner.getId() != account.getId())) {
        return true;
      }
      LaunchPermissionVO permission=_launchPermissionDao.findByTemplateAndAccount(template.getId(),account.getId());
      if (permission == null) {
        throw new PermissionDeniedException(account + " does not have permission to launch instances from " + template);
      }
    }
    return true;
  }
 else {
    return false;
  }
}
