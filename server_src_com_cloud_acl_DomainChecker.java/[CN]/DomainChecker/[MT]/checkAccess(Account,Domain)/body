{
  if (account.getState() != Account.State.enabled) {
    throw new PermissionDeniedException(account + " is disabled.");
  }
  if (account.getType() == Account.ACCOUNT_TYPE_NORMAL) {
    if (account.getDomainId() != domain.getId()) {
      throw new PermissionDeniedException(account + " does not have permission to operate within " + domain);
    }
  }
 else   if (!_domainDao.isChildDomain(account.getDomainId(),domain.getId())) {
    throw new PermissionDeniedException(account + " does not have permission to operate within " + domain);
  }
  return true;
}
