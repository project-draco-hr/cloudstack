{
  if (affectedVms.size() == 0) {
    return;
  }
  if (s_logger.isTraceEnabled()) {
    s_logger.trace("Security Group Mgr2: scheduling ruleset updates for " + affectedVms.size() + " vms");
  }
  Set<Long> workItems=new TreeSet<Long>();
  workItems.addAll(affectedVms);
  Transaction txn=Transaction.currentTxn();
  txn.start();
  _rulesetLogDao.createOrUpdate(workItems);
  txn.commit();
  _workQueue.submitWorkForVms(workItems);
  notifyAll();
}
