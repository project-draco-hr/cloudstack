{
  Map<String,String> details=_clusterDetailsDao.findDetails(clusterId);
  String clusterName=details.get(OCFS2Manager.CLUSTER_NAME);
  if (clusterName == null) {
    throw new CloudRuntimeException("Cannot find OCFS2 cluster name for cluster " + clusterId);
  }
  ClusterVO cluster=_clusterDao.findById(clusterId);
  if (cluster == null) {
    throw new CloudRuntimeException("Cannot find cluster for ID " + clusterId);
  }
  List<HostVO> hosts=_hostDao.listByInAllStatus(Host.Type.Routing,clusterId,cluster.getPodId(),cluster.getDataCenterId());
  if (hosts.isEmpty()) {
    throw new CloudRuntimeException("No host up to associate a storage pool with in cluster " + clusterId);
  }
  return prepareNodes(clusterName,hosts);
}
