{
  String sourceIP=rule.getNwSrcAddress();
  int sourceLength=rule.getNwSrcLength();
  sourceCidrs=new ArrayList<String>();
  DtoRule.DtoNatTarget[] targets=rule.getNatTargets();
  if (targets != null) {
    sourceCidrs.add(targets[0].addressFrom);
  }
 else {
    sourceCidrs.add(String.format("%s/%d",sourceIP,sourceLength));
  }
  int protoNum=rule.getNwProto();
  protocol=SimpleFirewallRule.protocolNumberToString(protoNum);
  dstIp=rule.getNwDstAddress();
  if ("icmp".equals(protocol)) {
    icmpType=rule.getTpSrcStart();
    icmpCode=rule.getTpDstStart();
  }
 else {
    if (targets != null) {
      dstPortStart=targets[0].portFrom;
    }
 else {
      dstPortStart=rule.getTpDstStart();
    }
    dstPortEnd=rule.getTpDstEnd();
  }
}
