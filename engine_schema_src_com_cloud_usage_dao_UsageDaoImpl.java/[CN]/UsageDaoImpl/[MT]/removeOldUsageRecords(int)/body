{
  String sql=DELETE_ALL_BY_INTERVAL;
  TransactionLegacy txn=TransactionLegacy.open(TransactionLegacy.USAGE_DB);
  PreparedStatement pstmt=null;
  try {
    txn.start();
    pstmt=txn.prepareAutoCloseStatement(sql);
    pstmt.setLong(1,days);
    pstmt.executeUpdate();
    txn.commit();
  }
 catch (  Exception ex) {
    txn.rollback();
    logger.error("error removing old cloud_usage records for interval: " + days);
  }
 finally {
    txn.close();
  }
}
