{
  s_logger.debug("POST request to" + agentUri.toString() + " with contents"+ jsonCmd);
  HttpClient httpClient=new DefaultHttpClient();
  String result=null;
  try {
    HttpPost request=new HttpPost(agentUri);
    StringEntity cmdJson=new StringEntity(jsonCmd);
    request.addHeader("content-type","application/json");
    request.setEntity(cmdJson);
    s_logger.debug("Sending cmd to " + agentUri.toString() + " cmd data:"+ jsonCmd);
    HttpResponse response=httpClient.execute(request);
    if (response.getStatusLine().getStatusCode() == HttpStatus.SC_NOT_FOUND) {
      String errMsg="Failed to send : HTTP error code : " + response.getStatusLine().getStatusCode();
      s_logger.error(errMsg);
      String unsupportMsg="Unsupported command " + agentUri.getPath() + ".  Are you sure you got the right type of"+ " server?";
      Answer ans=new UnsupportedAnswer(null,unsupportMsg);
      s_logger.error(ans);
      result=s_gson.toJson(new Answer[]{ans});
    }
 else     if (response.getStatusLine().getStatusCode() != HttpStatus.SC_OK) {
      String errMsg="Failed send to " + agentUri.toString() + " : HTTP error code : "+ response.getStatusLine().getStatusCode();
      s_logger.error(errMsg);
      return null;
    }
 else {
      result=EntityUtils.toString(response.getEntity());
      s_logger.debug("POST response is" + result);
    }
  }
 catch (  ClientProtocolException protocolEx) {
    s_logger.error(protocolEx);
  }
catch (  IOException connEx) {
    s_logger.error(connEx);
  }
 finally {
    httpClient.getConnectionManager().shutdown();
  }
  return result;
}
