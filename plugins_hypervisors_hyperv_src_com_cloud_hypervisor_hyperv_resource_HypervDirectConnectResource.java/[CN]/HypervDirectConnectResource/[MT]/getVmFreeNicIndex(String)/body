{
  GetVmConfigCommand vmConfig=new GetVmConfigCommand(vmName);
  URI agentUri=null;
  int nicposition=-1;
  try {
    String cmdName=GetVmConfigCommand.class.getName();
    agentUri=new URI("https",null,_agentIp,_port,"/api/HypervResource/" + cmdName,null,null);
  }
 catch (  URISyntaxException e) {
    String errMsg="Could not generate URI for Hyper-V agent";
    s_logger.error(errMsg,e);
  }
  String ansStr=postHttpRequest(s_gson.toJson(vmConfig),agentUri);
  Answer[] result=s_gson.fromJson(ansStr,Answer[].class);
  s_logger.debug("GetVmConfigCommand response received " + s_gson.toJson(result));
  if (result.length > 0) {
    GetVmConfigAnswer ans=((GetVmConfigAnswer)result[0]);
    List<NicDetails> nics=ans.getNics();
    for (    NicDetails nic : nics) {
      if (nic.getState() == false) {
        nicposition=nics.indexOf(nic);
        break;
      }
    }
  }
  return nicposition;
}
