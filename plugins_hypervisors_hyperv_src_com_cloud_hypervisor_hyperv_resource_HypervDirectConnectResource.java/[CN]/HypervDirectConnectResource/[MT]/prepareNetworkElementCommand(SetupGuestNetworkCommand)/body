{
  NicTO nic=cmd.getNic();
  String domrName=cmd.getAccessDetail(NetworkElementCommand.ROUTER_NAME);
  try {
    URI broadcastUri=nic.getBroadcastUri();
    int vlanId=Integer.parseInt(BroadcastDomainType.getValue(broadcastUri));
    int ethDeviceNum=getVmNics(domrName,vlanId);
    if (ethDeviceNum > 0) {
      nic.setDeviceId(ethDeviceNum);
    }
 else {
      return new ExecutionResult(false,"Prepare SetupGuestNetwork failed due to unable to find the nic");
    }
  }
 catch (  Exception e) {
    String msg="Prepare SetupGuestNetwork failed due to " + e.toString();
    s_logger.warn(msg,e);
    return new ExecutionResult(false,msg);
  }
  return new ExecutionResult(true,null);
}
