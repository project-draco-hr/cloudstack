{
  Account owner=_accountDao.findById(cmd.getAccountId());
  Account caller=UserContext.current().getCaller();
  _accountMgr.checkAccess(caller,null,true,owner);
  long zoneId=cmd.getZoneId();
  long serviceOfferingId=cmd.getServiceOfferingId();
  Long autoscaleUserId=cmd.getAutoscaleUserId();
  DataCenter zone=_configMgr.getZone(zoneId);
  if (zone == null) {
    throw new InvalidParameterValueException("Unable to find zone by id");
  }
  ServiceOffering serviceOffering=_configMgr.getServiceOffering(serviceOfferingId);
  if (serviceOffering == null) {
    throw new InvalidParameterValueException("Unable to find service offering by id");
  }
  HashMap<String,String> deployParams=cmd.getDeployParamMap();
  if (deployParams.containsKey("networks") && deployParams.get("networks").length() > 0) {
    throw new InvalidParameterValueException("'networks' is not a valid parameter, network for an AutoScaled VM is chosen automatically. An autoscaled VM is deployed in the loadbalancer's network");
  }
  ApiDispatcher.setupParameters(new DeployVMCmd(),deployParams);
  if (autoscaleUserId == null) {
    autoscaleUserId=UserContext.current().getCallerUserId();
  }
  AutoScaleVmProfileVO profileVO=new AutoScaleVmProfileVO(cmd.getZoneId(),cmd.getDomainId(),cmd.getAccountId(),cmd.getServiceOfferingId(),cmd.getTemplateId(),cmd.getOtherDeployParams(),cmd.getCounterParamList(),cmd.getDestroyVmGraceperiod(),autoscaleUserId);
  profileVO=checkValidityAndPersist(profileVO);
  s_logger.info("Successfully create AutoScale Vm Profile with Id: " + profileVO.getId());
  return profileVO;
}
