{
  int uploadId=-1;
  Transaction txn=null;
  try {
    txn=Transaction.open(Transaction.AWSAPI_DB);
    Date tod=new Date();
    MultiPartUploadsVO uploadVO=new MultiPartUploadsVO(accessKey,bucketName,key,cannedAccess,tod);
    uploadVO=mpartUploadDao.persist(uploadVO);
    if (null != uploadVO) {
      uploadId=uploadVO.getId().intValue();
      if (null != meta) {
        for (int i=0; i < meta.length; i++) {
          MultipartMetaVO mpartMeta=new MultipartMetaVO();
          mpartMeta.setUploadID(uploadId);
          S3MetaDataEntry entry=meta[i];
          mpartMeta.setName(entry.getName());
          mpartMeta.setValue(entry.getValue());
          mpartMetaDao.persist(mpartMeta);
        }
        txn.commit();
      }
    }
    return uploadId;
  }
  finally {
    txn.close();
  }
}
