{
  final NetworkVO network=mock(NetworkVO.class);
  when(network.getId()).thenReturn(NETWORK_ID);
  when(network.getUuid()).thenReturn("aaaaaa");
  when(network.getNetworkOfferingId()).thenReturn(NETWORK_ID);
  when(network.getPhysicalNetworkId()).thenReturn(NETWORK_ID);
  when(network.getVpcId()).thenReturn(null);
  when(network.getDomainId()).thenReturn(NETWORK_ID);
  when(_networkDao.acquireInLockTable(NETWORK_ID,1200)).thenReturn(network);
  final NetworkOfferingVO offering=mock(NetworkOfferingVO.class);
  when(offering.getId()).thenReturn(NETWORK_ID);
  when(offering.getTrafficType()).thenReturn(TrafficType.Guest);
  when(_networkOfferingDao.findById(NETWORK_ID)).thenReturn(offering);
  final DomainVO domain=mock(DomainVO.class);
  when(domain.getUuid()).thenReturn("aaaaaa");
  when(_domainDao.findById(NETWORK_ID)).thenReturn(domain);
  final NicVO nic=mock(NicVO.class);
  when(nic.getId()).thenReturn(NETWORK_ID);
  when(nic.getIPv4Address()).thenReturn("10.10.10.10");
  when(nic.getMacAddress()).thenReturn("c8:60:00:56:e5:58");
  when(_nicDao.findById(NETWORK_ID)).thenReturn(nic);
  final NicProfile nicProfile=mock(NicProfile.class);
  when(nicProfile.getId()).thenReturn(NETWORK_ID);
  when(nicProfile.getIPv4Address()).thenReturn("10.10.10.10");
  when(nicProfile.getMacAddress()).thenReturn("c8:60:00:56:e5:58");
  final VirtualMachine vm=mock(VirtualMachine.class);
  when(vm.getType()).thenReturn(VirtualMachine.Type.User);
  when(vm.getState()).thenReturn(VirtualMachine.State.Expunging);
  final VirtualMachineProfile vmProfile=mock(VirtualMachineProfile.class);
  when(vmProfile.getUuid()).thenReturn("aaaaaa");
  when(vmProfile.getInstanceName()).thenReturn("Test-VM");
  when(vmProfile.getVirtualMachine()).thenReturn(vm);
  final HostVO host=mock(HostVO.class);
  when(host.getId()).thenReturn(NETWORK_ID);
  final NuageVspDeviceVO nuageVspDevice=mock(NuageVspDeviceVO.class);
  when(nuageVspDevice.getHostId()).thenReturn(NETWORK_ID);
  when(_nuageVspDao.listByPhysicalNetwork(NETWORK_ID)).thenReturn(Arrays.asList(new NuageVspDeviceVO[]{nuageVspDevice}));
  when(_hostDao.findById(NETWORK_ID)).thenReturn(host);
  final Answer answer=mock(Answer.class);
  when(answer.getResult()).thenReturn(true);
  when(_agentManager.easySend(eq(NETWORK_ID),(Command)any())).thenReturn(answer);
  _nuageVspGuestNetworkGuru.deallocate(network,nicProfile,vmProfile);
}
