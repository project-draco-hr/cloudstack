{
  if (AccountDataCenterVirtualSearch == null) {
    ServiceOfferingDao offeringDao=ComponentLocator.getLocator("management-server").getDao(ServiceOfferingDao.class);
    SearchBuilder<ServiceOfferingVO> offeringSearch=offeringDao.createSearchBuilder();
    offeringSearch.and("guestIpType",offeringSearch.entity().getGuestIpType(),SearchCriteria.Op.EQ);
    AccountDataCenterVirtualSearch=createSearchBuilder();
    AccountDataCenterVirtualSearch.and("account",AccountDataCenterVirtualSearch.entity().getAccountId(),SearchCriteria.Op.EQ);
    AccountDataCenterVirtualSearch.and("dc",AccountDataCenterVirtualSearch.entity().getDataCenterId(),SearchCriteria.Op.EQ);
    AccountDataCenterVirtualSearch.join("offeringSearch",offeringSearch,AccountDataCenterVirtualSearch.entity().getServiceOfferingId(),offeringSearch.entity().getId(),JoinBuilder.JoinType.INNER);
    AccountDataCenterVirtualSearch.done();
  }
  SearchCriteria<UserVmVO> sc=AccountDataCenterVirtualSearch.create();
  sc.setParameters("account",accountId);
  sc.setParameters("dc",dcId);
  sc.setJoinParameters("offeringSearch","guestIpType",NetworkOffering.GuestIpType.Virtual);
  return listBy(sc);
}
