def pop_state(self):
    val = self.state
    self.state = self.state.parent
    if (self.state and (self.state.fn == self.state_start)):
        self.val += self.state.val
        self.state.val = []
    return val
