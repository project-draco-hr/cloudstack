{
  log.log(Level.INFO,"Shutting down...");
  log.log(Level.FINE,"Halting ConnectionAcceptor...");
  if (snark.acceptor != null) {
    snark.acceptor.halt();
  }
  log.log(Level.FINE,"Halting TrackerClient...");
  if (snark.trackerclient != null) {
    snark.trackerclient.halt();
  }
  log.log(Level.FINE,"Halting PeerCoordinator...");
  if (snark.coordinator != null) {
    snark.coordinator.halt();
  }
  log.log(Level.FINE,"Closing Storage...");
  if (snark.storage != null) {
    try {
      snark.storage.close();
    }
 catch (    IOException ioe) {
      log.log(Level.SEVERE,"Couldn't properly close storage",ioe);
    }
  }
  try {
    log.log(Level.FINE,"Waiting 5 seconds...");
    Thread.sleep(5 * 1000);
  }
 catch (  InterruptedException ie) {
  }
  listener.shutdown();
}
