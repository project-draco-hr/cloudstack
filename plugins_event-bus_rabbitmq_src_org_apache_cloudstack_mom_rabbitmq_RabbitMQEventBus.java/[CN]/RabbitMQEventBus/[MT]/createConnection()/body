{
  try {
    ConnectionFactory factory=new ConnectionFactory();
    factory.setUsername(username);
    factory.setPassword(password);
    factory.setVirtualHost("/");
    factory.setHost(amqpHost);
    factory.setPort(port);
    Connection connection=factory.newConnection();
    connection.addShutdownListener(disconnectHandler);
    _connection=connection;
    return _connection;
  }
 catch (  Exception e) {
    throw e;
  }
}
