@attr(tags=['advanced'])
def test_28_update_nic_insufficient_permission(self):
    'Try to update default nic of vm with insufficient permission'
    account = Account.create(self.apiclient, self.services['account'], domainid=self.domain.id)
    self.cleanup.append(account)
    self.debug(('Created account %s' % account.name))
    self.debug(('creating user api client for account: %s' % account.name))
    api_client = self.testClient.createUserApiClient(UserName=account.name, DomainName=self.account.domain)
    self.debug('Listing virtual machine so that to retrive the list of non-default and default nic')
    vm_list = list_virtual_machines(self.apiclient, id=self.virtual_machine.id)
    vm_list_validation_result = validateList(vm_list)
    self.assertEqual(vm_list_validation_result[0], PASS, ('vm list validation failed due to %s' % vm_list_validation_result[2]))
    if (len(vm_list[0].nic) != 2):
        self.fail('VM should have exactly two NICs')
    defaultNicIdBeforeUpdate = None
    nonDefaultNicIdBeforeUpdate = None
    for nic in vm_list[0].nic:
        if nic.isdefault:
            defaultNicIdBeforeUpdate = nic.id
        else:
            nonDefaultNicIdBeforeUpdate = nic.id
    self.debug(('Default nic of VM is %s and non default nic of VM is %s' % (defaultNicIdBeforeUpdate, nonDefaultNicIdBeforeUpdate)))
    self.debug('Making non default nic as default nic')
    cmd = updateDefaultNicForVirtualMachine.updateDefaultNicForVirtualMachineCmd()
    cmd.virtualmachineid = self.virtual_machine.id
    cmd.nicid = nonDefaultNicIdBeforeUpdate
    with self.assertRaises(Exception) as e:
        api_client.updateDefaultNicForVirtualMachine(cmd)
    self.debug(('updateDefaultNicForVirtualMachine API failed with exception: %s' % e.exception))
    return
