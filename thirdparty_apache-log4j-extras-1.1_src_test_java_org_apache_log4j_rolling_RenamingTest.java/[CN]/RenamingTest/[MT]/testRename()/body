{
  RollingFileAppender rfa=new RollingFileAppender();
  rfa.setLayout(layout);
  rfa.setAppend(false);
  String datePattern="yyyy-MM-dd_HH_mm_ss";
  SimpleDateFormat sdf=new SimpleDateFormat(datePattern);
  TimeBasedRollingPolicy tbrp=new TimeBasedRollingPolicy();
  tbrp.setFileNamePattern("test-%d{" + datePattern + "}");
  rfa.setFile("test.log");
  tbrp.activateOptions();
  rfa.setRollingPolicy(tbrp);
  rfa.activateOptions();
  Calendar cal=Calendar.getInstance();
  root.addAppender(rfa);
  logger.debug("Hello   " + 0);
  Thread.sleep(5000);
  logger.debug("Hello   " + 1);
  String rolledFile="test-" + sdf.format(cal.getTime());
  if (new File(rolledFile).exists()) {
    assertTrue(Compare.compare(RenamingTest.class,rolledFile,"witness/rolling/renaming.0"));
    assertTrue(Compare.compare(RenamingTest.class,"test.log","witness/rolling/renaming.1"));
  }
 else {
    assertTrue(Compare.compare(RenamingTest.class,"test.log","witness/rolling/renaming.2"));
  }
}
