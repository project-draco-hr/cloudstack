{
  JsonObject snapshotToCreate=new JsonObject();
  snapshotToCreate.addProperty("method","CreateSnapshot");
  JsonObject params=new JsonObject();
  snapshotToCreate.add("params",params);
  params.addProperty("volumeID",lVolumeId);
  params.addProperty("name",snapshotName);
  if (mapAttributes != null && mapAttributes.size() > 0) {
    JsonObject attributes=new JsonObject();
    params.add("attributes",attributes);
    Iterator<Map.Entry<String,String>> itr=mapAttributes.entrySet().iterator();
    while (itr.hasNext()) {
      Map.Entry<String,String> pair=itr.next();
      attributes.addProperty(pair.getKey(),pair.getValue());
    }
  }
  final Gson gson=new GsonBuilder().create();
  String strSnapshotToCreateJson=gson.toJson(snapshotToCreate);
  String strSnapshotCreateResultJson=executeJsonRpc(sfConnection,strSnapshotToCreateJson);
  SnapshotCreateResult snapshotCreateResult=gson.fromJson(strSnapshotCreateResultJson,SnapshotCreateResult.class);
  verifyResult(snapshotCreateResult.result,strSnapshotCreateResultJson,gson);
  return snapshotCreateResult.result.snapshotID;
}
