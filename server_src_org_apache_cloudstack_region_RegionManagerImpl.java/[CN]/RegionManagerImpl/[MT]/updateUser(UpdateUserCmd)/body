{
  long id=cmd.getId();
  UserVO user=_userDao.findById(id);
  if (user == null) {
    throw new InvalidParameterValueException("The specified user doesn't exist in the system");
  }
  String userUUID=user.getUuid();
  String command="updateUser";
  List<NameValuePair> params=new ArrayList<NameValuePair>();
  params.add(new NameValuePair(ApiConstants.ID,userUUID));
  params.add(new NameValuePair(ApiConstants.API_KEY,cmd.getApiKey()));
  params.add(new NameValuePair(ApiConstants.EMAIL,cmd.getEmail()));
  params.add(new NameValuePair(ApiConstants.FIRSTNAME,cmd.getFirstname()));
  params.add(new NameValuePair(ApiConstants.LASTNAME,cmd.getLastname()));
  params.add(new NameValuePair(ApiConstants.PASSWORD,cmd.getPassword()));
  params.add(new NameValuePair(ApiConstants.SECRET_KEY,cmd.getSecretKey()));
  params.add(new NameValuePair(ApiConstants.TIMEZONE,cmd.getTimezone()));
  params.add(new NameValuePair(ApiConstants.USERNAME,cmd.getUsername()));
  int regionId=user.getRegionId();
  if (getId() == regionId) {
    return _accountMgr.updateUser(cmd);
  }
 else {
    Region region=_regionDao.findById(regionId);
    if (RegionsApiUtil.makeAPICall(region,command,params)) {
      s_logger.debug("Successfully updated user :" + userUUID + " in source Region: "+ region.getId());
      return _userAccountDao.findById(id);
    }
 else {
      throw new CloudRuntimeException("Error while updating user :" + userUUID + " in source Region: "+ region.getId());
    }
  }
}
