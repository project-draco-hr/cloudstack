{
  long srcSize=4019200;
  String srcFileName="/tmp/" + UUID.randomUUID() + ".qcow2";
  String destFileName="/tmp/" + UUID.randomUUID() + ".qcow2";
  PhysicalDiskFormat srcFormat=PhysicalDiskFormat.RAW;
  PhysicalDiskFormat destFormat=PhysicalDiskFormat.QCOW2;
  QemuImgFile srcFile=new QemuImgFile(srcFileName,srcSize,srcFormat);
  QemuImgFile destFile=new QemuImgFile(destFileName,destFormat);
  QemuImg qemu=new QemuImg(0);
  qemu.create(srcFile);
  qemu.convert(srcFile,destFile);
  Map<String,String> info=qemu.info(destFile);
  PhysicalDiskFormat infoFormat=PhysicalDiskFormat.valueOf(info.get(new String("file_format")).toUpperCase());
  assertEquals(destFormat,infoFormat);
  Long infoSize=Long.parseLong(info.get(new String("virtual_size")));
  assertEquals(Long.valueOf(srcSize),Long.valueOf(infoSize));
  File sf=new File(srcFileName);
  sf.delete();
  File df=new File(destFileName);
  df.delete();
}
