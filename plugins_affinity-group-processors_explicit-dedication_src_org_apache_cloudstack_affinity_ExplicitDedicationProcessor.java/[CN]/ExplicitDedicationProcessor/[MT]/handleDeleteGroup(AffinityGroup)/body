{
  if (group != null) {
    List<DedicatedResourceVO> dedicatedResources=_dedicatedDao.listByAffinityGroupId(group.getId());
    if (!dedicatedResources.isEmpty()) {
      if (logger.isDebugEnabled()) {
        logger.debug("Releasing the dedicated resources under group: " + group);
      }
      Transaction.execute(new TransactionCallbackNoReturn(){
        @Override public void doInTransactionWithoutResult(        TransactionStatus status){
          SearchBuilder<DedicatedResourceVO> listByAffinityGroup=_dedicatedDao.createSearchBuilder();
          listByAffinityGroup.and("affinityGroupId",listByAffinityGroup.entity().getAffinityGroupId(),SearchCriteria.Op.EQ);
          listByAffinityGroup.done();
          SearchCriteria<DedicatedResourceVO> sc=listByAffinityGroup.create();
          sc.setParameters("affinityGroupId",group.getId());
          _dedicatedDao.lockRows(sc,null,true);
          _dedicatedDao.remove(sc);
        }
      }
);
    }
 else {
      if (logger.isDebugEnabled()) {
        logger.debug("No dedicated resources to releease under group: " + group);
      }
    }
  }
  return;
}
