{
  DataStoreUrlParser parser=new DataStoreUrlParser(dsInfos.get("url"));
  PrimaryDataStoreVO dataStore=new PrimaryDataStoreVO();
  dataStore.setName(dsInfos.get("name"));
  dataStore.setPoolType(parser.getSchema());
  dataStore.setPort(parser.port);
  dataStore.setDataCenterId(Integer.parseInt(dsInfos.get("dcId")));
  dataStore.setHostAddress(parser.getHost());
  dataStore.setPath(parser.getPath());
  dataStore.setStorageProviderId(this.provider.getId());
  dataStore.setClusterId(Long.parseLong(dsInfos.get("clusterId")));
  dataStore=dataStoreDao.persist(dataStore);
  return this.provider.getDataStore(dataStore.getId());
}
