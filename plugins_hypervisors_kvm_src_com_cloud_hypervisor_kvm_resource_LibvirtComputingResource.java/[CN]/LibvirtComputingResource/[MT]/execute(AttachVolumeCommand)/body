{
  try {
    final Connect conn=LibvirtConnection.getConnectionByVmName(cmd.getVmName());
    final KVMStoragePool primary=_storagePoolMgr.getStoragePool(cmd.getPooltype(),cmd.getPoolUuid());
    final KVMPhysicalDisk disk=primary.getPhysicalDisk(cmd.getVolumePath());
    attachOrDetachDisk(conn,cmd.getAttach(),cmd.getVmName(),disk,cmd.getDeviceId().intValue(),cmd.getBytesReadRate(),cmd.getBytesWriteRate(),cmd.getIopsReadRate(),cmd.getIopsWriteRate(),cmd.getCacheMode());
  }
 catch (  final LibvirtException e) {
    return new AttachVolumeAnswer(cmd,e.toString());
  }
catch (  final InternalErrorException e) {
    return new AttachVolumeAnswer(cmd,e.toString());
  }
  return new AttachVolumeAnswer(cmd,cmd.getDeviceId(),cmd.getVolumePath());
}
