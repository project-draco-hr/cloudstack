{
  try {
    Connect conn=LibvirtConnection.getConnectionByVmName(cmd.getVmName());
    KVMStoragePool primary=_storagePoolMgr.getStoragePool(cmd.getPooltype(),cmd.getPoolUuid());
    KVMPhysicalDisk disk=primary.getPhysicalDisk(cmd.getVolumePath());
    attachOrDetachDisk(conn,cmd.getAttach(),cmd.getVmName(),disk,cmd.getDeviceId().intValue(),cmd.getBytesReadRate(),cmd.getBytesWriteRate(),cmd.getIopsReadRate(),cmd.getIopsWriteRate());
  }
 catch (  LibvirtException e) {
    return new AttachVolumeAnswer(cmd,e.toString());
  }
catch (  InternalErrorException e) {
    return new AttachVolumeAnswer(cmd,e.toString());
  }
  return new AttachVolumeAnswer(cmd,cmd.getDeviceId(),cmd.getVolumePath());
}
