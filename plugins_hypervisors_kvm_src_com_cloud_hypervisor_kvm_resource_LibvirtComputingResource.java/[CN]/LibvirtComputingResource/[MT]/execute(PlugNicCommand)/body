{
  NicTO nic=cmd.getNic();
  String vmName=cmd.getVmName();
  try {
    Connect conn=LibvirtConnection.getConnection();
    Domain vm=getDomain(conn,vmName);
    List<InterfaceDef> pluggedNics=getInterfaces(conn,vmName);
    Integer nicnum=0;
    for (    InterfaceDef pluggedNic : pluggedNics) {
      if (pluggedNic.getMacAddress().equalsIgnoreCase(nic.getMac())) {
        s_logger.debug("found existing nic for mac " + pluggedNic.getMacAddress() + " at index "+ nicnum);
        return new PlugNicAnswer(cmd,true,"success");
      }
      nicnum++;
    }
    vm.attachDevice(getVifDriver(nic.getType()).plug(nic,"Other PV (32-bit)").toString());
    return new PlugNicAnswer(cmd,true,"success");
  }
 catch (  LibvirtException e) {
    String msg=" Plug Nic failed due to " + e.toString();
    s_logger.warn(msg,e);
    return new PlugNicAnswer(cmd,false,msg);
  }
catch (  InternalErrorException e) {
    String msg=" Plug Nic failed due to " + e.toString();
    s_logger.warn(msg,e);
    return new PlugNicAnswer(cmd,false,msg);
  }
}
