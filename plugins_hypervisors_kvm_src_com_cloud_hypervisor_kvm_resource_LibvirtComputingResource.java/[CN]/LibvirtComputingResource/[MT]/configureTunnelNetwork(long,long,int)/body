{
  try {
    findOrCreateTunnelNetwork(key);
    String nwName="OVSTunnel" + key;
    String configuredHosts=Script.runSimpleBashScript("ovs-vsctl get bridge " + nwName + " other_config:ovs_host_setup");
    boolean configured=false;
    if (configuredHosts != null) {
      String hostIdsStr[]=configuredHosts.split(",");
      for (      String hostIdStr : hostIdsStr) {
        if (hostIdStr.equals(((Long)hostId).toString())) {
          configured=true;
          break;
        }
      }
    }
    if (!configured) {
      Script cmd=new Script(_ovsTunnelPath,_timeout,s_logger);
      cmd.add("setup_ovs_bridge");
      cmd.add("--key",String.valueOf(key));
      cmd.add("--cs_host_id",((Long)hostId).toString());
      cmd.add("--bridge",nwName);
      String result=cmd.execute();
      if (result != null) {
        throw new CloudRuntimeException("Unable to pre-configure OVS bridge " + nwName + " for network ID:"+ networkId);
      }
    }
  }
 catch (  Exception e) {
    s_logger.warn("createandConfigureTunnelNetwork failed",e);
    return false;
  }
  return true;
}
