def getsize(path):
    dev = getdev(path)
    sysfs = os.path.join('/sys/block', dev, 'size')
    size = 0
    if os.path.exists(sysfs):
        try:
            f = open(sysfs, 'r')
            size = (long(f.readline()) << SECTOR_SHIFT)
            f.close()
        except:
            pass
    return size
