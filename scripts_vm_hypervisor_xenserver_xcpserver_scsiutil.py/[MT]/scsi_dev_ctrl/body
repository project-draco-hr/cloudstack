def scsi_dev_ctrl(ids, cmd):
    f = (-1)
    for i in range(0, 10):
        try:
            str = ('scsi %s-single-device %s %s %s %s' % (cmd, ids[1], ids[2], ids[3], ids[4]))
            util.SMlog(str)
            f = open('/proc/scsi/scsi', 'w')
            print  >> f, str
            f.close()
            return
        except IOError as e:
            util.SMlog(('SCSI_DEV_CTRL: Failure, %s [%d]' % (e.strerror, e.errno)))
            if (f >= 0):
                f.close()
            if (e.errno == errno.ENXIO):
                util.SMlog('Device has disappeared already')
                return
            f = (-1)
            time.sleep(6)
            continue
    raise xs_errors.XenError('EIO', opterr='An error occured during the scsi operation')
