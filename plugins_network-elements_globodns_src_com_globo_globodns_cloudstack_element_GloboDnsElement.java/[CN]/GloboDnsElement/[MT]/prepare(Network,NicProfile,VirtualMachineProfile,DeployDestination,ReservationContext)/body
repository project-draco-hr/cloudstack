{
  if (!isTypeSupported(vm.getType())) {
    s_logger.info("GloboDNS only manages records for VMs of type User, ConsoleProxy and DomainRouter. VM " + vm + " is "+ vm.getType());
    return false;
  }
  Long zoneId=network.getDataCenterId();
  final DataCenter zone=_dcDao.findById(zoneId);
  if (zone == null) {
    throw new CloudRuntimeException("Could not find zone associated to this network");
  }
  String vmName=vm.getHostName();
  String vmHostname=hostNameOfVirtualMachine(vm);
  if (!vmName.equals(vmHostname) && vm.getType() == VirtualMachine.Type.User) {
    throw new InvalidParameterValueException("VM name should contain only lower case letters and digits: " + vmName + " - "+ vm);
  }
  CreateOrUpdateRecordAndReverseCommand cmd=new CreateOrUpdateRecordAndReverseCommand(vmHostname,nic.getIp4Address(),network.getNetworkDomain(),GloboDNSTemplateId.value(),GloboDNSOverride.value());
  callCommand(cmd,zoneId);
  return true;
}
