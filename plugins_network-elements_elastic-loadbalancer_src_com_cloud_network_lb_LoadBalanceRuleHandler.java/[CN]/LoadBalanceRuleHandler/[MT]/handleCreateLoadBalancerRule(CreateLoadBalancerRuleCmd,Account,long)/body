{
  if (!_networkModel.isProviderSupportServiceInNetwork(lb.getNetworkId(),Service.Lb,Provider.ElasticLoadBalancerVm)) {
    return null;
  }
  final Long ipId=lb.getSourceIpAddressId();
  if (ipId != null) {
    return null;
  }
  account=_accountDao.acquireInLockTable(account.getId());
  if (account == null) {
    s_logger.warn("ELB: CreateLoadBalancer: Failed to acquire lock on account");
    throw new CloudRuntimeException("Failed to acquire lock on account");
  }
  try {
    return handleCreateLoadBalancerRuleWithLock(lb,account,networkId);
  }
  finally {
    if (account != null) {
      _accountDao.releaseFromLockTable(account.getId());
    }
  }
}
