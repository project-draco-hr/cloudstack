{
  Set<VMTemplateVO> toBeDownloaded=new HashSet<VMTemplateVO>();
  List<DataStore> ssHosts=this._storeMgr.getImageStoresByScope(new ZoneScope(dcId));
  if (ssHosts == null || ssHosts.isEmpty()) {
    return;
  }
  for (  DataStore ssHost : ssHosts) {
    List<VMTemplateVO> rtngTmplts=_templateDao.listAllSystemVMTemplates();
    List<VMTemplateVO> defaultBuiltin=_templateDao.listDefaultBuiltinTemplates();
    for (    VMTemplateVO rtngTmplt : rtngTmplts) {
      if (rtngTmplt.getHypervisorType() == hostHyper) {
        toBeDownloaded.add(rtngTmplt);
      }
    }
    for (    VMTemplateVO builtinTmplt : defaultBuiltin) {
      if (builtinTmplt.getHypervisorType() == hostHyper) {
        toBeDownloaded.add(builtinTmplt);
      }
    }
    for (    VMTemplateVO template : toBeDownloaded) {
      TemplateDataStoreVO tmpltHost=_vmTemplateStoreDao.findByStoreTemplate(ssHost.getId(),template.getId());
      if (tmpltHost == null || tmpltHost.getState() != ObjectInDataStoreStateMachine.State.Ready) {
        _dlMonitor.downloadTemplateToStorage(template,ssHost,null);
      }
    }
  }
}
