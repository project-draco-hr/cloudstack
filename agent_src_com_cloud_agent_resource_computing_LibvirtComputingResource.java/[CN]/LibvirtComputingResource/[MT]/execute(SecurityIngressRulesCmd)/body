{
  boolean result=add_network_rules(cmd.getVmName(),Long.toString(cmd.getVmId()),cmd.getGuestIp(),cmd.getSignature(),Long.toString(cmd.getSeqNum()),cmd.getGuestMac(),cmd.stringifyRules());
  if (!result) {
    s_logger.warn("Failed to program network rules for vm " + cmd.getVmName());
    return SecurityIngressRuleAnswer(cmd,false,"programming network rules failed");
  }
 else {
    s_logger.info("Programmed network rules for vm " + cmd.getVmName() + " guestIp="+ cmd.getGuestIp()+ ", numrules="+ cmd.getRuleSet().length);
    return new SecurityIngressRuleAnswer(cmd);
  }
}
