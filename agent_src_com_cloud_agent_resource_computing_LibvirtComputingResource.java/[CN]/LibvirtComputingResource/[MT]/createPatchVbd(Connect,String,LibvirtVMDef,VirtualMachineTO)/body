{
  List<DiskDef> disks=vm.getDevices().getDisks();
  DiskDef rootDisk=disks.get(0);
  VolumeTO rootVol=getVolume(vmSpec,Volume.Type.ROOT);
  StoragePool pool=_storageResource.getStoragePool(conn,rootVol.getPoolUuid());
  StorageVol tmplVol=_storageResource.createTmplDataDisk(conn,pool,10L * 1024 * 1024);
  String datadiskPath=tmplVol.getKey();
  DiskDef patchDisk=new DiskDef();
  patchDisk.defFileBasedDisk(rootDisk.getDiskPath(),1,rootDisk.getBusType(),DiskDef.diskFmtType.RAW);
  disks.add(patchDisk);
  patchDisk.setDiskPath(datadiskPath);
  String bootArgs=vmSpec.getBootArgs();
  patchSystemVm(bootArgs,datadiskPath,vmName);
}
