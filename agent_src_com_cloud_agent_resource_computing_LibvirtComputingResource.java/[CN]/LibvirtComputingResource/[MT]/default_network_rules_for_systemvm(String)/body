{
  String command;
  List<String> nics=getInterfaces(vmName);
  for (  String vif : nics) {
    command="iptables -D BRIDGE-FIREWALL -m physdev --physdev-is-bridged --physdev-out " + vif + " -j "+ vmName+ ";"+ "iptables -D BRIDGE-FIREWALL -m physdev --physdev-is-bridged --physdev-in "+ vif+ " -j "+ vmName;
    String result=executeBashScript(command);
    if (result != null) {
      s_logger.debug("Ingnoring failure to delete old rules");
    }
    command="iptables -N " + vmName;
    result=executeBashScript(command);
    if (result != null) {
      command="iptables -F " + vmName;
      result=executeBashScript(command);
    }
    command="iptables -A BRIDGE-FIREWALL -m physdev --physdev-is-bridged --physdev-out " + vif + " -j "+ vmName+ ";"+ "iptables -A BRIDGE-FIREWALL -m physdev --physdev-is-bridged --physdev-in "+ vif+ " -j "+ vmName;
    result=executeBashScript(command);
    if (result != null) {
      s_logger.debug("Failed to program default rules");
      return false;
    }
  }
  command="iptables -A " + vmName + " -j ACCEPT";
  executeBashScript(command);
  return true;
}
