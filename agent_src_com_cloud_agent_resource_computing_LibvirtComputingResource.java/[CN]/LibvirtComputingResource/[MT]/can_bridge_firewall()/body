{
  String command="iptables -N BRIDGE-FIREWALL; " + "iptables -I BRIDGE-FIREWALL -m state --state RELATED,ESTABLISHED -j ACCEPT";
  String result=executeBashScript(command);
  if (result != null) {
    s_logger.debug("Chain BRIDGE-FIREWALL already exists");
  }
  boolean enabled=true;
  result=executeBashScript("iptables -n -L FORWARD|grep BRIDGE-FIREWALL");
  ;
  if (result != null) {
    result=executeBashScript("iptables -I FORWARD -m physdev --physdev-is-bridged -j BRIDGE-FIREWALL");
    ;
    if (result != null) {
      enabled=false;
    }
  }
  File logPath=new File("/var/run/cloud");
  if (!logPath.exists()) {
    logPath.mkdir();
  }
  cleanup_rules_for_dead_vms();
  cleanup_rules();
  return enabled;
}
