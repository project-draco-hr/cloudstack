{
  String snapshotName=cmd.getSnapshotName();
  String VolPath=cmd.getVolumePath();
  try {
    StorageVol vol=getVolume(VolPath);
    if (vol == null) {
      return new ManageSnapshotAnswer(cmd,false,null);
    }
    Domain vm=getDomain(cmd.getVmName());
    String vmUuid=vm.getUUIDString();
    Object[] args=new Object[]{snapshotName,vmUuid};
    String snapshot=SnapshotXML.format(args);
    s_logger.debug(snapshot);
    if (cmd.getCommandSwitch().equalsIgnoreCase(ManageSnapshotCommand.CREATE_SNAPSHOT)) {
      vm.snapshotCreateXML(snapshot);
    }
 else {
      DomainSnapshot snap=vm.snapshotLookupByName(snapshotName);
      snap.delete(0);
    }
  }
 catch (  LibvirtException e) {
    s_logger.debug("Failed to manage snapshot: " + e.toString());
    return new ManageSnapshotAnswer(cmd,false,"Failed to manage snapshot: " + e.toString());
  }
  return new ManageSnapshotAnswer(cmd,cmd.getSnapshotId(),cmd.getVolumePath(),true,null);
}
