{
  int dx, dy, n;
  int i=y * rfb.framebufferWidth + x;
  int rowBytes=(w + 7) / 8;
  byte b;
  for (dy=0; dy < h; dy++) {
    for (dx=0; dx < w / 8; dx++) {
      b=src[dy * rowBytes + dx];
      for (n=7; n >= 0; n--)       pixels8[i++]=palette[b >> n & 1];
    }
    for (n=7; n >= 8 - w % 8; n--) {
      pixels8[i++]=palette[src[dy * rowBytes + dx] >> n & 1];
    }
    i+=(rfb.framebufferWidth - w);
  }
}
