{
  if (viewer.clientStream != null) {
    try {
      viewer.lastUsedTime=System.currentTimeMillis();
synchronized (viewer.clientStream) {
        viewer.clientStream.write(bs);
        viewer.clientStream.flush();
      }
    }
 catch (    IOException e) {
      Logger.log(Logger.INFO,"Writing to client stream failed, ignored " + e);
      Logger.log(Logger.DEBUG,e.toString(),e);
      try {
        viewer.clientStream.close();
      }
 catch (      IOException ioe) {
      }
      viewer.clientStream=null;
      viewer.clientStreamInfo=null;
    }
  }
}
