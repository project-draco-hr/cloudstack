def _setSizeVirt(self, size):
    'WARNING: do not call this method directly unless all VDIs in the\n        subtree are guaranteed to be unplugged (and remain so for the duration\n        of the operation): this operation is only safe for offline VHDs'
    self._activate()
    jFile = lvhdutil.createVHDJournalLV(self.sr.lvmCache, self.uuid, vhdutil.MAX_VHD_JOURNAL_SIZE)
    try:
        lvhdutil.setSizeVirt(self.sr.journaler, self.sr.uuid, self.uuid, size, jFile)
    finally:
        lvhdutil.deleteVHDJournalLV(self.sr.lvmCache, self.uuid)
