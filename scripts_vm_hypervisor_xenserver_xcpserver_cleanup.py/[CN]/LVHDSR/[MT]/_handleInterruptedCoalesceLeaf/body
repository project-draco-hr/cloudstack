def _handleInterruptedCoalesceLeaf(self):
    'An interrupted leaf-coalesce operation may leave the VHD tree in an \n        inconsistent state. If the old-leaf VDI is still present, we revert the \n        operation (in case the original error is persistent); otherwise we must \n        finish the operation'
    entries = self.journaler.getAll(VDI.JRN_LEAF)
    for (uuid, parentUuid) in entries.iteritems():
        childLV = (lvhdutil.LV_PREFIX[lvhdutil.VDI_TYPE_VHD] + uuid)
        tmpChildLV = ((lvhdutil.LV_PREFIX[lvhdutil.VDI_TYPE_VHD] + self.TMP_RENAME_PREFIX) + uuid)
        parentLV1 = (lvhdutil.LV_PREFIX[lvhdutil.VDI_TYPE_VHD] + parentUuid)
        parentLV2 = (lvhdutil.LV_PREFIX[lvhdutil.VDI_TYPE_RAW] + parentUuid)
        parentPresent = (self.lvmCache.checkLV(parentLV1) or self.lvmCache.checkLV(parentLV2))
        if (parentPresent or self.lvmCache.checkLV(tmpChildLV)):
            self._undoInterruptedCoalesceLeaf(uuid, parentUuid)
        else:
            self._finishInterruptedCoalesceLeaf(uuid, parentUuid)
        self.journaler.remove(VDI.JRN_LEAF, uuid)
