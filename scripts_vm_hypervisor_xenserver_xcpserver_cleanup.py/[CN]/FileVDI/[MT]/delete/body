def delete(self):
    if (len(self.children) > 0):
        raise util.SMException(("VDI %s has children, can't delete" % self.uuid))
    try:
        self.sr.lock()
        try:
            os.unlink(self.path)
        finally:
            self.sr.unlock()
    except OSError:
        raise util.SMException(('os.unlink(%s) failed' % self.path))
    self.sr.xapi.forgetVDI(self.uuid)
    VDI.delete(self)
