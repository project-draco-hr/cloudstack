def _coalesceLeaf(self, vdi):
    'Leaf-coalesce VDI vdi. Return true if we succeed, false if we cannot\n        complete due to external changes, namely vdi_delete and vdi_snapshot \n        that alter leaf-coalescibility of vdi'
    while (not vdi.canLiveCoalesce()):
        prevSizeVHD = vdi.getSizeVHD()
        if (not self._snapshotCoalesce(vdi)):
            return False
        if (vdi.getSizeVHD() >= prevSizeVHD):
            Util.log('Snapshot-coalesce did not help, abandoning attempts')
            vdi.setConfigUpdate(vdi.DB_LEAFCLSC, vdi.LEAFCLSC_OFFLINE)
            break
    return self._liveLeafCoalesce(vdi)
