def _liveLeafCoalesce(self, vdi):
    args = {'srUuid': self.uuid, 'vdiUuid': vdi.uuid, }
    util.fistpoint.activate('LVHDRT_coaleaf_delay_3', self.uuid)
    try:
        if (not self.xapi.atomicOp([vdi], 'coalesce_leaf', args, True)):
            Util.log(('%s is no longer leaf-coalesceable' % vdi.toString()))
            return False
    except XenAPI.Failure as e:
        if self.xapi.isInvalidHandleError(e):
            Util.log('The VDI appears to have been deleted meanwhile')
            return False
    self.scanLocked()
    return True
