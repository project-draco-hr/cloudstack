def coalesceLeaf(self, vdi, dryRun):
    'Leaf-coalesce vdi onto parent'
    Util.log(('Leaf-coalescing %s -> %s' % (vdi.toString(), vdi.parent.toString())))
    if dryRun:
        return
    try:
        try:
            self._coalesceLeaf(vdi)
        finally:
            vdi.delConfigUpdate(vdi.DB_LEAFCLSC)
    except (util.SMException, XenAPI.Failure) as e:
        if isinstance(e, AbortException):
            self.cleanup()
            raise
        else:
            self._failedCoalesceTargets.append(vdi)
            Util.logException('leaf-coalesce')
            Util.log('Leaf-coalesce failed, skipping')
    self.cleanup()
