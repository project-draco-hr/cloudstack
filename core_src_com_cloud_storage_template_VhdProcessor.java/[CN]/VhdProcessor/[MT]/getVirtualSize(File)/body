{
  FileInputStream strm=null;
  byte[] currentSize=new byte[8];
  byte[] creatorApp=new byte[4];
  try {
    strm=new FileInputStream(file);
    strm.skip(file.length() - vhdFooterSize + vhdFooterCreatorAppOffset);
    strm.read(creatorApp);
    strm.skip(vhdFooterCurrentSizeOffset - vhdFooterCreatorVerOffset);
    strm.read(currentSize);
  }
 catch (  Exception e) {
    s_logger.warn("Unable to read vhd file " + file.getAbsolutePath(),e);
    throw new CloudRuntimeException("Unable to read vhd file " + file.getAbsolutePath() + ": "+ e);
  }
 finally {
    if (strm != null) {
      try {
        strm.close();
      }
 catch (      IOException e) {
      }
    }
  }
  long templateSize=NumbersUtil.bytesToLong(currentSize);
  return templateSize;
}
