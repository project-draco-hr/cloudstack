@attr(configuration='vm.instancename.flag')
@attr(tags=['advanced', 'basic', 'sg', 'eip', 'advancedns', 'simulator'])
def test_02_instancename_from_default_configuration(self):
    ' Verify for globally set instancename\n        '
    del self.services['virtual_machine']['displayname']
    self.debug(('Deploying VM in account: %s' % self.account.name))
    virtual_machine = VirtualMachine.create(self.apiclient, self.services['virtual_machine'], accountid=self.account.name, domainid=self.account.domainid, serviceofferingid=self.service_offering.id)
    self.debug('Checking if the virtual machine is created properly or not?')
    vms = VirtualMachine.list(self.apiclient, id=virtual_machine.id, listall=True)
    self.assertEqual(isinstance(vms, list), True, 'List vms should retuen a valid name')
    vm = vms[0]
    self.assertEqual(vm.state, 'Running', 'Vm state should be running after deployment')
    self.assertEqual(vm.displayname, vm.id, 'Vm display name should not match the given name')
    self.debug(("select id from account where uuid = '%s';" % self.account.id))
    qresultset = self.dbclient.execute(("select id from account where uuid = '%s';" % self.account.id))
    self.assertEqual(isinstance(qresultset, list), True, 'Check DB query result set for valid data')
    self.assertNotEqual(len(qresultset), 0, 'Check DB Query result set')
    qresult = qresultset[0]
    account_id = qresult[0]
    self.debug(("select id from vm_instance where uuid = '%s';" % vm.id))
    qresultset = self.dbclient.execute(("select id from vm_instance where uuid = '%s';" % vm.id))
    self.assertEqual(isinstance(qresultset, list), True, 'Check DB query result set for valid data')
    self.assertNotEqual(len(qresultset), 0, 'Check DB Query result set')
    qresult = qresultset[0]
    self.debug(('Query result: %s' % qresult))
    vmid = qresult[0]
    self.debug('Fetching the global config value for instance.name')
    configs = Configurations.list(self.apiclient, name='instance.name', listall=True)
    config = configs[0]
    instance_name = config.value
    self.debug(('Instance.name: %s' % instance_name))
    internal_name = ((((('i-' + str(account_id)) + '-') + str(vmid)) + '-') + instance_name)
    self.assertEqual(vm.instancename, internal_name, 'VM internal name should match with that of the format')
    return
