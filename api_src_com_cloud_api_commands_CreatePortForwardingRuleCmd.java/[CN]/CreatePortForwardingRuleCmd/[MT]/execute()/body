{
  UserContext callerContext=UserContext.current();
  boolean success=false;
  PortForwardingRule rule=_entityMgr.findById(PortForwardingRule.class,getEntityId());
  try {
    success=_rulesService.applyPortForwardingRules(rule.getSourceIpAddress(),callerContext.getCaller());
  }
  finally {
    if (!success) {
      _rulesService.revokePortForwardingRule(getEntityId(),true);
    }
  }
  FirewallRuleResponse fwResponse=_responseGenerator.createFirewallRuleResponse(rule);
  fwResponse.setResponseName(getCommandName());
  setResponseObject(fwResponse);
}
