{
  if (network.getTrafficType() != TrafficType.Guest) {
    return false;
  }
  boolean hasFreeIps=true;
  if (network.getGuestType() == GuestType.Shared) {
    if (network.getGateway() != null) {
      hasFreeIps=_ipAddressDao.countFreeIPsInNetwork(network.getId()) > 0;
    }
    if (!hasFreeIps) {
      return false;
    }
    if (network.getIp6Gateway() != null) {
      hasFreeIps=isIP6AddressAvailable(network);
    }
  }
 else {
    hasFreeIps=(getAvailableIps(network,null)).size() > 0;
  }
  return hasFreeIps;
}
