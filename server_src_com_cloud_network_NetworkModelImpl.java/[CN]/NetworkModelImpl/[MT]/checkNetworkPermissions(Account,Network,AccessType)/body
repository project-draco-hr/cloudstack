{
  if (network == null) {
    throw new CloudRuntimeException("cannot check permissions on (Network) <null>");
  }
  AccountVO networkOwner=_accountDao.findById(network.getAccountId());
  if (networkOwner == null) {
    throw new PermissionDeniedException("Unable to use network with id= " + ((NetworkVO)network).getUuid() + ", network does not have an owner");
  }
  if (owner.getType() != Account.ACCOUNT_TYPE_PROJECT && networkOwner.getType() == Account.ACCOUNT_TYPE_PROJECT) {
    if (!_projectAccountDao.canAccessProjectAccount(owner.getAccountId(),network.getAccountId())) {
      throw new PermissionDeniedException("Unable to use network with id= " + ((NetworkVO)network).getUuid() + ", permission denied");
    }
  }
 else {
    _accountMgr.checkAccess(owner,accessType,network);
  }
}
