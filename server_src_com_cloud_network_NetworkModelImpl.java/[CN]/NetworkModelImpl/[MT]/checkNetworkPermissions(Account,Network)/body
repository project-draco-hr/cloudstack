{
  if (network.getGuestType() != Network.GuestType.Shared) {
    AccountVO networkOwner=_accountDao.findById(network.getAccountId());
    if (networkOwner == null)     throw new PermissionDeniedException("Unable to use network with id= " + network.getId() + ", network does not have an owner");
    if (owner.getType() != Account.ACCOUNT_TYPE_PROJECT && networkOwner.getType() == Account.ACCOUNT_TYPE_PROJECT) {
      if (!_projectAccountDao.canAccessProjectAccount(owner.getAccountId(),network.getAccountId())) {
        throw new PermissionDeniedException("Unable to use network with id= " + network.getId() + ", permission denied");
      }
    }
 else {
      List<NetworkVO> networkMap=_networksDao.listBy(owner.getId(),network.getId());
      if (networkMap == null || networkMap.isEmpty()) {
        throw new PermissionDeniedException("Unable to use network with id= " + network.getId() + ", permission denied");
      }
    }
  }
 else {
    if (!isNetworkAvailableInDomain(network.getId(),owner.getDomainId())) {
      throw new PermissionDeniedException("Shared network id=" + network.getUuid() + " is not available in domain id="+ owner.getDomainId());
    }
  }
}
