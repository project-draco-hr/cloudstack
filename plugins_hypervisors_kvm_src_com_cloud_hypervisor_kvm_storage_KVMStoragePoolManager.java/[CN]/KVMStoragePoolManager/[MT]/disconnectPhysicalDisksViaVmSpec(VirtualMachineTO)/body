{
  if (vmSpec == null) {
    s_logger.debug("disconnectPhysicalDiskViaVmSpec: Attempted to stop a VM that is not yet in our hash map");
    return true;
  }
  boolean result=true;
  final String vmName=vmSpec.getName();
  List<DiskTO> disks=Arrays.asList(vmSpec.getDisks());
  for (  DiskTO disk : disks) {
    if (disk.getType() != Volume.Type.ISO) {
      s_logger.debug("Disconnecting disk " + disk.getPath());
      VolumeObjectTO vol=(VolumeObjectTO)disk.getData();
      PrimaryDataStoreTO store=(PrimaryDataStoreTO)vol.getDataStore();
      KVMStoragePool pool=getStoragePool(store.getPoolType(),store.getUuid());
      if (pool == null) {
        s_logger.error("Pool " + store.getUuid() + " of type "+ store.getPoolType()+ " was not found, skipping disconnect logic");
        continue;
      }
      StorageAdaptor adaptor=getStorageAdaptor(pool.getType());
      boolean subResult=adaptor.disconnectPhysicalDisk(vol.getPath(),pool);
      if (!subResult) {
        s_logger.error("Failed to disconnect disks via vm spec for vm: " + vmName + " volume:"+ vol.toString());
        result=false;
      }
    }
  }
  return result;
}
