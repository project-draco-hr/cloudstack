{
  Map<String,String> mapNewDisk=new HashMap<String,String>();
  VirtualDisk[] vdisks=vmMo.getAllDiskDevice();
  for (int i=0; i < vdisks.length; i++) {
    List<Pair<String,ManagedObjectReference>> vmdkFiles=vmMo.getDiskDatastorePathChain(vdisks[i],false);
    for (    Pair<String,ManagedObjectReference> fileItem : vmdkFiles) {
      String fullPath=fileItem.first();
      String baseName=null;
      String vmdkName=null;
      if (fullPath.startsWith("[-iqn.")) {
        baseName=fullPath.split(" ")[0];
        baseName=baseName.substring(1,baseName.length() - 1);
        vmdkName=fullPath;
      }
 else {
        vmdkName=fullPath.split("] ")[1];
        if (vmdkName.endsWith(".vmdk")) {
          vmdkName=vmdkName.substring(0,vmdkName.length() - (".vmdk").length());
        }
        String token="/";
        if (vmdkName.contains(token)) {
          vmdkName=vmdkName.substring(vmdkName.indexOf(token) + token.length());
        }
        baseName=extractSnapshotBaseFileName(vmdkName);
      }
      mapNewDisk.put(baseName,vmdkName);
    }
  }
  return mapNewDisk;
}
