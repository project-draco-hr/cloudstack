def get_all_rules(self):
    for i in CsHelper.execute('iptables-save'):
        if i.startswith('*'):
            self.table.add(i[1:])
        if i.startswith(':'):
            string = i[1:].split(' ')[0]
            cmd = ('iptables -t %s -N %s' % (self.table.last(), string))
            self.iptablerules.append(cmd)
            self.chain.add(self.table.last(), string)
        if i.startswith('-A'):
            self.chain.add_rule(i.split()[1])
            rule = CsNetfilter()
            rule.parse(i)
            rule.set_table(self.table.last())
            rule.set_chain(i.split()[1])
            rule.set_count(self.chain.get_count(i.split()[1]))
            self.save(rule)
