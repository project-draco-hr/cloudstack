{
  s_logger.debug("APPLYING USERDATA RULES");
  final String typeString="userdata and password entry";
  final Long podId=dest.getPod().getId();
  boolean isPodLevelException=false;
  if (podId != null && profile.getVirtualMachine().getType() == VirtualMachine.Type.User && network.getTrafficType() == TrafficType.Guest && network.getGuestType() == Network.GuestType.Shared) {
    isPodLevelException=true;
  }
  final boolean failWhenDisconnect=false;
  UserdataPwdRules pwdRules=_virtualNetworkApplianceFactory.createUserdataPwdRules(network,nic,profile,dest);
  return applyRules(network,routers,typeString,isPodLevelException,podId,failWhenDisconnect,new RuleApplierWrapper<RuleApplier>(pwdRules));
}
