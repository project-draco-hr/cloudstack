{
  if (!isVmSecurityGroupEnabled(userVmId)) {
    return;
  }
  final Transaction txn=Transaction.currentTxn();
  txn.start();
  UserVm userVm=_userVMDao.acquireInLockTable(userVmId);
  if (userVm == null) {
    s_logger.warn("Failed to acquire lock on user vm id=" + userVmId);
  }
  int n=_securityGroupVMMapDao.deleteVM(userVmId);
  s_logger.info("Disassociated " + n + " network groups "+ " from uservm "+ userVmId);
  _userVMDao.releaseFromLockTable(userVmId);
  txn.commit();
}
