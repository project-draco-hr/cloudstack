{
  String enabled=_configDao.getValue("direct.attach.security.groups.enabled");
  if ("true".equalsIgnoreCase(enabled)) {
    _enabled=true;
  }
  if (!_enabled) {
    return false;
  }
  _answerListener=new SecurityGroupListener(this,_agentMgr,_workDao);
  _agentMgr.registerForHostEvents(_answerListener,true,true,true);
  _serverId=((ManagementServer)ComponentLocator.getComponent(ManagementServer.Name)).getId();
  _executorPool=Executors.newScheduledThreadPool(10,new NamedThreadFactory("NWGRP"));
  _cleanupExecutor=Executors.newScheduledThreadPool(1,new NamedThreadFactory("NWGRP-Cleanup"));
  VirtualMachine.State.getStateMachine().registerListener(this);
  return true;
}
