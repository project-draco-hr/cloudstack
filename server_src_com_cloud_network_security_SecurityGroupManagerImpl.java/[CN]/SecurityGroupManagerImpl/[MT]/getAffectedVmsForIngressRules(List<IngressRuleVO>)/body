{
  Set<Long> distinctGroups=new HashSet<Long>();
  Set<Long> affectedVms=new HashSet<Long>();
  for (  IngressRuleVO allowingRule : allowingRules) {
    distinctGroups.add(allowingRule.getNetworkGroupId());
  }
  for (  Long groupId : distinctGroups) {
    affectedVms.addAll(_networkGroupVMMapDao.listVmIdsByNetworkGroup(groupId));
  }
  return affectedVms;
}
