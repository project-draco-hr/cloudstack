{
  List<EgressIpPortAndProto> result=new ArrayList<EgressIpPortAndProto>();
  for (  PortAndProto pAp : rules.keySet()) {
    Set<String> cidrs=rules.get(pAp);
    if (cidrs.size() > 0) {
      EgressIpPortAndProto ipPortAndProto=new SecurityEgressRulesCmd.EgressIpPortAndProto(pAp.getProto(),pAp.getStartPort(),pAp.getEndPort(),cidrs.toArray(new String[cidrs.size()]));
      result.add(ipPortAndProto);
    }
  }
  return new SecurityEgressRulesCmd(guestIp,guestMac,vmName,vmId,signature,seqnum,result.toArray(new EgressIpPortAndProto[result.size()]));
}
