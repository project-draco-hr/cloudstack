{
  if (state != com.cloud.event.Event.State.Completed) {
    return;
  }
  try {
    s_messageBus=ComponentContext.getComponent(MessageBusBase.class);
  }
 catch (  NoSuchBeanDefinitionException nbe) {
    return;
  }
  org.apache.cloudstack.framework.events.Event event=new org.apache.cloudstack.framework.events.Event(ManagementService.Name,eventCategory,eventType,EventTypes.getEntityForEvent(eventType),null);
  Map<String,String> eventDescription=new HashMap<String,String>();
  eventDescription.put("event",eventType);
  eventDescription.put("status",state.toString());
  eventDescription.put("details",details);
  event.setDescription(eventDescription);
  try {
    s_messageBus.publish(EventTypes.getEntityForEvent(eventType),eventType,null,event);
  }
 catch (  Exception e) {
    s_logger.warn("Failed to publish action event on the the event bus.");
  }
}
