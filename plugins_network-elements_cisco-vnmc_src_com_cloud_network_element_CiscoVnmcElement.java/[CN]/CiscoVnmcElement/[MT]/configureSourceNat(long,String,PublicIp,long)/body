{
  boolean add=(sourceNatIp.getState() == IpAddress.State.Releasing ? false : true);
  IpAddressTO ip=new IpAddressTO(sourceNatIp.getAccountId(),sourceNatIp.getAddress().addr(),add,false,sourceNatIp.isSourceNat(),sourceNatIp.getVlanTag(),sourceNatIp.getGateway(),sourceNatIp.getNetmask(),sourceNatIp.getMacAddress(),null,sourceNatIp.isOneToOneNat());
  boolean addSourceNat=false;
  if (sourceNatIp.isSourceNat()) {
    addSourceNat=add;
  }
  SetSourceNatCommand cmd=new SetSourceNatCommand(ip,addSourceNat);
  cmd.setContextParam(NetworkElementCommand.GUEST_VLAN_TAG,Long.toString(vlanId));
  cmd.setContextParam(NetworkElementCommand.GUEST_NETWORK_CIDR,guestCidr);
  Answer answer=_agentMgr.easySend(hostId,cmd);
  return answer.getResult();
}
