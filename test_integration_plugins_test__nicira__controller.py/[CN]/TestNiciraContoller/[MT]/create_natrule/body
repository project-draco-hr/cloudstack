def create_natrule(self, vm, public_ip, network):
    self.logger.debug('Creating NAT rule in network for vm with public IP')
    nat_rule = NATRule.create(self.api_client, vm, self.vm_services['small'], ipaddressid=public_ip.ipaddress.id, openfirewall=True, networkid=network.id)
    self.test_cleanup.append(nat_rule)
    return nat_rule
