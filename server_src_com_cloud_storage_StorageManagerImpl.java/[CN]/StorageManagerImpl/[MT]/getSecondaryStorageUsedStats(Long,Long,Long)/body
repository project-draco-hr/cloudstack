{
  SearchCriteria<HostVO> sc=_hostDao.createSearchCriteria();
  if (zoneId != null) {
    sc.addAnd("dataCenterId",SearchCriteria.Op.EQ,zoneId);
  }
  if (podId != null) {
    sc.addAnd("podId",SearchCriteria.Op.EQ,podId);
  }
  if (hostId != null) {
    sc.addAnd("hostOrPoolId",SearchCriteria.Op.EQ,hostId);
  }
  List<HostVO> hosts=_hostDao.search(sc,null);
  List<CapacityVO> capacities=new LinkedList<CapacityVO>();
  for (  HostVO host : hosts) {
    StorageStats stats=ApiDBUtils.getSecondaryStorageStatistics(host.getId());
    if (stats == null) {
      continue;
    }
    CapacityVO capacity=new CapacityVO(host.getId(),host.getDataCenterId(),host.getPodId(),host.getClusterId(),stats.getByteUsed(),stats.getCapacityBytes(),Capacity.CAPACITY_TYPE_SECONDARY_STORAGE);
    capacities.add(capacity);
  }
  return capacities;
}
