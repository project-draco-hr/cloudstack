{
  ImageStoreVO store=_imageStoreDao.findById(storeId);
  if (store == null) {
    throw new InvalidParameterValueException("Image store with id " + storeId + " doesn't exist");
  }
 else   if (!store.getProviderName().equals(DataStoreProvider.NFS_IMAGE)) {
    throw new InvalidParameterValueException("We only support migrate NFS secondary storage to use object store!");
  }
  _accountMgr.checkAccessAndSpecifyAuthority(CallContext.current().getCallingAccount(),store.getDataCenterId());
  DataStoreProvider provider=dataStoreProviderMgr.getDataStoreProvider(store.getProviderName());
  DataStoreLifeCycle lifeCycle=provider.getDataStoreLifeCycle();
  DataStore secStore=dataStoreMgr.getDataStore(storeId,DataStoreRole.Image);
  lifeCycle.migrateToObjectStore(secStore);
  _templateStoreDao.updateStoreRoleToCachce(storeId);
  _snapshotStoreDao.updateStoreRoleToCache(storeId);
  return (ImageStore)_dataStoreMgr.getDataStore(storeId,DataStoreRole.ImageCache);
}
