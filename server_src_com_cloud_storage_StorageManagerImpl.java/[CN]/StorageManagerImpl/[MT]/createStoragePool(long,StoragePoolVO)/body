{
  s_logger.debug("creating pool " + pool.getName() + " on  host "+ hostId);
  if (pool.getPoolType() != StoragePoolType.NetworkFilesystem && pool.getPoolType() != StoragePoolType.Filesystem && pool.getPoolType() != StoragePoolType.IscsiLUN && pool.getPoolType() != StoragePoolType.Iscsi && pool.getPoolType() != StoragePoolType.VMFS && pool.getPoolType() != StoragePoolType.SharedMountPoint && pool.getPoolType() != StoragePoolType.PreSetup && pool.getPoolType() != StoragePoolType.OCFS2 && pool.getPoolType() != StoragePoolType.CLVM) {
    s_logger.warn(" Doesn't support storage pool type " + pool.getPoolType());
    return false;
  }
  CreateStoragePoolCommand cmd=new CreateStoragePoolCommand(true,pool);
  final Answer answer=_agentMgr.easySend(hostId,cmd);
  if (answer != null && answer.getResult()) {
    return true;
  }
 else {
    _storagePoolDao.expunge(pool.getId());
    String msg="";
    if (answer != null) {
      msg="Can not create strorage pool through host " + hostId + " due to "+ answer.getDetails();
      s_logger.warn(msg);
    }
 else {
      msg="Can not create strorage pool through host " + hostId + " due to CreateStoragePoolCommand returns null";
      s_logger.warn(msg);
    }
    throw new CloudRuntimeException(msg);
  }
}
