{
  DomainRouterVO router=getRouter(vpnVO.getAccountId(),vpnVO.getZoneId());
  if (router == null) {
    s_logger.warn("Failed to start remote access VPN: no router found for account and zone");
    return null;
  }
  if (router.getState() != State.Running) {
    s_logger.warn("Failed to start remote access VPN: router not in running state");
    return null;
  }
  try {
    Answer answer=_agentMgr.send(router.getHostId(),new RemoteAccessVpnCfgCommand(true,router.getPrivateIpAddress(),vpnVO.getVpnServerAddress(),vpnVO.getLocalIp(),vpnVO.getIpRange(),vpnVO.getIpsecPresharedKey()));
    if (answer != null && answer.getResult()) {
      return vpnVO;
    }
 else {
      s_logger.debug("Failed to start remote access VPN: " + answer.getDetails());
      return null;
    }
  }
 catch (  AgentUnavailableException e) {
    s_logger.debug("Failed to start remote access VPN: ",e);
    return null;
  }
catch (  OperationTimedoutException e) {
    s_logger.debug("Failed to start remote access VPN: ",e);
    return null;
  }
}
