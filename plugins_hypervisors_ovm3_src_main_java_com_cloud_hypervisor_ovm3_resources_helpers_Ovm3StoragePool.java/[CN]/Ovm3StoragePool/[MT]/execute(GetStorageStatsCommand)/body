{
  LOGGER.debug("Getting stats for: " + cmd.getStorageId());
  try {
    Linux host=new Linux(c);
    Linux.FileSystem fs=host.getFileSystemByUuid(cmd.getStorageId(),"nfs");
    StoragePlugin store=new StoragePlugin(c);
    String propUuid=store.deDash(cmd.getStorageId());
    String mntUuid=cmd.getStorageId();
    if (store == null || propUuid == null || mntUuid == null || fs == null) {
      String msg="Null returned when retrieving stats for " + cmd.getStorageId();
      LOGGER.error(msg);
      return new GetStorageStatsAnswer(cmd,msg);
    }
    StorageDetails sd=store.storagePluginGetFileSystemInfo(propUuid,mntUuid,fs.getHost(),fs.getDevice());
    if ("".equals(sd.getSize())) {
      String msg="No size when retrieving stats for " + cmd.getStorageId();
      LOGGER.debug(msg);
      return new GetStorageStatsAnswer(cmd,msg);
    }
    long total=Long.parseLong(sd.getSize());
    long used=total - Long.parseLong(sd.getFreeSize());
    return new GetStorageStatsAnswer(cmd,total,used);
  }
 catch (  Ovm3ResourceException e) {
    LOGGER.debug("GetStorageStatsCommand for " + cmd.getStorageId() + " failed",e);
    return new GetStorageStatsAnswer(cmd,e.getMessage());
  }
}
