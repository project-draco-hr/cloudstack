{
  if (viewer.status == ConsoleProxyViewer.STATUS_NORMAL_OPERATION) {
    return;
  }
  Long startTime=System.currentTimeMillis();
  int delay=500;
  while (System.currentTimeMillis() < startTime + 30000 && viewer.status != ConsoleProxyViewer.STATUS_NORMAL_OPERATION) {
    if (viewer.status == ConsoleProxyViewer.STATUS_AUTHENTICATION_FAILURE) {
      throw new Exception("Authentication failure");
    }
    try {
      Thread.sleep(delay);
    }
 catch (    InterruptedException e) {
    }
    delay=(int)(delay * 1.5);
  }
  if (viewer.status != ConsoleProxyViewer.STATUS_NORMAL_OPERATION) {
    throw new Exception("Cannot start VncViewer");
  }
  s_logger.info("Waited " + (System.currentTimeMillis() - startTime) + "ms for VncViewer to start");
}
