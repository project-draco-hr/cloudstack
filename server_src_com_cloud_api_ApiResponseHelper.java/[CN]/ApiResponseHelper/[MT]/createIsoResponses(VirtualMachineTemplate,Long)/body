{
  ListResponse<TemplateResponse> response=new ListResponse<TemplateResponse>();
  List<TemplateResponse> responses=new ArrayList<TemplateResponse>();
  List<DataCenterVO> zones=null;
  if ((zoneId != null) && (zoneId != -1)) {
    zones=new ArrayList<DataCenterVO>();
    zones.add(ApiDBUtils.findZoneById(zoneId));
  }
 else {
    zones=ApiDBUtils.listZones();
  }
  for (  DataCenterVO zone : zones) {
    TemplateResponse templateResponse=new TemplateResponse();
    templateResponse.setId(template.getId());
    templateResponse.setName(template.getName());
    templateResponse.setDisplayText(template.getDisplayText());
    templateResponse.setPublic(template.isPublicTemplate());
    VMTemplateHostVO isoHostRef=ApiDBUtils.findTemplateHostRef(template.getId(),zone.getId());
    if (isoHostRef != null) {
      templateResponse.setCreated(isoHostRef.getCreated());
      templateResponse.setReady(isoHostRef.getDownloadState() == Status.DOWNLOADED);
    }
    templateResponse.setFeatured(template.isFeatured());
    templateResponse.setExtractable(template.isExtractable());
    templateResponse.setBootable(template.isBootable());
    templateResponse.setOsTypeId(template.getGuestOSId());
    templateResponse.setOsTypeName(ApiDBUtils.findGuestOSById(template.getGuestOSId()).getDisplayName());
    Account owner=ApiDBUtils.findAccountById(template.getAccountId());
    if (owner != null) {
      templateResponse.setAccountId(owner.getId());
      templateResponse.setAccount(owner.getAccountName());
      templateResponse.setDomainId(owner.getDomainId());
      templateResponse.setDomainName(ApiDBUtils.findDomainById(owner.getDomainId()).getName());
    }
    templateResponse.setZoneId(zone.getId());
    templateResponse.setZoneName(zone.getName());
    templateResponse.setObjectName("iso");
    responses.add(templateResponse);
  }
  response.setResponses(responses);
  return response;
}
