{
  Map<String,String> vsmCredentials=getValidatedVsmCredentials(context);
  String vsmIp=vsmCredentials.get("vsmip");
  String vsmUserName=vsmCredentials.get("vsmusername");
  String vsmPassword=vsmCredentials.get("vsmpassword");
  String msg;
  NetconfHelper netconfClient;
  try {
    netconfClient=new NetconfHelper(vsmIp,vsmUserName,vsmPassword);
  }
 catch (  CloudRuntimeException e) {
    msg="Failed to connect to Nexus VSM " + vsmIp + " with credentials of user "+ vsmUserName;
    s_logger.error(msg);
    throw new CloudRuntimeException(msg);
  }
  List<Pair<OperationType,String>> params=new ArrayList<Pair<OperationType,String>>();
  params.add(new Pair<OperationType,String>(OperationType.addvlanid,vid.toString()));
  try {
    netconfClient.updatePortProfile(ethPortProfileName,SwitchPortMode.access,params);
  }
 catch (  CloudRuntimeException e) {
    msg="Failed to modify ethernet port profile " + ethPortProfileName + " with parameters "+ params.toString();
    s_logger.error(msg);
    throw new CloudRuntimeException(msg);
  }
  try {
    netconfClient.addPortProfile(networkName,PortProfileType.vethernet,BindingType.portbindingstatic,SwitchPortMode.access,vid);
  }
 catch (  CloudRuntimeException e) {
    msg="Failed to add vethernet port profile " + networkName + " with parameters "+ params.toString();
    s_logger.error(msg);
    throw new CloudRuntimeException(msg);
  }
}
