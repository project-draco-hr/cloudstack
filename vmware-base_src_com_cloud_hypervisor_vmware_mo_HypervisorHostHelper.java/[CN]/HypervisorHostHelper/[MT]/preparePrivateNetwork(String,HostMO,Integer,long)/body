{
  HostVirtualSwitch vSwitch=hostMo.getHostVirtualSwitchByName(vSwitchName);
  if (vSwitch == null) {
    String msg="Unable to find vSwitch configured for private network";
    s_logger.error(msg);
    throw new Exception(msg);
  }
  String networkName;
  networkName=composeCloudNetworkName("cloud.private",vlanId == null ? null : String.valueOf(vlanId),null,vSwitchName);
  if (!hostMo.hasPortGroup(vSwitch,networkName)) {
    hostMo.createPortGroup(vSwitch,networkName,vlanId,null);
  }
  ManagedObjectReference morNetwork=waitForNetworkReady(hostMo,networkName,timeOutMs);
  if (morNetwork == null) {
    String msg="Failed to create private network";
    s_logger.error(msg);
    throw new Exception(msg);
  }
  s_logger.info("Network " + networkName + " is ready on vSwitch "+ vSwitchName);
  return new Pair<ManagedObjectReference,String>(morNetwork,networkName);
}
