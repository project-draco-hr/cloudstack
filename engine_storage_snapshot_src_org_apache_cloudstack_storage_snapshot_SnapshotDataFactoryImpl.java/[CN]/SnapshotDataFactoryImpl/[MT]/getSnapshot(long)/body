{
  SnapshotVO snapshot=snapshotDao.findByIdIncludingRemoved(snapshotId);
  SnapshotObject so=null;
  if (snapshot.getState() == Snapshot.State.BackedUp) {
    DataStore store=null;
    SnapshotDataStoreVO snapshotStore=snapshotStoreDao.findBySnapshot(snapshotId);
    if (snapshotStore != null) {
      store=this.storeMgr.getDataStore(snapshotStore.getDataStoreId(),DataStoreRole.Image);
    }
    so=SnapshotObject.getSnapshotObject(snapshot,store);
  }
 else {
    VolumeInfo volume=this.volumeFactory.getVolume(snapshot.getVolumeId());
    so=SnapshotObject.getSnapshotObject(snapshot,volume.getDataStore());
  }
  return so;
}
