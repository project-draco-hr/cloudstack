{
  UserContext callerContext=UserContext.current();
  boolean success=false;
  FirewallRule rule=_networkACLService.getNetworkACLItem(getEntityId());
  try {
    UserContext.current().setEventDetails("Rule Id: " + getEntityId());
    success=_networkACLService.applyNetworkACLs(rule.getNetworkId(),callerContext.getCaller());
    NetworkACLResponse aclResponse=new NetworkACLResponse();
    if (rule != null) {
      aclResponse=_responseGenerator.createNetworkACLItemResponse(rule);
      setResponseObject(aclResponse);
    }
    aclResponse.setResponseName(getCommandName());
  }
  finally {
    if (!success || rule == null) {
      _networkACLService.revokeNetworkACL(getEntityId(),true);
      throw new ServerApiException(ApiErrorCode.INTERNAL_ERROR,"Failed to create network ACL");
    }
  }
}
