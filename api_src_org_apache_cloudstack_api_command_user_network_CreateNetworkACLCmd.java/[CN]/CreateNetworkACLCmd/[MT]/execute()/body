{
  UserContext callerContext=UserContext.current();
  boolean success=false;
  NetworkACLItem rule=_networkACLService.getNetworkACLItem(getEntityId());
  try {
    UserContext.current().setEventDetails("Rule Id: " + getEntityId());
    success=_networkACLService.applyNetworkACL(rule.getACLId(),callerContext.getCaller());
    NetworkACLItemResponse aclResponse=new NetworkACLItemResponse();
    if (rule != null) {
      aclResponse=_responseGenerator.createNetworkACLItemResponse(rule);
      setResponseObject(aclResponse);
    }
    aclResponse.setResponseName(getCommandName());
  }
  finally {
    if (!success || rule == null) {
      _networkACLService.revokeNetworkACLItem(getEntityId(),true);
      throw new ServerApiException(ApiErrorCode.INTERNAL_ERROR,"Failed to create network ACL");
    }
  }
}
