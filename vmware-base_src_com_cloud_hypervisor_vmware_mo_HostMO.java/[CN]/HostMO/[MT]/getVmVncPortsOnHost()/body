{
  ObjectContent[] ocs=getVmPropertiesOnHyperHost(new String[]{"name","config.extraConfig[\"RemoteDisplay.vnc.port\"]"});
  HashMap<String,Integer> portInfo=new HashMap<String,Integer>();
  if (ocs != null && ocs.length > 0) {
    for (    ObjectContent oc : ocs) {
      List<DynamicProperty> objProps=oc.getPropSet();
      if (objProps != null) {
        String vmName=null;
        String value=null;
        String vmInternalCSName=null;
        for (        DynamicProperty objProp : objProps) {
          if (objProp.getName().equals("name")) {
            vmName=(String)objProp.getVal();
          }
 else {
            OptionValue optValue=(OptionValue)objProp.getVal();
            value=(String)optValue.getValue();
          }
        }
        VirtualMachineMO vmMo=new VirtualMachineMO(_context,oc.getObj());
        vmInternalCSName=vmMo.getCustomFieldValue(CustomFieldConstants.CLOUD_VM_INTERNAL_NAME);
        if (vmInternalCSName != null && isUserVMInternalCSName(vmInternalCSName))         vmName=vmInternalCSName;
        if (vmName != null && value != null) {
          portInfo.put(vmName,Integer.parseInt(value));
        }
      }
    }
  }
  return portInfo;
}
