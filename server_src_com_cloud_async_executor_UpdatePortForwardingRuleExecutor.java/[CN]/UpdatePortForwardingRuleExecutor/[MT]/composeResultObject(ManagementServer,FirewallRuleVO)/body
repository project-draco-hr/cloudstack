{
  UpdatePortForwardingRuleResultObject resultObject=new UpdatePortForwardingRuleResultObject();
  IPAddressVO ipAddressVO=ms.findIPAddressById(firewallRule.getPublicIpAddress());
  Criteria c=new Criteria();
  c.addCriteria(Criteria.ACCOUNTID,new Object[]{ipAddressVO.getAccountId()});
  c.addCriteria(Criteria.DATACENTERID,ipAddressVO.getDataCenterId());
  c.addCriteria(Criteria.IPADDRESS,firewallRule.getPrivateIpAddress());
  List<UserVmVO> userVMs=ms.searchForUserVMs(c);
  if ((userVMs != null) && (userVMs.size() > 0)) {
    UserVmVO userVM=userVMs.get(0);
    resultObject.setVirtualMachineId(userVM.getId());
    resultObject.setVirtualMachineName(userVM.getName());
  }
  resultObject.setId(firewallRule.getId());
  resultObject.setPublicIp(firewallRule.getPublicIpAddress());
  resultObject.setPrivateIp(firewallRule.getPrivateIpAddress());
  resultObject.setPublicPort(firewallRule.getPublicPort());
  resultObject.setPrivatePort(firewallRule.getPrivatePort());
  resultObject.setProtocol(firewallRule.getProtocol());
  return resultObject;
}
