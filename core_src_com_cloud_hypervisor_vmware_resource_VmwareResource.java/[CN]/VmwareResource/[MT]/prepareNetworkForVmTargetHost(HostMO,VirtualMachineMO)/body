{
  assert(vmMo != null);
  assert(hostMo != null);
  String[] networks=vmMo.getNetworks();
  for (  String networkName : networks) {
    HostPortGroupSpec portGroupSpec=hostMo.getHostPortGroupSpec(networkName);
    HostNetworkTrafficShapingPolicy shapingPolicy=null;
    if (portGroupSpec != null) {
      shapingPolicy=portGroupSpec.getPolicy().getShapingPolicy();
    }
    if (networkName.startsWith("cloud.private")) {
      preparePrivateNetwork(hostMo);
    }
 else     if (networkName.startsWith("cloud.public")) {
      String[] tokens=networkName.split("\\.");
      if (tokens.length == 3) {
        Integer networkRateMbps=null;
        if (shapingPolicy != null && shapingPolicy.getEnabled() != null && shapingPolicy.getEnabled().booleanValue()) {
          networkRateMbps=(int)(shapingPolicy.getPeakBandwidth().longValue() / (1024 * 1024));
        }
        preparePublicNetwork(hostMo,tokens[2],networkRateMbps,null);
      }
 else {
        s_logger.info("Skip suspecious cloud network " + networkName);
      }
    }
 else     if (networkName.startsWith("cloud.guest")) {
      String[] tokens=networkName.split("\\.");
      if (tokens.length >= 3) {
        Integer networkRateMbps=null;
        if (shapingPolicy != null && shapingPolicy.getEnabled() != null && shapingPolicy.getEnabled().booleanValue()) {
          networkRateMbps=(int)(shapingPolicy.getPeakBandwidth().longValue() / (1024 * 1024));
        }
        prepareGuestNetwork(hostMo,tokens[2],networkRateMbps,null);
      }
 else {
        s_logger.info("Skip suspecious cloud network " + networkName);
      }
    }
 else {
      s_logger.info("Skip non-cloud network " + networkName + " when preparing target host");
    }
  }
}
