{
  if (nicTo.getType() == Networks.TrafficType.Guest) {
    return prepareGuestNetwork(hostMo,getVlanInfo(nicTo),nicTo.getNetworkRateMbps(),nicTo.getNetworkRateMulticastMbps());
  }
 else   if (nicTo.getType() == Networks.TrafficType.Control || nicTo.getType() == Networks.TrafficType.Management) {
    return preparePrivateNetwork(hostMo);
  }
 else   if (nicTo.getType() == Networks.TrafficType.Public) {
    return preparePublicNetwork(hostMo,getVlanInfo(nicTo),nicTo.getNetworkRateMbps(),nicTo.getNetworkRateMulticastMbps());
  }
 else   if (nicTo.getType() == Networks.TrafficType.Storage) {
    throw new Exception("Unsupported traffic type: " + nicTo.getType().toString());
  }
 else   if (nicTo.getType() == Networks.TrafficType.Vpn) {
    throw new Exception("Unsupported traffic type: " + nicTo.getType().toString());
  }
 else {
    throw new Exception("Unsupported traffic type: " + nicTo.getType().toString());
  }
}
