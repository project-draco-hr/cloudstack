{
  Pair<ManagedObjectReference,String> networkInfo=HypervisorHostHelper.preparePublicNetwork(this._publicNetworkVSwitchName,vmMo.getRunningHost(),vlanId,null,null,this._ops_timeout,true);
  VmwareManager mgr=getServiceContext().getStockObject(VmwareManager.CONTEXT_STOCK_NAME);
  VirtualDevice nic=VmwareHelper.prepareNicDevice(vmMo,networkInfo.first(),VirtualEthernetCardType.Vmxnet3,networkInfo.second(),vifMacAddress,-1,1,true,true);
  vmMo.plugDevice(nic);
}
