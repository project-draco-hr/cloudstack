{
  HashMap<String,State> newStates=sync();
  if (newStates == null) {
    return null;
  }
  try {
    VmwareContext context=getServiceContext();
    VmwareHypervisorHost hyperHost=getHyperHost(context);
    VmwareManager mgr=hyperHost.getContext().getStockObject(VmwareManager.CONTEXT_STOCK_NAME);
    if (hyperHost.isHyperHostConnected()) {
      mgr.gcLeftOverVMs(context);
    }
 else {
      s_logger.error("Host is no longer connected.");
      return null;
    }
  }
 catch (  Throwable e) {
    if (e instanceof RemoteException) {
      s_logger.warn("Encounter remote exception to vCenter, invalidate VMware session context");
      invalidateServiceContext();
      return null;
    }
  }
  return new PingRoutingCommand(getType(),id,newStates);
}
