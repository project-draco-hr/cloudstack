{
  try {
    List<SyncQueueItemVO> l=_queueMgr.getActiveQueueItems(getMsid(),false);
    cleanupPendingJobs(l);
    _jobDao.resetJobProcess(getMsid(),ApiErrorCode.INTERNAL_ERROR.getHttpCode(),getSerializedErrorMessage("job cancelled because of management server restart"));
  }
 catch (  Throwable e) {
    s_logger.error("Unexpected exception " + e.getMessage(),e);
  }
  _heartbeatScheduler.scheduleAtFixedRate(getHeartbeatTask(),HEARTBEAT_INTERVAL,HEARTBEAT_INTERVAL,TimeUnit.MILLISECONDS);
  _heartbeatScheduler.scheduleAtFixedRate(getGCTask(),GC_INTERVAL,GC_INTERVAL,TimeUnit.MILLISECONDS);
  return true;
}
