{
  AsyncJobExecutor executor=getJobExecutor(job);
  if (executor == null) {
    s_logger.error("Unable to find executor to execute command " + job.getCmd() + " for job-"+ job.getId());
  }
 else {
    Transaction txt=Transaction.currentTxn();
    try {
      txt.start();
      job.setInitMsid(getMsid());
      _jobDao.persist(job);
      txt.commit();
      executor.setSyncSource(null);
      executor.setJob(job);
      scheduleExecution(executor,scheduleJobExecutionInContext);
      if (s_logger.isDebugEnabled()) {
        s_logger.debug("submit async job-" + job.getId() + ", details: "+ job.toString());
      }
      return job.getId();
    }
 catch (    Exception e) {
      s_logger.error("Unexpected exception: ",e);
      txt.rollback();
    }
  }
  return 0L;
}
