def scan_exports(target):
    util.SMlog('scanning')
    cmd = [SHOWMOUNT_BIN, '--no-headers', '-e', target]
    dom = xml.dom.minidom.Document()
    element = dom.createElement('nfs-exports')
    dom.appendChild(element)
    for val in util.pread2(cmd).split('\n'):
        if (not len(val)):
            continue
        entry = dom.createElement('Export')
        element.appendChild(entry)
        subentry = dom.createElement('Target')
        entry.appendChild(subentry)
        textnode = dom.createTextNode(target)
        subentry.appendChild(textnode)
        (path, access) = val.split()
        subentry = dom.createElement('Path')
        entry.appendChild(subentry)
        textnode = dom.createTextNode(path)
        subentry.appendChild(textnode)
        subentry = dom.createElement('Accesslist')
        entry.appendChild(subentry)
        textnode = dom.createTextNode(access)
        subentry.appendChild(textnode)
    return dom
