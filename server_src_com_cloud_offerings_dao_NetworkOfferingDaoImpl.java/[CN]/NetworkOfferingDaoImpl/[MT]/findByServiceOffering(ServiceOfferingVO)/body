{
  SearchCriteria<NetworkOfferingVO> sc=ServiceOfferingSearch.create();
  sc.setParameters("serviceoffering",offering.getId());
  NetworkOfferingVO vo=findOneBy(sc);
  if (vo != null) {
    return vo;
  }
  vo=new NetworkOfferingVO(offering);
  try {
    return persist(vo);
  }
 catch (  Exception e) {
    s_logger.debug("Got a persistence exception.  Assuming it's because service offering id is duplicate");
    vo=findOneBy(sc);
    if (vo != null) {
      return vo;
    }
    throw new CloudRuntimeException("Unable to persist network offering",e);
  }
}
