{
  ListResponse<ApiDiscoveryResponse> response=new ListResponse<ApiDiscoveryResponse>();
  List<ApiDiscoveryResponse> responseList=new ArrayList<ApiDiscoveryResponse>();
  if (s_apiAccessCheckers == null) {
    ComponentLocator locator=ComponentLocator.getCurrentLocator();
    s_apiAccessCheckers=locator.getAdapters(APIChecker.class);
  }
  if (user == null)   return null;
  if (name != null) {
    if (!s_apiNameDiscoveryResponseMap.containsKey(name))     return null;
    for (    APIChecker apiChecker : s_apiAccessCheckers) {
      try {
        apiChecker.checkAccess(user,name);
      }
 catch (      Exception ex) {
        return null;
      }
    }
    responseList.add(s_apiNameDiscoveryResponseMap.get(name));
  }
 else {
    for (    String apiName : s_apiNameDiscoveryResponseMap.keySet()) {
      boolean isAllowed=true;
      for (      APIChecker apiChecker : s_apiAccessCheckers) {
        try {
          apiChecker.checkAccess(user,apiName);
        }
 catch (        Exception ex) {
          isAllowed=false;
        }
      }
      if (isAllowed)       responseList.add(s_apiNameDiscoveryResponseMap.get(apiName));
    }
  }
  response.setResponses(responseList);
  return response;
}
