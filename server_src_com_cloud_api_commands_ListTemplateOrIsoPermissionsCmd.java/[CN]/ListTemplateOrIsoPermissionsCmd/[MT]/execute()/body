{
  List<String> accountNames=BaseCmd._mgr.listTemplatePermissions(this);
  Account account=(Account)UserContext.current().getAccount();
  boolean isAdmin=((account == null) || isAdmin(account.getType()));
  Long templateOwnerDomain=null;
  VMTemplateVO template=ApiDBUtils.findTemplateById(id);
  if (isAdmin) {
    Account templateOwner=ApiDBUtils.findAccountById(template.getAccountId());
    if (templateOwner != null) {
      templateOwnerDomain=templateOwner.getDomainId();
    }
  }
  TemplatePermissionsResponse response=new TemplatePermissionsResponse();
  response.setId(template.getId());
  response.setPublicTemplate(template.isPublicTemplate());
  if (isAdmin && (templateOwnerDomain != null)) {
    response.setDomainId(templateOwnerDomain);
  }
  response.setAccountNames(accountNames);
  response.setObjectName("templatepermission");
  response.setResponseName(getName());
  this.setResponseObject(response);
}
