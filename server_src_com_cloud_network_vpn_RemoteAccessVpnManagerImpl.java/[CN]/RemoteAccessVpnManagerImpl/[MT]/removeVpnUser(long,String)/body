{
  long callerId=UserContext.current().getCallerUserId();
  Account caller=UserContext.current().getCaller();
  VpnUserVO user=_vpnUsersDao.findByAccountAndUsername(vpnOwnerId,username);
  if (user == null) {
    throw new InvalidParameterValueException("Could not find vpn user " + username);
  }
  _accountMgr.checkAccess(caller,user);
  user.setState(State.Revoke);
  _vpnUsersDao.update(user.getId(),user);
  EventUtils.saveEvent(callerId,vpnOwnerId,EventTypes.EVENT_VPN_USER_REMOVE,"Removed a VPN user username= " + username);
  return true;
}
