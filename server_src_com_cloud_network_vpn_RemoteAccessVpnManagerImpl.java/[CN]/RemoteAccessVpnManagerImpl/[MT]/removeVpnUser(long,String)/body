{
  Account caller=UserContext.current().getCaller();
  VpnUserVO user=_vpnUsersDao.findByAccountAndUsername(vpnOwnerId,username);
  if (user == null) {
    throw new InvalidParameterValueException("Could not find vpn user " + username);
  }
  _accountMgr.checkAccess(caller,null,user);
  user.setState(State.Revoke);
  _vpnUsersDao.update(user.getId(),user);
  return true;
}
