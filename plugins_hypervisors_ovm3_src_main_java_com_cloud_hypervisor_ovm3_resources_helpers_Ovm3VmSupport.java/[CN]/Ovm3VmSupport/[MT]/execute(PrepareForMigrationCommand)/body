{
  VirtualMachineTO vm=cmd.getVirtualMachine();
  if (LOGGER.isDebugEnabled()) {
    LOGGER.debug("Preparing host for migrating " + vm.getName());
  }
  NicTO[] nics=vm.getNics();
  try {
    for (    NicTO nic : nics) {
      network.getNetwork(nic);
    }
    hypervisor.setVmState(vm.getName(),State.Migrating);
    LOGGER.debug("VM " + vm.getName() + " is in Migrating state");
    return new PrepareForMigrationAnswer(cmd);
  }
 catch (  Ovm3ResourceException e) {
    LOGGER.error("Catch Exception " + e.getClass().getName() + " prepare for migration failed due to: "+ e.getMessage());
    return new PrepareForMigrationAnswer(cmd,e);
  }
}
