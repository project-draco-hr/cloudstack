{
  try {
    final S3TO s3=s3Mgr.getS3TO();
    if (s3 == null) {
      LOGGER.warn("S3 sync skipped because no S3 instance is configured.");
      return;
    }
    final List<VMTemplateVO> candidateTemplates=vmTemplateDao.findTemplatesToSyncToS3();
    if (candidateTemplates.isEmpty()) {
      LOGGER.debug("All templates are synced with S3.");
      return;
    }
    for (    VMTemplateVO candidateTemplate : candidateTemplates) {
      if (LOGGER.isInfoEnabled()) {
        LOGGER.info(format("Uploading template %1$s (id: %2$s) to S3.",candidateTemplate.getName(),candidateTemplate.getId()));
      }
      s3Mgr.uploadTemplateToS3FromSecondaryStorage(candidateTemplate);
    }
    LOGGER.debug("Completed S3 template sync task.");
  }
 catch (  Exception e) {
    LOGGER.warn("S3 Sync Task ignored exception, and will continue to execute.",e);
  }
}
