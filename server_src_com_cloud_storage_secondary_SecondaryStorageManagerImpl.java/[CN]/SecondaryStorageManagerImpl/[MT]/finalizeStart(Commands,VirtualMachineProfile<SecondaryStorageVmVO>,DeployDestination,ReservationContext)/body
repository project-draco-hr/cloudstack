{
  CheckSshAnswer answer=(CheckSshAnswer)cmds.getAnswer("checkSsh");
  if (!answer.getResult()) {
    s_logger.warn("Unable to ssh to the VM: " + answer.getDetails());
    return false;
  }
  SecondaryStorageVmVO secVm=profile.getVirtualMachine();
  List<NicVO> nics=_nicDao.listBy(secVm.getId());
  for (  NicVO nic : nics) {
    NetworkVO network=_networkDao.findById(nic.getNetworkId());
    if (network.getTrafficType() == TrafficType.Public) {
      secVm.setPublicIpAddress(nic.getIp4Address());
      secVm.setPublicNetmask(nic.getNetmask());
      secVm.setPublicMacAddress(nic.getMacAddress());
    }
 else     if (network.getTrafficType() == TrafficType.Control) {
      secVm.setGuestIpAddress(nic.getIp4Address());
      secVm.setGuestNetmask(nic.getNetmask());
      secVm.setGuestMacAddress(nic.getMacAddress());
    }
 else     if (network.getTrafficType() == TrafficType.Management) {
      secVm.setPrivateIpAddress(nic.getIp4Address());
      secVm.setPrivateNetmask(nic.getNetmask());
      secVm.setPrivateMacAddress(nic.getMacAddress());
    }
  }
  return true;
}
