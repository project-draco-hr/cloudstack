{
  Transaction txn=Transaction.currentTxn();
  try {
    txn.start();
    _volsDao.deleteVolumesByInstance(vmId);
    SecondaryStorageVmVO secStorageVm=_secStorageVmDao.findById(vmId);
    if (secStorageVm != null) {
      if (secStorageVm.getPublicIpAddress() != null) {
        freePublicIpAddress(secStorageVm.getPublicIpAddress(),secStorageVm.getDataCenterId(),secStorageVm.getPodId());
      }
      _secStorageVmDao.remove(vmId);
      EventUtils.saveEvent(User.UID_SYSTEM,Account.ACCOUNT_ID_SYSTEM,EventTypes.EVENT_SSVM_DESTROY,"Secondary Storage Vm destroyed - " + secStorageVm.getName());
    }
    txn.commit();
    return true;
  }
 catch (  Exception e) {
    s_logger.error("Caught this error: ",e);
    txn.rollback();
    return false;
  }
 finally {
    s_logger.debug("secondary storage vm vm is destroyed from DB : " + vmId);
  }
}
