{
  AsyncJobExecutor asyncExecutor=BaseAsyncJobExecutor.getCurrentExecutor();
  if (asyncExecutor != null) {
    AsyncJobVO job=asyncExecutor.getJob();
    if (s_logger.isInfoEnabled()) {
      s_logger.info("Stop secondary storage vm " + secStorageVmId + ", update async job-"+ job.getId());
    }
    _asyncMgr.updateAsyncJobAttachment(job.getId(),"secStorageVm",secStorageVmId);
  }
  SecondaryStorageVmVO secStorageVm=_secStorageVmDao.findById(secStorageVmId);
  if (secStorageVm == null) {
    String msg="Stopping secondary storage vm failed: secondary storage vm " + secStorageVmId + " no longer exists";
    if (s_logger.isDebugEnabled()) {
      s_logger.debug(msg);
    }
    return false;
  }
  try {
    return stop(secStorageVm);
  }
 catch (  AgentUnavailableException e) {
    if (s_logger.isDebugEnabled()) {
      s_logger.debug("Stopping secondary storage vm " + secStorageVm.getName() + " faled : exception "+ e.toString());
    }
    return false;
  }
}
