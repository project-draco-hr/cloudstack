{
  if (cmdObj instanceof BaseAsyncCmd) {
    Long objectId=null;
    if (cmdObj instanceof BaseAsyncCreateCmd) {
      objectId=_dispatcher.dispatchCreateCmd((BaseAsyncCreateCmd)cmdObj,params);
    }
    BaseAsyncCmd asyncCmd=(BaseAsyncCmd)cmdObj;
    Gson gson=GsonHelper.getBuilder().create();
    AsyncJobVO job=new AsyncJobVO();
    job.setUserId(UserContext.current().getUserId());
    job.setCmd(cmdObj.getClass().getName());
    job.setCmdInfo(gson.toJson(params));
    long jobId=_asyncMgr.submitAsyncJob(job);
    if (objectId != null) {
      return ((BaseAsyncCreateCmd)asyncCmd).getResponse(jobId,objectId);
    }
    return asyncCmd.getResponse(jobId);
  }
 else {
    _dispatcher.dispatch(cmdObj,params);
    return cmdObj.getResponse();
  }
}
