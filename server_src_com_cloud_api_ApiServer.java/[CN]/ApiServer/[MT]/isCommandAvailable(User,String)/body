{
  if (user == null) {
    return false;
  }
  Account account=_accountMgr.getAccount(user.getAccountId());
  if (account == null) {
    return false;
  }
  RoleType roleType=RoleType.Unknown;
  short accountType=account.getType();
switch (accountType) {
case Account.ACCOUNT_TYPE_ADMIN:
    roleType=RoleType.Admin;
  break;
case Account.ACCOUNT_TYPE_DOMAIN_ADMIN:
roleType=RoleType.DomainAdmin;
break;
case Account.ACCOUNT_TYPE_RESOURCE_DOMAIN_ADMIN:
roleType=RoleType.ResourceAdmin;
break;
case Account.ACCOUNT_TYPE_NORMAL:
roleType=RoleType.User;
break;
default :
return false;
}
for (APIAccessChecker apiChecker : _apiAccessCheckers) {
if (!apiChecker.canAccessAPI(roleType,commandName)) return false;
}
return true;
}
