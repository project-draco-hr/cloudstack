{
  String responseName=null;
  String cmdClassName=null;
  String responseText=null;
  try {
    if (errorCode == BaseCmd.UNSUPPORTED_ACTION_ERROR || apiCommandParams == null || apiCommandParams.isEmpty()) {
      responseName="errorresponse";
    }
 else {
      String cmdName=((String[])apiCommandParams.get("command"))[0];
      cmdClassName=_apiCommands.getProperty(cmdName);
      if (cmdClassName != null) {
        Class<?> claz=Class.forName(cmdClassName);
        responseName=((BaseCmd)claz.newInstance()).getCommandName();
      }
 else {
        responseName="errorresponse";
      }
    }
    ExceptionResponse apiResponse=new ExceptionResponse();
    apiResponse.setErrorCode(errorCode);
    apiResponse.setErrorText(errorText);
    apiResponse.setResponseName(responseName);
    responseText=ApiResponseSerializer.toSerializedString(apiResponse,responseType);
  }
 catch (  Exception e) {
    s_logger.error("Exception responding to http request",e);
  }
  return responseText;
}
