{
  if (signingKey == null) {
    return urlEncodedString;
  }
  String url=urlEncodedString + "&SigAlg=" + URLEncoder.encode(SignatureConstants.ALGO_ID_SIGNATURE_RSA_SHA1,HttpUtils.UTF_8);
  Signature signature=Signature.getInstance("SHA1withRSA");
  signature.initSign(signingKey);
  signature.update(url.getBytes());
  String signatureString=Base64.encodeBytes(signature.sign(),Base64.DONT_BREAK_LINES);
  if (signatureString != null) {
    return url + "&Signature=" + URLEncoder.encode(signatureString,HttpUtils.UTF_8);
  }
  return url;
}
