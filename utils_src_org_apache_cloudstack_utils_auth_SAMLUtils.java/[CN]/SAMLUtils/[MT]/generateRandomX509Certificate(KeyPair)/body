{
  Date validityBeginDate=new Date(System.currentTimeMillis() - 24 * 60 * 60* 1000);
  Date validityEndDate=new Date(System.currentTimeMillis() + 3 * 365 * 24* 60* 60* 1000);
  X500Principal dnName=new X500Principal("CN=ApacheCloudStack");
  X509V1CertificateGenerator certGen=new X509V1CertificateGenerator();
  certGen.setSerialNumber(BigInteger.valueOf(System.currentTimeMillis()));
  certGen.setSubjectDN(dnName);
  certGen.setIssuerDN(dnName);
  certGen.setNotBefore(validityBeginDate);
  certGen.setNotAfter(validityEndDate);
  certGen.setPublicKey(keyPair.getPublic());
  certGen.setSignatureAlgorithm("SHA256WithRSAEncryption");
  return certGen.generate(keyPair.getPrivate(),"BC");
}
