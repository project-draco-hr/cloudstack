{
  Date validityBeginDate=new Date(System.currentTimeMillis() - 24 * 60 * 60* 1000);
  Date validityEndDate=new Date(System.currentTimeMillis() + 2 * 365 * 24* 60* 60* 1000);
  Security.addProvider(new BouncyCastleProvider());
  KeyPairGenerator keyPairGenerator=KeyPairGenerator.getInstance("RSA","BC");
  keyPairGenerator.initialize(1024,new SecureRandom());
  KeyPair keyPair=keyPairGenerator.generateKeyPair();
  X500Principal dnName=new X500Principal("CN=John Doe");
  X509V1CertificateGenerator certGen=new X509V1CertificateGenerator();
  certGen.setSerialNumber(BigInteger.valueOf(System.currentTimeMillis()));
  certGen.setSubjectDN(dnName);
  certGen.setIssuerDN(dnName);
  certGen.setNotBefore(validityBeginDate);
  certGen.setNotAfter(validityEndDate);
  certGen.setPublicKey(keyPair.getPublic());
  certGen.setSignatureAlgorithm("SHA256WithRSAEncryption");
  return certGen.generate(keyPair.getPrivate(),"BC");
}
