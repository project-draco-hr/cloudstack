{
  if (publicNetwork.getTrafficType() != TrafficType.Public) {
    s_logger.warn("Network " + publicNetwork + " is not of type "+ TrafficType.Public);
    return false;
  }
  boolean result=true;
  IPAddressVO ipVO=_ipAddressDao.findById(ipAddress.getId());
  _networkMgr.markIpAsUnavailable(ipVO.getId());
  PublicIp publicIp=new PublicIp(ipVO,_vlanDao.findById(ipVO.getVlanId()),NetUtils.createSequenceBasedMacAddress(ipVO.getMacAddress()));
  result=associtePublicIpInVpc(publicNetwork,router,false,publicIp);
  if (!result) {
    s_logger.warn("Failed to disassociate public ip " + ipAddress + " from router "+ router);
    return false;
  }
  URI broadcastUri=BroadcastDomainType.Vlan.toUri(ipAddress.getVlanTag());
  if (_itMgr.removeVmFromNetwork(router,publicNetwork,broadcastUri)) {
    s_logger.debug("Successfully removed router " + router + " from vlan "+ ipAddress.getVlanTag()+ " of public network "+ publicNetwork);
    return true;
  }
 else {
    s_logger.warn("Failed to remove router " + router + " from vlan "+ ipAddress.getVlanTag()+ " of public network "+ publicNetwork);
    return false;
  }
}
