{
  Vpc vpc=_vpcDao.findById(vpn.getVpcId());
  if (router.getState() != State.Running) {
    s_logger.warn("Failed to add/remove Remote Access VPN users: router not in running state");
    throw new ResourceUnavailableException("Failed to add/remove Remote Access VPN users: router not in running state: " + router.getState(),DataCenter.class,vpc.getZoneId());
  }
  Commands cmds=new Commands(Command.OnError.Continue);
  createApplyVpnUsersCommand(users,router,cmds);
  boolean agentResult=_nwHelper.sendCommandsToRouter(router,cmds);
  String[] result=new String[users.size()];
  for (int i=0; i < result.length; i++) {
    if (agentResult) {
      result[i]=null;
    }
 else {
      result[i]=String.valueOf(agentResult);
    }
  }
  return result;
}
