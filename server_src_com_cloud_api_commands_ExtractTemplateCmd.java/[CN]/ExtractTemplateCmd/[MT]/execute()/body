{
  try {
    Long uploadId=_templateMgr.extract(this);
    if (uploadId != null) {
      UploadVO uploadInfo=ApiDBUtils.findUploadById(uploadId);
      ExtractResponse response=new ExtractResponse();
      response.setResponseName(getName());
      response.setObjectName("template");
      response.setId(id);
      response.setName(ApiDBUtils.findTemplateById(id).getName());
      response.setZoneId(zoneId);
      response.setZoneName(ApiDBUtils.findZoneById(zoneId).getName());
      response.setMode(mode);
      response.setUploadId(uploadId);
      response.setState(uploadInfo.getUploadState().toString());
      response.setAccountId(getAccountId());
      response.setUrl(uploadInfo.getUploadUrl().replaceAll("/","%2F"));
      this.setResponseObject(response);
    }
 else {
      throw new ServerApiException(BaseCmd.INTERNAL_ERROR,"Failed to extract template");
    }
  }
 catch (  InternalErrorException ex) {
    throw new ServerApiException(BaseCmd.INTERNAL_ERROR,ex.getMessage());
  }
}
