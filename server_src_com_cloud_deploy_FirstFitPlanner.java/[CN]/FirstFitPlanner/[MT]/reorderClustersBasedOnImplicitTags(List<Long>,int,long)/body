{
  final HashMap<Long,Long> UniqueTagsInClusterMap=new HashMap<Long,Long>();
  for (  Long clusterId : clusterList) {
    List<Long> hostList=_capacityDao.listHostsWithEnoughCapacity(requiredCpu,requiredRam,clusterId,Host.Type.Routing.toString());
    UniqueTagsInClusterMap.put(clusterId,new Long(_hostTagsDao.getDistinctImplicitHostTags(hostList,_implicitHostTags).size()));
  }
  Collections.sort(clusterList,new Comparator<Long>(){
    @Override public int compare(    Long o1,    Long o2){
      Long t1=UniqueTagsInClusterMap.get(o1);
      Long t2=UniqueTagsInClusterMap.get(o2);
      return t1.compareTo(t2);
    }
  }
);
}
