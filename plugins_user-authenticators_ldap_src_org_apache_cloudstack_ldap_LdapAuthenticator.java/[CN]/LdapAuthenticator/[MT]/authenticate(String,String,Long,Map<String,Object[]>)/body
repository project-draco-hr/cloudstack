{
  final UserAccount user=_userAccountDao.getUserAccount(username,domainId);
  if (user == null) {
    s_logger.debug("Unable to find user with " + username + " in domain "+ domainId);
    return false;
  }
 else   if (_ldapManager.isLdapEnabled()) {
    return _ldapManager.canAuthenticate(username,password);
  }
 else {
    return false;
  }
}
