{
  final String vmName="Test";
  final String vmMac="00:00:00:00";
  final String secondaryIp="172.168.25.25";
  final boolean action=true;
  final NetworkRulesVmSecondaryIpCommand command=new NetworkRulesVmSecondaryIpCommand(vmName,vmMac,secondaryIp,action);
  final LibvirtConnectionWrapper libvirtConnectionWrapper=Mockito.mock(LibvirtConnectionWrapper.class);
  final Connect conn=Mockito.mock(Connect.class);
  when(libvirtComputingResource.getLibvirtConnectionWrapper()).thenReturn(libvirtConnectionWrapper);
  try {
    when(libvirtConnectionWrapper.getConnectionByVmName(command.getVmName())).thenReturn(conn);
  }
 catch (  final LibvirtException e) {
    fail(e.getMessage());
  }
  when(libvirtComputingResource.configureNetworkRulesVMSecondaryIP(conn,command.getVmName(),command.getVmSecIp(),command.getAction())).thenReturn(true);
  final LibvirtRequestWrapper wrapper=LibvirtRequestWrapper.getInstance();
  assertNotNull(wrapper);
  final Answer answer=wrapper.execute(command,libvirtComputingResource);
  assertTrue(answer.getResult());
  try {
    verify(libvirtConnectionWrapper,times(1)).getConnectionByVmName(command.getVmName());
  }
 catch (  final LibvirtException e) {
    fail(e.getMessage());
  }
  verify(libvirtComputingResource,times(1)).getLibvirtConnectionWrapper();
  verify(libvirtComputingResource,times(1)).configureNetworkRulesVMSecondaryIP(conn,command.getVmName(),command.getVmSecIp(),command.getAction());
}
