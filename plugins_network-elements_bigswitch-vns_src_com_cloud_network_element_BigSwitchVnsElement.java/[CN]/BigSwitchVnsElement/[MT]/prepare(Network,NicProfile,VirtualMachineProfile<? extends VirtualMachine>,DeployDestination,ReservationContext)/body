{
  if (!canHandle(network,Service.Connectivity)) {
    return false;
  }
  if (network.getBroadcastUri() == null) {
    s_logger.error("Nic has no broadcast Uri with the LSwitch Uuid");
    return false;
  }
  String mac=nic.getMacAddress();
  String tenantId=context.getDomain().getName() + "-" + context.getAccount().getAccountId();
  List<BigSwitchVnsDeviceVO> devices=_bigswitchVnsDao.listByPhysicalNetwork(network.getPhysicalNetworkId());
  if (devices.isEmpty()) {
    s_logger.error("No BigSwitch Controller on physical network " + network.getPhysicalNetworkId());
    return false;
  }
  BigSwitchVnsDeviceVO bigswitchVnsDevice=devices.get(0);
  HostVO bigswitchVnsHost=_hostDao.findById(bigswitchVnsDevice.getHostId());
  CreateVnsPortCommand cmd=new CreateVnsPortCommand(network.getBroadcastUri().getSchemeSpecificPart(),vm.getUuid(),tenantId,nic.getName(),mac);
  CreateVnsPortAnswer answer=(CreateVnsPortAnswer)_agentMgr.easySend(bigswitchVnsHost.getId(),cmd);
  if (answer == null || !answer.getResult()) {
    s_logger.error("CreatePortCommand failed");
    return false;
  }
  return true;
}
