{
  DomainRouterVO vm=routerDao.findById(router.getId());
  if (logger.isDebugEnabled()) {
    logger.debug("Router " + router.getInstanceName() + " is not fully up yet, we will wait");
  }
  while (vm.getState() == State.Starting) {
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
    }
    vm=routerDao.findById(router.getId());
  }
  if (vm.getState() == State.Running) {
    if (logger.isDebugEnabled()) {
      logger.debug("Router " + router.getInstanceName() + " is now fully up");
    }
    return router;
  }
  logger.warn("Router " + router.getInstanceName() + " failed to start. current state: "+ vm.getState());
  return null;
}
