def create_virtual_machine(self, network_id=None, ip_address=None):
    virtual_machine = VirtualMachine.create(self.apiclient, self.services['virtual_machine'], networkids=network_id, serviceofferingid=self.service_offering.id, accountid=self.account.name, domainid=self.domain.id, ipaddress=ip_address)
    self.debug(('Virtual Machine is created: ' + virtual_machine.id))
    self.cleanup.append(virtual_machine)
    return virtual_machine
