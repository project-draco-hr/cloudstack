{
  String secondaryStorageUrl=cmd.getSecondaryStorageUrl();
  Long accountId=cmd.getAccountId();
  Long volumeId=cmd.getVolumeId();
  String name=cmd.getSnapshotUuid();
  try {
    SwiftTO swift=cmd.getSwift();
    S3TO s3=cmd.getS3();
    if (swift == null) {
      final String result=deleteSnapshotBackupFromLocalFileSystem(secondaryStorageUrl,accountId,volumeId,name,cmd.isAll());
      if (result != null) {
        s_logger.warn(result);
        return new Answer(cmd,false,result);
      }
    }
 else     if (s3 != null) {
      final String result=deleteSnapshotBackupfromS3(s3,secondaryStorageUrl,accountId,volumeId,name,cmd.isAll());
      if (result != null) {
        s_logger.warn(result);
        return new Answer(cmd,false,result);
      }
    }
 else {
      String filename;
      if (cmd.isAll()) {
        filename="";
      }
 else {
        filename=name;
      }
      String result=swiftDelete(swift,"V-" + volumeId.toString(),filename);
      if (result != null) {
        String errMsg="failed to delete snapshot " + filename + " , err="+ result;
        s_logger.warn(errMsg);
        return new Answer(cmd,false,errMsg);
      }
    }
    return new Answer(cmd,true,"success");
  }
 catch (  Exception e) {
    String errMsg=cmd + " Command failed due to " + e.toString();
    s_logger.warn(errMsg,e);
    return new Answer(cmd,false,errMsg);
  }
}
