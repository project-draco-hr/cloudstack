{
  String ext=null;
  int extensionPos=filePath.lastIndexOf('.');
  int lastSeparator=Math.max(filePath.lastIndexOf('/'),filePath.lastIndexOf('\\'));
  int i=lastSeparator > extensionPos ? -1 : extensionPos;
  if (i > 0) {
    ext=filePath.substring(i + 1);
  }
  if (ext != null) {
    if (ext.equalsIgnoreCase("vhd")) {
      return ImageFormat.VHD;
    }
 else     if (ext.equalsIgnoreCase("vhdx")) {
      return ImageFormat.VHDX;
    }
 else     if (ext.equalsIgnoreCase("qcow2")) {
      return ImageFormat.QCOW2;
    }
 else     if (ext.equalsIgnoreCase("ova")) {
      return ImageFormat.OVA;
    }
 else     if (ext.equalsIgnoreCase("tar")) {
      return ImageFormat.TAR;
    }
 else     if (ext.equalsIgnoreCase("img") || ext.equalsIgnoreCase("raw")) {
      return ImageFormat.RAW;
    }
 else     if (ext.equalsIgnoreCase("vmdk")) {
      return ImageFormat.VMDK;
    }
 else     if (ext.equalsIgnoreCase("vdi")) {
      return ImageFormat.VDI;
    }
  }
  return null;
}
