{
  DataStoreTO dstore=cmd.getDataStore();
  if (dstore instanceof NfsTO) {
    NfsTO nfs=(NfsTO)dstore;
    String relativeSnapshotPath=cmd.getSnapshotPath();
    String parent=getRootDir(nfs.getUrl());
    if (relativeSnapshotPath.startsWith(File.separator)) {
      relativeSnapshotPath=relativeSnapshotPath.substring(1);
    }
    if (!parent.endsWith(File.separator)) {
      parent+=File.separator;
    }
    String absoluteSnapshotPath=parent + relativeSnapshotPath;
    File snapshot=new File(absoluteSnapshotPath);
    String details=null;
    if (!snapshot.exists()) {
      details="snapshot file " + snapshot.getName() + " doesn't exist";
      s_logger.debug(details);
      return new Answer(cmd,true,details);
    }
    if (!snapshot.delete()) {
      return new Answer(cmd,false,"Unable to delete file " + snapshot.getName() + " under install path "+ relativeSnapshotPath);
    }
    return new Answer(cmd,true,null);
  }
 else   if (dstore instanceof S3TO) {
    final S3TO s3=(S3TO)dstore;
    final String path=cmd.getSnapshotPath();
    final String bucket=s3.getBucketName();
    try {
      S3Utils.deleteObject(s3,bucket,path);
      return new Answer(cmd,true,String.format("Deleted snapshot %1%s from bucket %2$s.",path,bucket));
    }
 catch (    Exception e) {
      final String errorMessage=String.format("Failed to delete snapshot %1$s from bucket %2$s due to the following error: %3$s",path,bucket,e.getMessage());
      s_logger.error(errorMessage,e);
      return new Answer(cmd,false,errorMessage);
    }
  }
 else   if (dstore instanceof SwiftTO) {
    String path=cmd.getSnapshotPath();
    String filename=StringUtils.substringAfterLast(path,"/");
    String volumeId=StringUtils.substringAfterLast(StringUtils.substringBeforeLast(path,"/"),"/");
    String result=swiftDelete((SwiftTO)dstore,"V-" + volumeId,filename);
    if (result != null) {
      String errMsg="failed to delete snapshot " + filename + " , err="+ result;
      s_logger.warn(errMsg);
      return new Answer(cmd,false,errMsg);
    }
    return new Answer(cmd,true,"Deleted snapshot " + path + " from swift");
  }
 else {
    return new Answer(cmd,false,"Unsupported image data store: " + dstore);
  }
}
