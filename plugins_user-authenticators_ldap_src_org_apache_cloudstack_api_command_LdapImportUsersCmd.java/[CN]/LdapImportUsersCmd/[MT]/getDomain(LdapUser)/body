{
  String csDomainName=null;
  if (StringUtils.isNotBlank(domainName)) {
    csDomainName=domainName;
  }
 else {
    if (StringUtils.isNotBlank(groupName)) {
      csDomainName=groupName;
    }
 else     if (StringUtils.isNotBlank(user.getDomain())) {
      csDomainName=user.getDomain();
    }
    csDomainName=StringUtils.substring(csDomainName.replaceAll("\\W",""),0,190);
  }
  Domain domain;
  if (StringUtils.isNotBlank(csDomainName)) {
    domain=_domainService.getDomainByName(csDomainName,Domain.ROOT_DOMAIN);
    if (domain == null) {
      domain=_domainService.createDomain(csDomainName,Domain.ROOT_DOMAIN,csDomainName,UUID.randomUUID().toString());
    }
  }
 else {
    domain=_domainService.getDomain(Domain.ROOT_DOMAIN);
  }
  return domain;
}
