{
  StoragePoolVO spool=new StoragePoolVO();
  long poolId=_storagePoolDao.getNextInSequence(Long.class,"id");
  spool.setId(poolId);
  spool.setDataCenterId(zoneId);
  spool.setPodId(podId);
  spool.setName(poolName);
  spool.setClusterId(clusterId);
  spool.setStorageProvider(storageProviderName);
  spool.setStorageType(storageType);
  spool.setStatus(StoragePoolStatus.Creating);
  spool=_storagePoolDao.persist(spool);
  StorageProvider sp=findStorageProvider(storageProviderName);
  DataStore ds=sp.addDataStore((StoragePool)spool,URI,params);
  DataStoreLifeCycle dslc=ds.getLifeCycle();
  try {
    dslc.add();
  }
 catch (  CloudRuntimeException e) {
    _storagePoolDao.remove(spool.getId());
    throw e;
  }
  spool.setPath(ds.getURI());
  spool.setUuid(ds.getUUID());
  spool.setStatus(StoragePoolStatus.Up);
  _storagePoolDao.update(spool.getId(),spool);
  spool=_storagePoolDao.findById(spool.getId());
  return spool;
}
