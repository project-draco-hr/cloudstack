{
  String localStorageUuid=null;
  Map<SR,SR.Record> map=SR.getAllRecords(conn);
  for (  Map.Entry<SR,SR.Record> entry : map.entrySet()) {
    SR.Record srRec=entry.getValue();
    if (srRec.nameLabel.equalsIgnoreCase("local-storage")) {
      localStorageUuid=srRec.uuid;
      break;
    }
  }
  if (localStorageUuid != null) {
    String result=callHostPlugin(conn,"vmops","createISOVHD","uuid",localStorageUuid);
    if (result == null || result.equalsIgnoreCase("Failed")) {
      throw new CloudRuntimeException("can not create systemvm vdi");
    }
    Set<VDI> vdis=VDI.getByNameLabel(conn,"systemvm-vdi");
    if (vdis.size() != 1) {
      throw new CloudRuntimeException("can not find systemvmiso");
    }
    VDI systemvmVDI=vdis.iterator().next();
    VBD.Record cdromVBDR=new VBD.Record();
    cdromVBDR.VM=vm;
    cdromVBDR.empty=false;
    cdromVBDR.bootable=false;
    cdromVBDR.userdevice="3";
    cdromVBDR.mode=Types.VbdMode.RO;
    cdromVBDR.type=Types.VbdType.DISK;
    cdromVBDR.VDI=systemvmVDI;
    VBD cdromVBD=VBD.create(conn,cdromVBDR);
    return cdromVBD;
  }
 else {
    throw new CloudRuntimeException("can not find local sr");
  }
}
