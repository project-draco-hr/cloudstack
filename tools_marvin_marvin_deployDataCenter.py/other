'Deploy datacenters according to a json configuration file'
import configGenerator
from cloudstackException import InvalidParameterException, GetDetailExceptionInfo
import logging
from cloudstackAPI import *
from os import path
from time import sleep
from optparse import OptionParser
from marvin.codes import FAILED, SUCCESS
from sys import exit
if (__name__ == '__main__'):
    '\n    @Desc : This facility is mainly to deploy\n            DataCenter by using this module as script\n            by using the input provided configuration.\n    '
    parser = OptionParser()
    parser.add_option('-i', '--input', action='store', default='./datacenterCfg', dest='input', help='the path                       where the json config file generated, by default is                       ./datacenterCfg')
    (options, args) = parser.parse_args()
    if options.input:
        '\n        Imports the Modules Required\n        '
        from marvin.marvinLog import MarvinLog
        from marvin.cloudstackTestClient import CSTestClient
        '\n        Step1 : Parse and Create the config from input config provided\n        '
        cfg = configGenerator.getSetupConfig(options.input)
        log_obj = MarvinLog('CSLog')
        log_check = False
        if (log_obj is not None):
            log_check = True
            ret = log_obj.createLogs('DeployDataCenter', cfg.logger)
            if (ret != FAILED):
                log_folder_path = log_obj.getLogFolderPath()
                tc_run_logger = log_obj.getLogger()
        if (log_check is False):
            print '\nLog Creation Failed. Please Check'
        else:
            print ('\nAll Logs will be available under %s' % str(log_folder_path))
        '\n        Step2: Create the Test Client\n        '
        obj_tc_client = CSTestClient(cfg.mgtSvr[0], cfg.dbSvr, logger=tc_run_logger)
        if ((obj_tc_client is not None) and (obj_tc_client.createTestClient() != FAILED)):
            deploy = DeployDataCenters(obj_tc_client, cfg, tc_run_logger)
            if (deploy.deploy() == FAILED):
                print '\nDeploy DC Failed'
                exit(1)
        else:
            print '\nTestClient Creation Failed. Please Check'
            exit(1)
    else:
        print '\n Please Specify a Valid Input Configuration File'
    '\n    create = createStoragePool.createStoragePoolCmd()\n    create.clusterid = 1\n    create.podid = 2\n    create.name = "fdffdf"\n    create.url = "nfs://jfkdjf/fdkjfkd"\n    create.zoneid = 2\n\n    deploy = deployDataCenters("./datacenterCfg")\n    deploy.loadCfg()\n    deploy.apiClient.createStoragePool(create)\n    '
