{
  try {
    EC2DescribeKeyPairsResponse keyPairSet=new EC2DescribeKeyPairsResponse();
    List<CloudStackKeyPair> keyPairs=getApi().listSSHKeyPairs(null,null,null);
    if (keyPairs != null && keyPairs.size() > 0) {
      for (      CloudStackKeyPair keyPair : keyPairs) {
        boolean matched=false;
        if (keyNames.length > 0) {
          for (          String keyName : keyNames) {
            if (keyName.equalsIgnoreCase(keyPair.getName())) {
              matched=true;
              break;
            }
          }
        }
 else         matched=true;
        if (!matched)         continue;
        EC2SSHKeyPair ec2KeyPair=new EC2SSHKeyPair();
        ec2KeyPair.setFingerprint(keyPair.getFingerprint());
        ec2KeyPair.setKeyName(keyPair.getName());
        ec2KeyPair.setPrivateKey(keyPair.getPrivatekey());
        keyPairSet.addKeyPair(ec2KeyPair);
      }
    }
    return keyPairSet;
  }
 catch (  Exception e) {
    logger.error("List Keypairs - ",e);
    throw new EC2ServiceException(ServerError.InternalError,e.getMessage());
  }
}
