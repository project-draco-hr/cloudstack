{
  try {
    EC2DescribeSnapshotsResponse snapshotSet=new EC2DescribeSnapshotsResponse();
    List<CloudStackSnapshot> snapshots=getApi().listSnapshots(null,null,null,null,null,null,null,null,null,resourceTagSet);
    if (snapshots != null && snapshots.size() > 0) {
      for (      CloudStackSnapshot snapshot : snapshots) {
        boolean matched=false;
        if (snapshotIds.length > 0) {
          for (          String snapshotId : snapshotIds) {
            if (snapshot.getId().equalsIgnoreCase(snapshotId)) {
              matched=true;
              break;
            }
          }
        }
 else         matched=true;
        if (!matched)         continue;
        EC2Snapshot ec2Snapshot=new EC2Snapshot();
        ec2Snapshot.setId(snapshot.getId());
        ec2Snapshot.setName(snapshot.getName());
        ec2Snapshot.setVolumeId(snapshot.getVolumeId());
        ec2Snapshot.setType(snapshot.getSnapshotType());
        ec2Snapshot.setState(snapshot.getState());
        ec2Snapshot.setCreated(snapshot.getCreated());
        ec2Snapshot.setAccountName(snapshot.getAccountName());
        ec2Snapshot.setDomainId(snapshot.getDomainId());
        List<CloudStackKeyValue> resourceTags=snapshot.getTags();
        for (        CloudStackKeyValue resourceTag : resourceTags) {
          EC2TagKeyValue param=new EC2TagKeyValue();
          param.setKey(resourceTag.getKey());
          if (resourceTag.getValue() != null)           param.setValue(resourceTag.getValue());
          ec2Snapshot.addResourceTag(param);
        }
        snapshotSet.addSnapshot(ec2Snapshot);
      }
    }
    return snapshotSet;
  }
 catch (  Exception e) {
    logger.error("List Snapshots - ",e);
    throw new EC2ServiceException(ServerError.InternalError,e.getMessage());
  }
}
