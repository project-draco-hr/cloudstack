{
  try {
    EC2DescribeTagsResponse tagResponse=new EC2DescribeTagsResponse();
    List<CloudStackResourceTag> resourceTagList=getApi().listTags(null,null,null,true,null);
    List<EC2ResourceTag> tagList=new ArrayList<EC2ResourceTag>();
    if (resourceTagList != null && resourceTagList.size() > 0) {
      for (      CloudStackResourceTag resourceTag : resourceTagList) {
        EC2ResourceTag tag=new EC2ResourceTag();
        tag.setResourceId(resourceTag.getResourceId());
        tag.setResourceType(mapToAmazonResourceType(resourceTag.getResourceType()));
        tag.setKey(resourceTag.getKey());
        if (resourceTag.getValue() != null)         tag.setValue(resourceTag.getValue());
        tagResponse.addTags(tag);
      }
    }
    EC2TagsFilterSet tfs=request.getFilterSet();
    if (tfs == null)     return tagResponse;
 else     return tfs.evaluate(tagResponse);
  }
 catch (  Exception e) {
    logger.error("EC2 DescribeTags - ",e);
    throw new EC2ServiceException(ServerError.InternalError,e.getMessage());
  }
}
