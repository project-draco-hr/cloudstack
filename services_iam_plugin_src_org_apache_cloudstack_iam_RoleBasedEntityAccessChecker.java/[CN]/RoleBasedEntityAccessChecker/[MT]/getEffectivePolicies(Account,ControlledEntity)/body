{
  List<AclPolicy> policies=_iamSrv.listAclPolicies(caller.getId());
  if (caller.getId() == entity.getAccountId()) {
    policies.add(_iamSrv.getResourceOwnerPolicy());
  }
  List<AclGroup> groups=_iamSrv.listAclGroups(caller.getId());
  for (  AclGroup group : groups) {
    List<AclGroup> parentGroups=_iamSrv.listParentAclGroups(group.getId());
    for (    AclGroup parentGroup : parentGroups) {
      policies.addAll(_iamSrv.listRecursiveAclPoliciesByGroup(parentGroup.getId()));
    }
  }
  return policies;
}
