{
  long entityId=cmd.getEntityId();
  if (uploadEntityStateMap.containsKey(entityId)) {
    UploadEntity uploadEntity=uploadEntityStateMap.get(entityId);
    if (uploadEntity.getUploadState() == UploadEntity.Status.ERROR) {
      uploadEntityStateMap.remove(uploadEntity);
      return new UploadStatusAnswer(cmd,UploadStatus.ERROR,uploadEntity.getErrorMessage());
    }
 else     if (uploadEntity.getUploadState() == UploadEntity.Status.COMPLETED) {
      uploadEntityStateMap.remove(uploadEntity);
      return new UploadStatusAnswer(cmd,UploadStatus.COMPLETED);
    }
 else     if (uploadEntity.getUploadState() == UploadEntity.Status.IN_PROGRESS) {
      return new UploadStatusAnswer(cmd,UploadStatus.IN_PROGRESS);
    }
  }
  return new UploadStatusAnswer(cmd,UploadStatus.UNKNOWN);
}
