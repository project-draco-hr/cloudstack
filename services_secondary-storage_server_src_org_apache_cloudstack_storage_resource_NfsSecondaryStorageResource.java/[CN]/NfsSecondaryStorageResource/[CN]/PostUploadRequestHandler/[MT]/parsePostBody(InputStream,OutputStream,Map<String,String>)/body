{
  BufferedReader reader=new BufferedReader(new InputStreamReader(input));
  String currentLine=reader.readLine();
  String boundary=currentLine;
  while (reader.ready()) {
    currentLine=reader.readLine();
    if (currentLine.contains("Content-Disposition: form-data;")) {
      String paramName=currentLine;
      paramName=paramName.replace("Content-Disposition: form-data; name=","").replace("\"","");
      StringBuilder paramValue=new StringBuilder();
      if (paramName.contains("filename")) {
        String[] temp=paramName.split(";");
        paramName=temp[0];
        paramValue.append(temp[1].replace("filename","").replace("=","").replace(" ",""));
      }
 else {
        currentLine=reader.readLine();
        while (!currentLine.contains(boundary)) {
          paramValue.append(currentLine);
          currentLine=reader.readLine();
        }
      }
      params.put(paramName,paramValue.toString());
    }
    if (currentLine.contains("Content-Type: ")) {
      reader.readLine();
      String prevLine=reader.readLine();
      currentLine=reader.readLine();
      while (true) {
        if (currentLine.contains(boundary)) {
          output.write(prevLine.getBytes());
          break;
        }
 else {
          output.write(currentLine.getBytes());
        }
        prevLine=currentLine;
        currentLine=reader.readLine();
      }
    }
  }
}
