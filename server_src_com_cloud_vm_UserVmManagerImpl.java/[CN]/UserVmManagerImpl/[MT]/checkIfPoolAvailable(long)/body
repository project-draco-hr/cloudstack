{
  List<VolumeVO> rootVolList=_volsDao.findByInstanceAndType(vmId,VolumeType.ROOT);
  if (rootVolList == null || rootVolList.size() == 0) {
    throw new StorageUnavailableException("Could not find the root disk for this vm to verify if the pool on which it exists is Up or not");
  }
 else {
    Long poolId=rootVolList.get(0).getPoolId();
    StoragePoolVO sp=_storagePoolDao.findById(poolId);
    if (sp == null) {
      throw new StorageUnavailableException("Could not find the pool for the root disk of vm" + vmId + ", to confirm if it is Up or not");
    }
 else {
      if (!sp.getStatus().equals(com.cloud.host.Status.Up)) {
        throw new StorageUnavailableException("Could not start the vm; the associated storage pool is in:" + sp.getStatus().toString() + " state");
      }
    }
  }
}
