{
  _name=name;
  if (_configDao == null) {
    throw new ConfigurationException("Unable to get the configuration dao.");
  }
  Map<String,String> configs=_configDao.getConfiguration("AgentManager",params);
  _instance=configs.get("instance.name");
  if (_instance == null) {
    _instance="DEFAULT";
  }
  String value=_configDao.getValue(Config.CreatePrivateTemplateFromVolumeWait.toString());
  _createprivatetemplatefromvolumewait=NumbersUtil.parseInt(value,Integer.parseInt(Config.CreatePrivateTemplateFromVolumeWait.getDefaultValue()));
  value=_configDao.getValue(Config.CreatePrivateTemplateFromSnapshotWait.toString());
  _createprivatetemplatefromsnapshotwait=NumbersUtil.parseInt(value,Integer.parseInt(Config.CreatePrivateTemplateFromSnapshotWait.getDefaultValue()));
  String workers=configs.get("expunge.workers");
  int wrks=NumbersUtil.parseInt(workers,10);
  String time=configs.get("expunge.interval");
  _expungeInterval=NumbersUtil.parseInt(time,86400);
  time=configs.get("expunge.delay");
  _expungeDelay=NumbersUtil.parseInt(time,_expungeInterval);
  _executor=Executors.newScheduledThreadPool(wrks,new NamedThreadFactory("UserVm-Scavenger"));
  _itMgr.registerGuru(VirtualMachine.Type.User,this);
  VirtualMachine.State.getStateMachine().registerListener(new UserVmStateListener(_usageEventDao,_networkDao,_nicDao));
  value=_configDao.getValue(Config.SetVmInternalNameUsingDisplayName.key());
  if (value == null) {
    _instanceNameFlag=false;
  }
 else {
    _instanceNameFlag=Boolean.parseBoolean(value);
  }
  _scaleRetry=NumbersUtil.parseInt(configs.get(Config.ScaleRetry.key()),2);
  s_logger.info("User VM Manager is configured.");
  return true;
}
