{
  UserVmVO vm=_vmDao.findById(vmId);
  if (vm == null) {
    return false;
  }
 else   if (vm.getState() != State.Running) {
    return true;
  }
  String isoPath=_storageMgr.getAbsoluteIsoPath(isoId,vm.getDataCenterId());
  String isoName=_templateDao.findById(isoId).getName();
  if (isoPath == null) {
    if (isoName.startsWith("xs-tools"))     isoPath=isoName;
 else     return false;
  }
  String vmName=vm.getInstanceName();
  HostVO host=_hostDao.findById(vm.getHostId());
  if (host == null)   return false;
  AttachIsoCommand cmd=new AttachIsoCommand(vmName,isoPath,attach);
  Answer a=_agentMgr.easySend(vm.getHostId(),cmd);
  return (a != null);
}
