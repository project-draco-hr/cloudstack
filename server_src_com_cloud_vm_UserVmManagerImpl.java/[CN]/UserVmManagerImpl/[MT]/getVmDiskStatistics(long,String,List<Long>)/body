{
  HashMap<Long,List<VmDiskStatsEntry>> vmDiskStatsById=new HashMap<Long,List<VmDiskStatsEntry>>();
  if (vmIds.isEmpty()) {
    return vmDiskStatsById;
  }
  List<String> vmNames=new ArrayList<String>();
  for (  Long vmId : vmIds) {
    UserVmVO vm=_vmDao.findById(vmId);
    vmNames.add(vm.getInstanceName());
  }
  Answer answer=_agentMgr.easySend(hostId,new GetVmDiskStatsCommand(vmNames,_hostDao.findById(hostId).getGuid(),hostName));
  if (answer == null || !answer.getResult()) {
    s_logger.warn("Unable to obtain VM disk statistics.");
    return null;
  }
 else {
    HashMap<String,List<VmDiskStatsEntry>> vmDiskStatsByName=((GetVmDiskStatsAnswer)answer).getVmDiskStatsMap();
    if (vmDiskStatsByName == null) {
      s_logger.warn("Unable to obtain VM disk statistics.");
      return null;
    }
    for (    String vmName : vmDiskStatsByName.keySet()) {
      vmDiskStatsById.put(vmIds.get(vmNames.indexOf(vmName)),vmDiskStatsByName.get(vmName));
    }
  }
  return vmDiskStatsById;
}
