{
  try {
    if (!_itMgr.advanceExpunge(vm,_accountMgr.getSystemUser(),caller)) {
      s_logger.info("Did not expunge " + vm);
      return false;
    }
    _networkGroupMgr.removeInstanceFromGroups(vm.getId());
    removeInstanceFromGroup(vm.getId());
    long vmId=vm.getId();
    if (_rulesMgr.revokePortForwardingRule(vmId)) {
      s_logger.debug("Port forwarding rules are removed successfully as a part of vm id=" + vmId + " expunge");
    }
 else {
      s_logger.warn("Fail to remove port forwarding rules as a part of vm id=" + vmId + " expunge");
    }
    if (_lbMgr.removeVmFromLoadBalancers(vmId)) {
      s_logger.debug("LB rules are removed successfully as a part of vm id=" + vmId + " expunge");
    }
 else {
      s_logger.warn("Fail to remove lb rules as a part of vm id=" + vmId + " expunge");
    }
    _itMgr.remove(vm,_accountMgr.getSystemUser(),caller);
    return true;
  }
 catch (  ResourceUnavailableException e) {
    s_logger.warn("Unable to expunging " + vm,e);
    return false;
  }
catch (  OperationTimedoutException e) {
    s_logger.warn("Operation time out on expunging " + vm,e);
    return false;
  }
catch (  ConcurrentOperationException e) {
    s_logger.warn("Concurrent operations on expunging " + vm,e);
    return false;
  }
}
