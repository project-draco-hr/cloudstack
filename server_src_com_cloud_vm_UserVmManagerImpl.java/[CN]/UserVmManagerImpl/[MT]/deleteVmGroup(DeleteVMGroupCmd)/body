{
  Account account=UserContext.current().getCaller();
  Long groupId=cmd.getId();
  InstanceGroupVO group=_vmGroupDao.findById(groupId);
  if ((group == null) || (group.getRemoved() != null)) {
    throw new InvalidParameterValueException("unable to find a vm group with id " + groupId);
  }
  if (account != null) {
    Account tempAccount=_accountDao.findById(group.getAccountId());
    if (!isAdmin(account.getType()) && (account.getId() != group.getAccountId())) {
      throw new PermissionDeniedException("unable to find a group with id " + groupId);
    }
 else     if (!_domainDao.isChildDomain(account.getDomainId(),tempAccount.getDomainId())) {
      throw new PermissionDeniedException("Invalid group id (" + groupId + ") given, unable to update the group.");
    }
  }
  return deleteVmGroup(groupId);
}
