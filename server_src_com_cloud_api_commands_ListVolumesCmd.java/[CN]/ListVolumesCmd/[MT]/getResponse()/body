{
  List<VolumeVO> volumes=(List<VolumeVO>)getResponseObject();
  List<VolumeResponse> response=new ArrayList<VolumeResponse>();
  for (  VolumeVO volume : volumes) {
    VolumeResponse volResponse=new VolumeResponse();
    volResponse.setId(volume.getId());
    AsyncJobVO asyncJob=getManagementServer().findInstancePendingAsyncJob("volume",volume.getId());
    if (asyncJob != null) {
      volResponse.setJobId(asyncJob.getId());
      volResponse.setJobStatus(asyncJob.getStatus());
    }
    if (volume.getName() != null) {
      volResponse.setName(volume.getName());
    }
 else {
      volResponse.setName("");
    }
    volResponse.setZoneId(volume.getDataCenterId());
    volResponse.setZoneName(getManagementServer().findDataCenterById(volume.getDataCenterId()).getName());
    volResponse.setVolumeType(volume.getVolumeType().toString());
    volResponse.setDeviceId(volume.getDeviceId());
    Long instanceId=volume.getInstanceId();
    if (instanceId != null) {
      VMInstanceVO vm=getManagementServer().findVMInstanceById(instanceId);
      volResponse.setVirtualMachineId(vm.getId());
      volResponse.setVirtualMachineName(vm.getName());
      volResponse.setVirtualMachineDisplayName(vm.getName());
      volResponse.setVirtualMachineState(vm.getState().toString());
    }
    volResponse.setSize(volume.getSize());
    volResponse.setCreated(volume.getCreated());
    volResponse.setState(volume.getStatus().toString());
    Account accountTemp=getManagementServer().findAccountById(volume.getAccountId());
    if (accountTemp != null) {
      volResponse.setAccountName(accountTemp.getAccountName());
      volResponse.setDomainId(accountTemp.getDomainId());
      volResponse.setDomainName(getManagementServer().findDomainIdById(accountTemp.getDomainId()).getName());
    }
    String storageType;
    try {
      if (volume.getPoolId() == null) {
        storageType="unknown";
      }
 else {
        storageType=getManagementServer().volumeIsOnSharedStorage(volume.getId()) ? "shared" : "local";
      }
    }
 catch (    InvalidParameterValueException e) {
      s_logger.error(e.getMessage(),e);
      throw new ServerApiException(BaseCmd.INTERNAL_ERROR,"Volume " + volume.getName() + " does not have a valid ID");
    }
    volResponse.setStorageType(storageType);
    volResponse.setDiskOfferingId(volume.getDiskOfferingId());
    if (volume.getDiskOfferingId() != null) {
      DiskOfferingVO diskOffering=getManagementServer().findDiskOfferingById(volume.getDiskOfferingId());
      volResponse.setDiskOfferingName(diskOffering.getName());
      volResponse.setDiskOfferingDisplayText(diskOffering.getDisplayText());
    }
    Long poolId=volume.getPoolId();
    String poolName=(poolId == null) ? "none" : getManagementServer().findPoolById(poolId).getName();
    volResponse.setStoragePoolName(poolName);
    response.add(volResponse);
  }
  return SerializerHelper.toSerializedString(response);
}
