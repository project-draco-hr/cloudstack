{
  try {
    String cert=certCmd.getCert();
    String key=certCmd.getKey();
    String password=certCmd.getPassword();
    String chain=certCmd.getChain();
    validate(cert,key,password,chain);
    s_logger.debug("Certificate Validation succeeded");
    String fingerPrint=generateFingerPrint(parseCertificate(cert));
    Long accountId=CallContext.current().getCallingAccount().getId();
    Long domainId=CallContext.current().getCallingAccount().getDomainId();
    SslCertVO certVO=new SslCertVO(cert,key,password,chain,accountId,domainId,fingerPrint);
    _sslCertDao.persist(certVO);
    return createCertResponse(certVO,null);
  }
 catch (  Exception e) {
    throw new CloudRuntimeException("Error parsing certificate data " + e.getMessage());
  }
}
