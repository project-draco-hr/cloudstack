{
  try {
    String cert=URLDecoder.decode(certCmd.getCert(),"UTF-8");
    String key=URLDecoder.decode(certCmd.getKey(),"UTF-8");
    String password=certCmd.getPassword();
    String chain=certCmd.getChain() == null ? null : URLDecoder.decode(certCmd.getChain(),"UTF-8");
    validate(cert,key,password,chain);
    s_logger.debug("Certificate Validation succeeded");
    String fingerPrint=generateFingerPrint(parseCertificate(cert));
    Long accountId=CallContext.current().getCallingAccount().getId();
    Long domainId=CallContext.current().getCallingAccount().getDomainId();
    SslCertVO certVO=new SslCertVO(cert,key,password,chain,accountId,domainId,fingerPrint);
    _sslCertDao.persist(certVO);
    return createCertResponse(certVO,null);
  }
 catch (  UnsupportedEncodingException e) {
    throw new CloudRuntimeException("Error decoding certificate data");
  }
}
