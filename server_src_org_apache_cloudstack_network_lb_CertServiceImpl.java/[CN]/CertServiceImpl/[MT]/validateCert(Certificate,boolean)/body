{
  if (!(cert instanceof X509Certificate))   throw new IllegalArgumentException("Invalid certificate format. Expected X509 certificate");
  try {
    ((X509Certificate)cert).checkValidity();
  }
 catch (  Exception e) {
    throw new IllegalArgumentException("Certificate expired or not valid",e);
  }
  if (!chain_present) {
    PublicKey pubKey=cert.getPublicKey();
    try {
      cert.verify(pubKey);
    }
 catch (    Exception e) {
      throw new IllegalArgumentException("No chain given and certificate not self signed",e);
    }
  }
}
