{
  SnapshotStrategy cantHandleStrategy=mock(SnapshotStrategy.class);
  SnapshotStrategy defaultStrategy=mock(SnapshotStrategy.class);
  SnapshotStrategy hyperStrategy=mock(SnapshotStrategy.class);
  SnapshotStrategy pluginStrategy=mock(SnapshotStrategy.class);
  SnapshotStrategy highestStrategy=mock(SnapshotStrategy.class);
  doReturn(Priority.CANT_HANDLE).when(cantHandleStrategy).canHandle(any(Snapshot.class),any(SnapshotOperation.class));
  doReturn(Priority.DEFAULT).when(defaultStrategy).canHandle(any(Snapshot.class),any(SnapshotOperation.class));
  doReturn(Priority.HYPERVISOR).when(hyperStrategy).canHandle(any(Snapshot.class),any(SnapshotOperation.class));
  doReturn(Priority.PLUGIN).when(pluginStrategy).canHandle(any(Snapshot.class),any(SnapshotOperation.class));
  doReturn(Priority.HIGHEST).when(highestStrategy).canHandle(any(Snapshot.class),any(SnapshotOperation.class));
  List<SnapshotStrategy> strategies=new ArrayList<SnapshotStrategy>(5);
  SnapshotStrategy strategy=null;
  strategies.add(cantHandleStrategy);
  strategy=StrategyPriority.pickStrategy(strategies,mock(Snapshot.class),SnapshotOperation.TAKE);
  assertEquals("A strategy was found when it shouldn't have been.",null,strategy);
  strategies.add(defaultStrategy);
  strategy=StrategyPriority.pickStrategy(strategies,mock(Snapshot.class),SnapshotOperation.TAKE);
  assertEquals("Default strategy was not picked.",defaultStrategy,strategy);
  strategies.add(hyperStrategy);
  strategy=StrategyPriority.pickStrategy(strategies,mock(Snapshot.class),SnapshotOperation.TAKE);
  assertEquals("Hypervisor strategy was not picked.",hyperStrategy,strategy);
  strategies.add(pluginStrategy);
  strategy=StrategyPriority.pickStrategy(strategies,mock(Snapshot.class),SnapshotOperation.TAKE);
  assertEquals("Plugin strategy was not picked.",pluginStrategy,strategy);
  strategies.add(highestStrategy);
  strategy=StrategyPriority.pickStrategy(strategies,mock(Snapshot.class),SnapshotOperation.TAKE);
  assertEquals("Highest strategy was not picked.",highestStrategy,strategy);
}
