{
  final Connection conn=getConnection();
  try {
    final Set<SR> srs=SR.getByNameLabel(conn,cmd.getStorageId());
    if (srs.size() != 1) {
      final String msg="There are " + srs.size() + " storageid: "+ cmd.getStorageId();
      s_logger.warn(msg);
      return new GetStorageStatsAnswer(cmd,msg);
    }
    final SR sr=srs.iterator().next();
    sr.scan(conn);
    final long capacity=sr.getPhysicalSize(conn);
    final long used=sr.getPhysicalUtilisation(conn);
    return new GetStorageStatsAnswer(cmd,capacity,used);
  }
 catch (  final XenAPIException e) {
    final String msg="GetStorageStats Exception:" + e.toString() + "host:"+ _host.getUuid()+ "storageid: "+ cmd.getStorageId();
    s_logger.warn(msg);
    return new GetStorageStatsAnswer(cmd,msg);
  }
catch (  final XmlRpcException e) {
    final String msg="GetStorageStats Exception:" + e.getMessage() + "host:"+ _host.getUuid()+ "storageid: "+ cmd.getStorageId();
    s_logger.warn(msg);
    return new GetStorageStatsAnswer(cmd,msg);
  }
}
