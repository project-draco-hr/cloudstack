{
  SR sr=prepareManagedSr(conn,details);
  VDI vdi=getVDIbyUuid(conn,path,false);
  Long volumeSize=Long.parseLong(details.get(DiskTO.VOLUME_SIZE));
  if (vdi == null) {
    vdi=createVdi(sr,vdiNameLabel,volumeSize);
  }
 else {
    s_logger.info("checking for the resize of the datadisk");
    long vdiVirtualSize=vdi.getVirtualSize(conn);
    if (vdiVirtualSize != volumeSize) {
      s_logger.info("resizing the datadisk(vdi) from vdiVirtualsize :" + vdiVirtualSize + "to volumeSize :"+ volumeSize);
      try {
        vdi.resize(conn,volumeSize);
      }
 catch (      Exception e) {
        s_logger.warn("Unable to resize volume",e);
      }
    }
  }
  return vdi;
}
