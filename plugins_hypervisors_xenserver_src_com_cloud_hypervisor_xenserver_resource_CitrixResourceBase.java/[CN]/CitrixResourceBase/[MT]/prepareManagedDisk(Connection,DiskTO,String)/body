{
  Map<String,String> details=disk.getDetails();
  if (details == null) {
    return null;
  }
  boolean isManaged=new Boolean(details.get(DiskTO.MANAGED)).booleanValue();
  if (!isManaged) {
    return null;
  }
  String iqn=details.get(DiskTO.IQN);
  Set<SR> srNameLabels=SR.getByNameLabel(conn,iqn);
  if (srNameLabels.size() != 0) {
    return null;
  }
  String vdiNameLabel=vmName + "-DATA";
  return prepareManagedStorage(conn,details,null,vdiNameLabel);
}
