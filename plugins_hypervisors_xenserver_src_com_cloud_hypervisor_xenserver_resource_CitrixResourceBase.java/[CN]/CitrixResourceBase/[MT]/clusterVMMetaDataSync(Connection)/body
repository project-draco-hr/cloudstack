{
  final HashMap<String,String> vmMetaDatum=new HashMap<String,String>();
  try {
    Map<VM,VM.Record> vm_map=VM.getAllRecords(conn);
    for (    VM.Record record : vm_map.values()) {
      if (record.isControlDomain || record.isASnapshot || record.isATemplate) {
        continue;
      }
      vmMetaDatum.put(record.nameLabel,StringUtils.mapToString(record.platform));
    }
  }
 catch (  final Throwable e) {
    String msg="Unable to get vms through host " + _host.uuid + " due to to "+ e.toString();
    s_logger.warn(msg,e);
    throw new CloudRuntimeException(msg);
  }
  return vmMetaDatum;
}
