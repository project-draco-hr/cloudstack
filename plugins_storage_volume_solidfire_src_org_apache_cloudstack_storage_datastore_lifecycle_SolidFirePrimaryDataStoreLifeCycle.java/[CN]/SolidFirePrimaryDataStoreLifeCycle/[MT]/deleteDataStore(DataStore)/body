{
  List<SnapshotVO> lstSnapshots=_snapshotDao.listAll();
  if (lstSnapshots != null) {
    for (    SnapshotVO snapshot : lstSnapshots) {
      SnapshotDetailsVO snapshotDetails=_snapshotDetailsDao.findDetail(snapshot.getId(),SolidFireUtil.STORAGE_POOL_ID);
      if (snapshotDetails != null && snapshotDetails.getValue() != null && Long.parseLong(snapshotDetails.getValue()) == store.getId()) {
        throw new CloudRuntimeException("This primary storage cannot be deleted because it currently contains one or more snapshots.");
      }
    }
  }
  return dataStoreHelper.deletePrimaryDataStore(store);
}
