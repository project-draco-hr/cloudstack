{
  AddImageStoreCmd cmd=new AddImageStoreCmd(){
    @Override public Map<String,String> getDetails(){
      Map<String,String> dm=new HashMap<String,String>();
      dm.put(ApiConstants.ACCOUNT,getAccount());
      dm.put(ApiConstants.USERNAME,getUsername());
      dm.put(ApiConstants.KEY,getKey());
      return dm;
    }
  }
;
  cmd.setProviderName("Swift");
  cmd.setUrl(this.getUrl());
  try {
    ImageStore result=_storageService.discoverImageStore(cmd);
    ImageStoreResponse storeResponse=null;
    if (result != null) {
      storeResponse=_responseGenerator.createImageStoreResponse(result);
      storeResponse.setResponseName(getCommandName());
      storeResponse.setObjectName("secondarystorage");
      this.setResponseObject(storeResponse);
    }
 else {
      throw new ServerApiException(ApiErrorCode.INTERNAL_ERROR,"Failed to add Swift secondary storage");
    }
  }
 catch (  DiscoveryException ex) {
    s_logger.warn("Exception: ",ex);
    throw new ServerApiException(ApiErrorCode.INTERNAL_ERROR,ex.getMessage());
  }
}
