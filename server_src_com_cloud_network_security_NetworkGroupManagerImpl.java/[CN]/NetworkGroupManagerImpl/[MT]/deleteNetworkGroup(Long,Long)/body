{
  if (!_enabled) {
    return;
  }
  final Transaction txn=Transaction.currentTxn();
  txn.start();
  final NetworkGroupVO group=_networkGroupDao.lock(groupId,true);
  if (group == null) {
    s_logger.info("Not deleting group -- cannot find id " + groupId);
    return;
  }
  if (group.getName().equalsIgnoreCase(NetworkGroupManager.DEFAULT_GROUP_NAME)) {
    txn.rollback();
    throw new PermissionDeniedException("The network group default is reserved");
  }
  List<IngressRuleVO> allowingRules=_ingressRuleDao.listByAllowedNetworkGroupId(groupId);
  if (allowingRules.size() != 0) {
    txn.rollback();
    throw new ResourceInUseException("Cannot delete group when there are ingress rules that allow this group");
  }
  List<IngressRuleVO> rulesInGroup=_ingressRuleDao.listByNetworkGroupId(groupId);
  if (rulesInGroup.size() != 0) {
    txn.rollback();
    throw new ResourceInUseException("Cannot delete group when there are ingress rules in this group");
  }
  _networkGroupDao.expunge(groupId);
  txn.commit();
}
