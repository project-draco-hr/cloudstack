{
  Transaction txn=Transaction.open(Transaction.CLOUD_DB);
  try {
    PreparedStatement pstmt=null;
    pstmt=txn.prepareAutoCloseStatement("UPDATE vm_disk SET disk_offering_id=? WHERE disk_offering_id=?");
    pstmt.setLong(1,newDiskOfferingId);
    pstmt.setLong(2,oldDiskOfferingId);
    int rows=pstmt.executeUpdate();
    pstmt.close();
    s_logger.info("Update vm_disk for disk offering change (" + oldDiskOfferingId + "->"+ newDiskOfferingId+ "), affected rows: "+ rows);
    pstmt=txn.prepareAutoCloseStatement("UPDATE volumes SET disk_offering_id=? WHERE disk_offering_id=?");
    pstmt.setLong(1,newDiskOfferingId);
    pstmt.setLong(2,oldDiskOfferingId);
    rows=pstmt.executeUpdate();
    pstmt.close();
    s_logger.info("Update volumes for disk offering change (" + oldDiskOfferingId + "->"+ newDiskOfferingId+ "), affected rows: "+ rows);
  }
 catch (  SQLException e) {
    s_logger.error("Unhandled exception: ",e);
  }
 finally {
    txn.close();
  }
}
