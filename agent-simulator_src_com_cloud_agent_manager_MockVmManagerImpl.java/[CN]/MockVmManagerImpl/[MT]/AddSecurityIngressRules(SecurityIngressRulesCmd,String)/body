{
  Map<String,Ternary<String,Long,Long>> rules=_securityRules.get(hostGuid);
  if (rules == null) {
    logSecurityGroupAction(cmd,null);
    rules=new ConcurrentHashMap<String,Ternary<String,Long,Long>>();
    rules.put(cmd.getVmName(),new Ternary<String,Long,Long>(cmd.getSignature(),cmd.getVmId(),cmd.getSeqNum()));
    _securityRules.put(hostGuid,rules);
  }
 else {
    logSecurityGroupAction(cmd,rules.get(cmd.getVmName()));
    rules.put(cmd.getVmName(),new Ternary<String,Long,Long>(cmd.getSignature(),cmd.getVmId(),cmd.getSeqNum()));
  }
  return new SecurityIngressRuleAnswer(cmd);
}
