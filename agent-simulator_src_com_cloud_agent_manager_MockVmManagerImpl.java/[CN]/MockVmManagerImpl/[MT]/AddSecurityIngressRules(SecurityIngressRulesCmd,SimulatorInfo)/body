{
  if (!info.isEnabled()) {
    return new SecurityIngressRuleAnswer(cmd,false,"Disabled",SecurityIngressRuleAnswer.FailureReason.CANNOT_BRIDGE_FIREWALL);
  }
  Map<String,Ternary<String,Long,Long>> rules=_securityRules.get(info.getHostUuid());
  if (rules == null) {
    logSecurityGroupAction(cmd,null);
    rules=new ConcurrentHashMap<String,Ternary<String,Long,Long>>();
    rules.put(cmd.getVmName(),new Ternary<String,Long,Long>(cmd.getSignature(),cmd.getVmId(),cmd.getSeqNum()));
    _securityRules.put(info.getHostUuid(),rules);
  }
 else {
    logSecurityGroupAction(cmd,rules.get(cmd.getVmName()));
    rules.put(cmd.getVmName(),new Ternary<String,Long,Long>(cmd.getSignature(),cmd.getVmId(),cmd.getSeqNum()));
  }
  return new SecurityIngressRuleAnswer(cmd);
}
