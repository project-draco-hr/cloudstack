{
  List<DataCenterVO> zones=_dataCenterDao.listAll();
  long id=1;
  HashMap<TrafficType,String> guruNames=new HashMap<TrafficType,String>();
  guruNames.put(TrafficType.Public,"PublicNetworkGuru-com.cloud.network.guru.PublicNetworkGuru");
  guruNames.put(TrafficType.Management,"PodBasedNetworkGuru-com.cloud.network.guru.PodBasedNetworkGuru");
  guruNames.put(TrafficType.Control,"ControlNetworkGuru-com.cloud.network.guru.ControlNetworkGuru");
  guruNames.put(TrafficType.Storage,"PodBasedNetworkGuru-com.cloud.network.guru.PodBasedNetworkGuru");
  for (  DataCenterVO zone : zones) {
    long zoneId=zone.getId();
    long accountId=1L;
    Long domainId=zone.getDomainId();
    if (domainId == null) {
      domainId=1L;
    }
    List<NetworkOfferingVO> ntwkOff=_networkOfferingDao.listSystemNetworkOfferings();
    for (    NetworkOfferingVO offering : ntwkOff) {
      if (offering.isSystemOnly()) {
        long related=id;
        long networkOfferingId=offering.getId();
        Mode mode=Mode.Static;
        BroadcastDomainType broadcastDomainType=null;
        TrafficType trafficType=offering.getTrafficType();
        GuestIpType guestIpType=offering.getGuestIpType();
        if (offering.getGuestIpType() != GuestIpType.DirectPodBased) {
          if (trafficType == TrafficType.Management || trafficType == TrafficType.Storage) {
            broadcastDomainType=BroadcastDomainType.Native;
          }
 else           if (trafficType == TrafficType.Public) {
            broadcastDomainType=BroadcastDomainType.Vlan;
          }
 else           if (trafficType == TrafficType.Control) {
            broadcastDomainType=BroadcastDomainType.LinkLocal;
          }
        }
 else         if (zone.getNetworkType() == NetworkType.Basic && offering.getGuestIpType() == GuestIpType.DirectPodBased) {
          broadcastDomainType=BroadcastDomainType.Vlan;
        }
        if (broadcastDomainType != null) {
          NetworkVO network=new NetworkVO(id,trafficType,guestIpType,mode,broadcastDomainType,networkOfferingId,zoneId,domainId,accountId,related,null,null,true);
          network.setGuruName(guruNames.get(network.getTrafficType()));
          network.setDns1(zone.getDns1());
          network.setDns2(zone.getDns2());
          network.setState(State.Implemented);
          _networkDao.persist(network,false);
          id++;
        }
      }
    }
  }
}
