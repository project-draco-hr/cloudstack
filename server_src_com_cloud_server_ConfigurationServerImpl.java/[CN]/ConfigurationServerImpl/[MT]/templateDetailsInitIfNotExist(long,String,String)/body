{
  TransactionLegacy txn=TransactionLegacy.currentTxn();
  PreparedStatement stmt=null;
  PreparedStatement stmtInsert=null;
  boolean insert=false;
  try {
    txn.start();
    stmt=txn.prepareAutoCloseStatement("SELECT id FROM vm_template_details WHERE template_id=? and name=?");
    stmt.setLong(1,id);
    stmt.setString(2,name);
    ResultSet rs=stmt.executeQuery();
    if (rs == null || !rs.next()) {
      insert=true;
    }
    stmt.close();
    if (insert) {
      stmtInsert=txn.prepareAutoCloseStatement("INSERT INTO vm_template_details(template_id, name, value) VALUES(?, ?, ?)");
      stmtInsert.setLong(1,id);
      stmtInsert.setString(2,name);
      stmtInsert.setString(3,value);
      if (stmtInsert.executeUpdate() < 1) {
        throw new CloudRuntimeException("Unable to init template " + id + " datails: "+ name);
      }
    }
    txn.commit();
  }
 catch (  Exception e) {
    s_logger.warn("Unable to init template " + id + " datails: "+ name,e);
    throw new CloudRuntimeException("Unable to init template " + id + " datails: "+ name);
  }
}
