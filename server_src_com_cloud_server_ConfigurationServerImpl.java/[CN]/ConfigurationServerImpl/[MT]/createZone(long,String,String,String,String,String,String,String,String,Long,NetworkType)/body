{
  int vnetStart=0;
  int vnetEnd=0;
  if (vnetRange != null) {
    String[] tokens=vnetRange.split("-");
    try {
      vnetStart=Integer.parseInt(tokens[0]);
      if (tokens.length == 1) {
        vnetEnd=vnetStart;
      }
 else {
        vnetEnd=Integer.parseInt(tokens[1]);
      }
    }
 catch (    NumberFormatException e) {
      throw new InvalidParameterValueException("Please specify valid integers for the vlan range.");
    }
  }
  if ((guestCidr != null) && !NetUtils.isValidCIDR(guestCidr)) {
    throw new InvalidParameterValueException("Please enter a valid guest cidr");
  }
  if (domainId != null) {
    DomainVO domainVo=_domainDao.findById(domainId);
    if (domainVo == null) {
      throw new InvalidParameterValueException("Please specify a valid domain id");
    }
  }
  DataCenterVO zone=new DataCenterVO(zoneName,null,dns1,dns2,internalDns1,internalDns2,vnetRange,guestCidr,domain,domainId,zoneType,false);
  zone=_zoneDao.persist(zone);
  if (vnetRange != null) {
    _zoneDao.addVnet(zone.getId(),vnetStart,vnetEnd);
  }
  return zone;
}
