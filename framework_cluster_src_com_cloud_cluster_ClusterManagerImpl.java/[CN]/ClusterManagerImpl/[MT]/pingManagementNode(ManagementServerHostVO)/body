{
  final String targetIp=mshost.getServiceIP();
  if ("127.0.0.1".equals(targetIp) || "0.0.0.0".equals(targetIp)) {
    logger.info("ping management node cluster service can not be performed on self");
    return false;
  }
  int retry=10;
  while (--retry > 0) {
    SocketChannel sch=null;
    try {
      logger.info("Trying to connect to " + targetIp);
      sch=SocketChannel.open();
      sch.configureBlocking(true);
      sch.socket().setSoTimeout(5000);
      final InetSocketAddress addr=new InetSocketAddress(targetIp,mshost.getServicePort());
      sch.connect(addr);
      return true;
    }
 catch (    final IOException e) {
      if (e instanceof ConnectException) {
        logger.error("Unable to ping management server at " + targetIp + ":"+ mshost.getServicePort()+ " due to ConnectException",e);
        return false;
      }
    }
 finally {
      if (sch != null) {
        try {
          sch.close();
        }
 catch (        final IOException e) {
        }
      }
    }
    try {
      Thread.sleep(1000);
    }
 catch (    final InterruptedException ex) {
    }
  }
  logger.error("Unable to ping management server at " + targetIp + ":"+ mshost.getServicePort()+ " after retries");
  return false;
}
