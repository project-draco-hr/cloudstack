{
  NetworkOffering offering=_networkOfferingDao.findByIdIncludingRemoved(config.getNetworkOfferingId());
  if (!canHandle(offering)) {
    return null;
  }
  if (vm.getHypervisorType() == HypervisorType.VmWare && vm.getType() != VirtualMachine.Type.DomainRouter) {
    NicProfile nicProf=new NicProfile(Nic.ReservationStrategy.Create,null,null,null,null);
    String mac=_networkMgr.getNextAvailableMacAddressInNetwork(config.getId());
    nicProf.setMacAddress(mac);
    return nicProf;
  }
  if (nic != null) {
    throw new CloudRuntimeException("Does not support nic specification at this time: " + nic);
  }
  return new NicProfile(Nic.ReservationStrategy.Start,null,null,null,null);
}
