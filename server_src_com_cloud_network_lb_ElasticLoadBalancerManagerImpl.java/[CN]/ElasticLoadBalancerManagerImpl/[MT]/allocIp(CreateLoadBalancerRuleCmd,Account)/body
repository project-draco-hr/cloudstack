{
  if (lb.getZoneId() == null) {
    throw new InvalidParameterValueException("zoneId is required parameter when LB service provider is " + Network.Provider.ElasticLoadBalancerVm.getName());
  }
  List<NetworkVO> networks=_networkDao.listByZoneAndTrafficType(lb.getZoneId(),TrafficType.Guest);
  if (networks.isEmpty()) {
    s_logger.warn("Unable to find network with traffic type " + TrafficType.Guest + " in zone id="+ lb.getZoneId());
    return null;
  }
  Network frontEndNetwork=networks.get(0);
  Transaction txn=Transaction.currentTxn();
  txn.start();
  PublicIp ip=_networkMgr.assignPublicIpAddress(lb.getZoneId(),null,account,VlanType.DirectAttached,frontEndNetwork.getId(),null);
  IPAddressVO ipvo=_ipAddressDao.findById(ip.getId());
  ipvo.setAssociatedWithNetworkId(frontEndNetwork.getId());
  _ipAddressDao.update(ipvo.getId(),ipvo);
  txn.commit();
  s_logger.info("Acquired frontend IP for ELB " + ip);
  return ip;
}
