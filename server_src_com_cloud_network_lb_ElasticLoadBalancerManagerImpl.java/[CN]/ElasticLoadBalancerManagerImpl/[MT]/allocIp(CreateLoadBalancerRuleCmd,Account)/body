{
  List<NetworkOfferingVO> offerings=_networkOfferingDao.listByTrafficTypeAndGuestType(true,_frontendTrafficType,GuestIpType.Direct);
  if (offerings == null || offerings.size() == 0) {
    s_logger.warn("Could not find system offering for direct networks of type " + _frontendTrafficType);
    return null;
  }
  NetworkOffering frontEndOffering=offerings.get(0);
  List<NetworkVO> networks=_networksDao.listBy(Account.ACCOUNT_ID_SYSTEM,frontEndOffering.getId(),lb.getZoneId());
  if (networks == null || networks.size() == 0) {
    s_logger.warn("Could not find network of offering type " + frontEndOffering + " in zone "+ lb.getZoneId());
    return null;
  }
  Network frontEndNetwork=networks.get(0);
  Transaction txn=Transaction.currentTxn();
  txn.start();
  PublicIp ip=_networkMgr.assignPublicIpAddress(lb.getZoneId(),null,account,VlanType.DirectAttached,frontEndNetwork.getId(),null);
  IPAddressVO ipvo=_ipAddressDao.findById(ip.getId());
  ipvo.setAssociatedWithNetworkId(frontEndNetwork.getId());
  _ipAddressDao.update(ipvo.getId(),ipvo);
  txn.commit();
  s_logger.info("Acquired public IP for loadbalancing " + ip);
  return ip;
}
