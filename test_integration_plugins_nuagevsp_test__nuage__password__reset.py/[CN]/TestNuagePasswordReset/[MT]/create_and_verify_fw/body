def create_and_verify_fw(self, vm, public_ip, network):
    self.debug('CREATE AND VERIFY FIREWALL RULE')
    self.create_StaticNatRule_For_VM(vm, public_ip, network)
    self.verify_vsp_floating_ip(network, vm, public_ip.ipaddress)
    fw_rule = self.create_firewall_rule(public_ip, self.test_data['ingress_rule'])
    self.verify_vsp_firewall_rule(fw_rule)
    vm_interface_id = self.get_vm_interface_id(vm)
    pd = self.vsd.get_vm_interface_policydecisions(id=vm_interface_id)
    self.debug(pd)
    egressAcls = pd['egressACLs'][0]['entries']
    gotFirewallPolicy = False
    for acl in egressAcls:
        if (acl['destinationPort'] == '22-22'):
            gotFirewallPolicy = True
            break
    if (not gotFirewallPolicy):
        raise ValueError('No firewall policy decision in vm interface')
