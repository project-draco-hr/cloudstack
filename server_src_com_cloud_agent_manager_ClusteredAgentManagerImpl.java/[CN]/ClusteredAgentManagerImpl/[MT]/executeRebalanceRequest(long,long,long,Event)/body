{
  if (event == Event.RequestAgentRebalance) {
    return setToWaitForRebalance(agentId,currentOwnerId,futureOwnerId);
  }
 else   if (event == Event.StartAgentRebalance) {
    boolean result=false;
    try {
      result=rebalanceHost(agentId,currentOwnerId,futureOwnerId);
    }
 catch (    Exception e) {
      s_logger.warn("Unable to rebalance host id=" + agentId,e);
    }
 finally {
      if (!result) {
        failRebalance(agentId);
        return false;
      }
    }
  }
  return true;
}
