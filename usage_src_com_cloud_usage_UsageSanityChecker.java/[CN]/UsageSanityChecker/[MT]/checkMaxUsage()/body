{
  int aggregationRange=DEFAULT_AGGREGATION_RANGE;
  List<PreparedStatement> pstmt2Close=new ArrayList<PreparedStatement>();
  try {
    PreparedStatement pstmt=conn.prepareStatement("SELECT value FROM `cloud`.`configuration` where name = 'usage.stats.job.aggregation.range'");
    pstmt2Close.add(pstmt);
    ResultSet rs=pstmt.executeQuery();
    if (rs.next()) {
      aggregationRange=rs.getInt(1);
    }
 else {
      s_logger.debug("Failed to retrieve aggregation range. Using default : " + aggregationRange);
    }
  }
 catch (  SQLException e) {
    throw e;
  }
 finally {
    TransactionLegacy.closePstmts(pstmt2Close);
  }
  int aggregationHours=aggregationRange / 60;
  addCheckCase("SELECT count(*) FROM `cloud_usage`.`cloud_usage` cu where usage_type not in (4,5) and raw_usage > " + aggregationHours,"usage records with raw_usage > " + aggregationHours,lastCheckId);
}
