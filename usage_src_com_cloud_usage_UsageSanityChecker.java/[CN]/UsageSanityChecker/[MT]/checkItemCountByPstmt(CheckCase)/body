{
  List<PreparedStatement> pstmt2Close=new ArrayList<PreparedStatement>();
  boolean checkOk=true;
  PreparedStatement pstmt;
  try {
    pstmt=conn.prepareStatement(checkCase.sqlTemplate);
    if (checkCase.checkId) {
      pstmt.setInt(1,lastId);
      pstmt.setInt(2,maxId);
    }
    pstmt2Close.add(pstmt);
    ResultSet rs=pstmt.executeQuery();
    if (rs.next() && (rs.getInt(1) > 0)) {
      errors.append(String.format("Error: Found %s %s\n",rs.getInt(1),checkCase.itemName));
      checkOk=false;
    }
  }
 catch (  SQLException e) {
    throw e;
  }
 finally {
    TransactionLegacy.closePstmts(pstmt2Close);
  }
  return checkOk;
}
