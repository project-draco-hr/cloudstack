{
  s_logger.debug("allocate NicProfile on " + network.getName());
  if (profile != null && profile.getRequestedIPv4() != null) {
    throw new CloudRuntimeException("Does not support custom ip allocation at this time: " + profile);
  }
  if (profile == null) {
    profile=new NicProfile(ReservationStrategy.Create,null,null,null,null);
  }
  profile.setReservationStrategy(ReservationStrategy.Start);
  URI broadcastUri=null;
  try {
    broadcastUri=new URI("vlan://untagged");
  }
 catch (  Exception e) {
    s_logger.warn("unable to instantiate broadcast URI: " + e);
  }
  profile.setBroadcastUri(broadcastUri);
  return profile;
}
