{
  List<String> result=new ArrayList<String>();
  List<String> gSection=Arrays.asList(globalSection);
  gSection.set(2,"\tmaxconn " + lbCmd.maxconn);
  String pipesLine="\tmaxpipes " + Long.toString(Long.parseLong(lbCmd.maxconn) / 4);
  gSection.set(3,pipesLine);
  if (s_logger.isDebugEnabled()) {
    for (    String s : gSection) {
      s_logger.debug("global section: " + s);
    }
  }
  result.addAll(gSection);
  result.add(blankLine);
  List<String> dSection=Arrays.asList(defaultsSection);
  if (lbCmd.keepAliveEnabled) {
    dSection.set(6,"\t#no option set here :<");
    dSection.set(7,"\tno option forceclose");
  }
 else {
    dSection.set(6,"\toption forwardfor");
    dSection.set(7,"\toption forceclose");
  }
  if (s_logger.isDebugEnabled()) {
    for (    String s : dSection) {
      s_logger.debug("default section: " + s);
    }
  }
  result.addAll(dSection);
  if (!lbCmd.lbStatsVisibility.equals("disabled")) {
    if (lbCmd.lbStatsVisibility.equals("global")) {
      result.add(generateStatsRule(lbCmd,"stats_on_public",lbCmd.lbStatsPublicIP));
    }
 else     if (lbCmd.lbStatsVisibility.equals("guest-network")) {
      result.add(generateStatsRule(lbCmd,"stats_on_guest",lbCmd.lbStatsGuestIP));
    }
 else     if (lbCmd.lbStatsVisibility.equals("link-local")) {
      result.add(generateStatsRule(lbCmd,"stats_on_private",lbCmd.lbStatsPrivateIP));
    }
 else     if (lbCmd.lbStatsVisibility.equals("all")) {
      result.add(generateStatsRule(lbCmd,"stats_on_public",lbCmd.lbStatsPublicIP));
      result.add(generateStatsRule(lbCmd,"stats_on_guest",lbCmd.lbStatsGuestIP));
      result.add(generateStatsRule(lbCmd,"stats_on_private",lbCmd.lbStatsPrivateIP));
    }
 else {
      StringBuilder subRule=new StringBuilder("\tstats enable\n\tstats uri     ").append(lbCmd.lbStatsUri).append("\n\tstats realm   Haproxy\\ Statistics\n\tstats auth    ").append(lbCmd.lbStatsAuth);
      result.add(subRule.toString());
    }
  }
  result.add(blankLine);
  boolean has_listener=false;
  for (  LoadBalancerTO lbTO : lbCmd.getLoadBalancers()) {
    if (lbTO.isRevoked()) {
      continue;
    }
    List<String> poolRules=getRulesForPool(lbTO,lbCmd.keepAliveEnabled);
    result.addAll(poolRules);
    has_listener=true;
  }
  result.add(blankLine);
  if (!has_listener) {
    result.addAll(Arrays.asList(defaultListen));
  }
  return result.toArray(new String[result.size()]);
}
