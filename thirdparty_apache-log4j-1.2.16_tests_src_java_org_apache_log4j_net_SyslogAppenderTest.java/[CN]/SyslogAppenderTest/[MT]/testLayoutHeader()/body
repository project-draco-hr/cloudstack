{
  DatagramSocket ds=new DatagramSocket();
  ds.setSoTimeout(2000);
  SyslogAppender appender=new SyslogAppender();
  appender.setSyslogHost("localhost:" + ds.getLocalPort());
  appender.setName("name");
  appender.setHeader(false);
  HTMLLayout pl=new HTMLLayout();
  appender.setLayout(pl);
  appender.activateOptions();
  Logger l=Logger.getRootLogger();
  l.addAppender(appender);
  l.info("Hello, World");
  appender.close();
  String[] s=new String[3];
  byte[] buf=new byte[1000];
  for (int i=0; i < 3; i++) {
    DatagramPacket p=new DatagramPacket(buf,0,buf.length);
    ds.receive(p);
    s[i]=new String(p.getData(),0,p.getLength());
  }
  ds.close();
  assertEquals("<14><!DOCTYPE",s[0].substring(0,13));
  assertEquals("<14></table>",s[2].substring(0,12));
}
