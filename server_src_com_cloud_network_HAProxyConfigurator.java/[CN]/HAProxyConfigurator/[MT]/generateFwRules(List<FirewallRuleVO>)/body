{
  String[][] result=new String[2][];
  Set<String> toAdd=new HashSet<String>();
  Set<String> toRemove=new HashSet<String>();
  for (int i=0; i < fwRules.size(); i++) {
    FirewallRuleVO rule=fwRules.get(i);
    if (rule.isForwarding())     continue;
    String vlanNetmask=rule.getVlanNetmask();
    StringBuilder sb=new StringBuilder();
    sb.append(rule.getPublicIpAddress()).append(":");
    sb.append(rule.getPublicPort()).append(":");
    sb.append(vlanNetmask);
    String lbRuleEntry=sb.toString();
    if (rule.isEnabled()) {
      toAdd.add(lbRuleEntry);
    }
 else {
      toRemove.add(lbRuleEntry);
    }
  }
  toRemove.removeAll(toAdd);
  result[ADD]=toAdd.toArray(new String[toAdd.size()]);
  result[REMOVE]=toRemove.toArray(new String[toRemove.size()]);
  return result;
}
