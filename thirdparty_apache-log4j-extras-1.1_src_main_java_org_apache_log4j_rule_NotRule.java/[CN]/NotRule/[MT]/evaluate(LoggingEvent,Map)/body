{
  if (matches == null) {
    return !(rule.evaluate(event,null));
  }
  Map tempMatches=new HashMap();
  boolean result=!(rule.evaluate(event,tempMatches));
  if (result) {
    for (Iterator iter=tempMatches.entrySet().iterator(); iter.hasNext(); ) {
      Map.Entry entry=(Map.Entry)iter.next();
      Object key=entry.getKey();
      Set value=(Set)entry.getValue();
      Set mainSet=(Set)matches.get(key);
      if (mainSet == null) {
        mainSet=new HashSet();
        matches.put(key,mainSet);
      }
      mainSet.addAll(value);
    }
  }
  return result;
}
