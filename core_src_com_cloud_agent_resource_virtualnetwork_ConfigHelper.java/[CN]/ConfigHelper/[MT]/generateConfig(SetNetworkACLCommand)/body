{
  LinkedList<ConfigItem> cfg=new LinkedList<>();
  String privateGw=cmd.getAccessDetail(NetworkElementCommand.VPC_PRIVATE_GATEWAY);
  String[][] rules=cmd.generateFwRules();
  String[] aclRules=rules[0];
  NicTO nic=cmd.getNic();
  String dev="eth" + nic.getDeviceId();
  String netmask=Long.toString(NetUtils.getCidrSize(nic.getNetmask()));
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < aclRules.length; i++) {
    sb.append(aclRules[i]).append(',');
  }
  String rule=sb.toString();
  NetworkACL networkACL=new NetworkACL(dev,nic.getMac(),privateGw != null,nic.getIp(),netmask,rule);
  ConfigItem networkAclFile=new FileConfigItem(VRScripts.CONFIG_PERSIST_LOCATION,VRScripts.NETWORK_ACL_CONFIG,gson.toJson(networkACL));
  cfg.add(networkAclFile);
  ConfigItem updateNetworkACL=new ScriptConfigItem(VRScripts.UPDATE_CONFIG,VRScripts.NETWORK_ACL_CONFIG);
  cfg.add(updateNetworkACL);
  return cfg;
}
