{
  LinkedList<ConfigItem> cfg=new LinkedList<>();
  String privateGw=cmd.getAccessDetail(NetworkElementCommand.VPC_PRIVATE_GATEWAY);
  String[][] rules=cmd.generateFwRules();
  String[] aclRules=rules[0];
  NicTO nic=cmd.getNic();
  String dev="eth" + nic.getDeviceId();
  String netmask=Long.toString(NetUtils.getCidrSize(nic.getNetmask()));
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < aclRules.length; i++) {
    sb.append(aclRules[i]).append(',');
  }
  String rule=sb.toString();
  String args=" -d " + dev;
  args+=" -M " + nic.getMac();
  if (privateGw != null) {
    args+=" -a " + rule;
    cfg.add(new ScriptConfigItem(VRScripts.VPC_PRIVATEGW_ACL,args));
  }
 else {
    args+=" -i " + nic.getIp();
    args+=" -m " + netmask;
    args+=" -a " + rule;
    cfg.add(new ScriptConfigItem(VRScripts.VPC_ACL,args));
  }
  return cfg;
}
