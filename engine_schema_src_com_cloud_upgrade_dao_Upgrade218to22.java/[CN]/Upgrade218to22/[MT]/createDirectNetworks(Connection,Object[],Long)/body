{
  try (PreparedStatement selectVlanData=conn.prepareStatement("SELECT id, vlan_id, vlan_gateway, vlan_netmask FROM vlan WHERE vlan_type='DirectAttached' AND data_center_id=?")){
    selectVlanData.setLong(1,dcId);
    try (ResultSet vlanData=selectVlanData.executeQuery()){
      HashMap<String,Long> vlanNetworkMap=new HashMap<String,Long>();
      while (vlanData.next()) {
        long vlanId=vlanData.getLong(1);
        String tag=vlanData.getString(2);
        String gateway=vlanData.getString(3);
        String netmask=vlanData.getString(4);
        String cidr=NetUtils.getCidrFromGatewayAndNetmask(gateway,netmask);
        retrieveAccountDataAndCreateNetwork(conn,dc,dcId,vlanNetworkMap,vlanId,tag,gateway,cidr);
        updateNetworkInVlanTableforTag(conn,vlanNetworkMap,vlanId,tag);
        upgradeDirectUserIpAddress(conn,dcId,vlanNetworkMap.get(tag),"DirectAttached");
        s_logger.debug("Created Direct networks and upgraded Direct ip addresses");
      }
    }
   }
 }
