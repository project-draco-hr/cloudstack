{
  Map<String,State> states=new HashMap<String,State>();
  if (hostId != null) {
    ComponentLocator locator=ComponentLocator.getLocator(ManagementServer.Name);
    vmDao=locator.getDao(VMInstanceDao.class);
    final List<? extends VMInstanceVO> vms=vmDao.listByHostId(hostId);
    for (    VMInstanceVO vm : vms) {
      states.put(vm.getInstanceName(),vm.getState());
    }
  }
  return states;
}
