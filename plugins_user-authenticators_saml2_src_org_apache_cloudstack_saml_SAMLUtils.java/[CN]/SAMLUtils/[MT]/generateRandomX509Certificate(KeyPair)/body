{
  DateTime now=DateTime.now(DateTimeZone.UTC);
  X500Principal dnName=new X500Principal("CN=ApacheCloudStack");
  X509V1CertificateGenerator certGen=new X509V1CertificateGenerator();
  certGen.setSerialNumber(BigInteger.valueOf(System.currentTimeMillis()));
  certGen.setSubjectDN(dnName);
  certGen.setIssuerDN(dnName);
  certGen.setNotBefore(now.minusDays(1).toDate());
  certGen.setNotAfter(now.plusYears(3).toDate());
  certGen.setPublicKey(keyPair.getPublic());
  certGen.setSignatureAlgorithm("SHA256WithRSAEncryption");
  return certGen.generate(keyPair.getPrivate(),"BC");
}
