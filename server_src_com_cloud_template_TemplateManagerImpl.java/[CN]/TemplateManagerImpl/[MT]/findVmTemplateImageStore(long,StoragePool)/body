{
  long dcId=pool.getDataCenterId();
  List<DataStore> secStores=this.dataStoreMgr.getImageStoresByScope(new ZoneScope(dcId));
  if (secStores == null) {
    s_logger.error("No image store found to download template " + templateId + " primary storage!");
    return null;
  }
  for (  DataStore store : secStores) {
    List<TemplateDataStoreVO> templStores=this._tmplStoreDao.listByTemplateStoreDownloadStatus(templateId,store.getId(),VMTemplateStorageResourceAssoc.Status.DOWNLOADED);
    if (templStores != null && !templStores.isEmpty()) {
      Collections.shuffle(templStores);
      return templStores.get(0);
    }
  }
  return null;
}
