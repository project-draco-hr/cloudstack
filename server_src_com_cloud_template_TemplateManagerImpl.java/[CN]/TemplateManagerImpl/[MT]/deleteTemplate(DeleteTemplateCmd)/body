{
  Long templateId=cmd.getId();
  Long userId=UserContext.current().getUserId();
  Account account=UserContext.current().getAccount();
  Long zoneId=cmd.getZoneId();
  VMTemplateVO template=_tmpltDao.findById(templateId.longValue());
  if (template == null) {
    throw new ServerApiException(BaseCmd.PARAM_ERROR,"unable to find template with id " + templateId);
  }
  userId=accountAndUserValidation(account,userId,null,template,"Unable to delete template ");
  UserVO user=_userDao.findById(userId);
  if (user == null) {
    throw new InvalidParameterValueException("Please specify a valid user.");
  }
  if (template.getFormat() == ImageFormat.ISO) {
    throw new InvalidParameterValueException("Please specify a valid template.");
  }
  if (template.getTemplateType() == TemplateType.SYSTEM) {
    throw new InvalidParameterValueException("The DomR template cannot be deleted.");
  }
  if (zoneId != null && (_hostDao.findSecondaryStorageHost(zoneId) == null)) {
    throw new InvalidParameterValueException("Failed to find a secondary storage host in the specified zone.");
  }
  return delete(userId,templateId,zoneId);
}
