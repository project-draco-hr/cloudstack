{
  Long templateId=cmd.getId();
  Long userId=UserContext.current().getUserId();
  Long sourceZoneId=cmd.getSourceZoneId();
  Long destZoneId=cmd.getDestinationZoneId();
  Account account=(Account)UserContext.current().getAccountObject();
  VMTemplateVO template=_tmpltDao.findById(templateId);
  if (template == null) {
    throw new InvalidParameterValueException("Unable to find template with id");
  }
  boolean isIso=Storage.ImageFormat.ISO.equals(template.getFormat());
  if (isIso) {
    throw new InvalidParameterValueException("Please specify a valid template.");
  }
  String errMsg="Unable to copy template " + templateId;
  userId=accountAndUserValidation(account,userId,null,template,errMsg);
  long eventId=EventUtils.saveScheduledEvent(userId,template.getAccountId(),EventTypes.EVENT_TEMPLATE_COPY,"copying template with Id: " + templateId + " from zone: "+ sourceZoneId+ " to: "+ destZoneId);
  boolean success=copy(userId,templateId,sourceZoneId,destZoneId,eventId);
  VMTemplateVO copiedTemplate=null;
  if (success)   copiedTemplate=_tmpltDao.findById(templateId);
  return copiedTemplate;
}
