{
  boolean success=false;
  String errorStr=null;
  String successStr=null;
  try {
    String certificate=cmd.getCertificate();
    boolean dirCreated=false;
    boolean dirExists=false;
    boolean forNewProxy=cmd.isForNewProxy();
    String strDirectory="/etc/cloud/consoleproxy/cert/";
    String filePath="/etc/cloud/consoleproxy/cert/customcert";
    if (forNewProxy) {
      dirCreated=(new File(strDirectory)).mkdirs();
      if (s_logger.isDebugEnabled())       s_logger.debug("Directory: " + strDirectory + " created");
      if (dirCreated) {
        FileWriter fstream=new FileWriter(filePath);
        BufferedWriter out=new BufferedWriter(fstream);
        out.write(certificate);
        out.close();
        success=true;
        successStr="Successfully created cert at /etc/cloud/consoleproxy/cert/ from the listener flow for new console proxy starting up";
      }
    }
 else {
      File dir=new File(strDirectory);
      dirExists=dir.exists();
      if (!dirExists) {
        dirCreated=(new File(strDirectory)).mkdirs();
        if (s_logger.isDebugEnabled())         s_logger.debug("Directory: " + strDirectory + " created");
      }
      if (dirExists || dirCreated) {
        FileWriter fstream=new FileWriter(filePath);
        BufferedWriter out=new BufferedWriter(fstream);
        out.write(certificate);
        out.close();
        success=true;
        successStr="Successfully created cert at /etc/cloud/consoleproxy/cert/ from the UploadCustomCert cmd flow for existing console proxy";
      }
    }
  }
 catch (  SecurityException se) {
    errorStr="Unable to upload cert in console proxy resource due to directory creation failure";
    s_logger.error(errorStr,se);
    success=false;
  }
catch (  IOException ioe) {
    errorStr="Unable to write cert to the location /etc/cloud/consoleproxy/cert/ ";
    s_logger.error(errorStr,ioe);
    success=false;
  }
catch (  Exception e) {
    errorStr="Unable to upload cert in console proxy resource";
    s_logger.error(errorStr,e);
    success=false;
  }
  return new Answer(cmd,success,errorStr != null ? errorStr : successStr);
}
