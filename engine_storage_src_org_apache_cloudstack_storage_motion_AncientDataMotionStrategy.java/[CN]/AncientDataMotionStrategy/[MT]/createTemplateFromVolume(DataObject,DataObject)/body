{
  long volumeId=srcObj.getId();
  VolumeVO volume=this.volDao.findById(volumeId);
  if (volume == null) {
    throw new CloudRuntimeException("Unable to find volume for Id " + volumeId);
  }
  long accountId=volume.getAccountId();
  String vmName=this.volumeMgr.getVmNameOnVolume(volume);
  Long zoneId=volume.getDataCenterId();
  HostVO secondaryStorageHost=this.templateMgr.getSecondaryStorageHost(zoneId);
  if (secondaryStorageHost == null) {
    throw new CloudRuntimeException("Can not find the secondary storage for zoneId " + zoneId);
  }
  String secondaryStorageURL=secondaryStorageHost.getStorageUrl();
  VMTemplateVO template=this.templateDao.findById(destObj.getId());
  StoragePool pool=(StoragePool)this.dataStoreMgr.getDataStore(volume.getPoolId(),DataStoreRole.Primary);
  String value=configDao.getValue(Config.CreatePrivateTemplateFromVolumeWait.toString());
  int _createprivatetemplatefromvolumewait=NumbersUtil.parseInt(value,Integer.parseInt(Config.CreatePrivateTemplateFromVolumeWait.getDefaultValue()));
  CreatePrivateTemplateFromVolumeCommand cmd=new CreatePrivateTemplateFromVolumeCommand(pool,secondaryStorageURL,destObj.getId(),accountId,template.getName(),template.getUniqueName(),volume.getPath(),vmName,_createprivatetemplatefromvolumewait);
  return sendCommand(cmd,pool,template.getId(),zoneId,secondaryStorageHost.getId());
}
