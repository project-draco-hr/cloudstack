{
  String problemName="com.example.bar<>&\"'";
  Logger logger=Logger.getLogger(problemName);
  Level level=new ProblemLevel(problemName);
  Exception ex=new IllegalArgumentException(problemName);
  String threadName=Thread.currentThread().getName();
  Thread.currentThread().setName(problemName);
  NDC.push(problemName);
  Hashtable mdcMap=MDC.getContext();
  if (mdcMap != null) {
    mdcMap.clear();
  }
  MDC.put(problemName,problemName);
  LoggingEvent event=new LoggingEvent(problemName,logger,level,problemName,ex);
  HTMLLayout layout=(HTMLLayout)createLayout();
  String result=layout.format(event);
  mdcMap=MDC.getContext();
  if (mdcMap != null) {
    mdcMap.clear();
  }
  Thread.currentThread().setName(threadName);
  StringBuffer buf=new StringBuffer("<!DOCTYPE table [<!ENTITY nbsp ' '>]><table>");
  buf.append(result);
  buf.append("</table>");
  String doc=buf.toString();
  for (int i=doc.lastIndexOf("<br>"); i != -1; i=doc.lastIndexOf("<br>",i - 1)) {
    buf.replace(i,i + 4,"<br/>");
  }
  parse(buf.toString());
}
