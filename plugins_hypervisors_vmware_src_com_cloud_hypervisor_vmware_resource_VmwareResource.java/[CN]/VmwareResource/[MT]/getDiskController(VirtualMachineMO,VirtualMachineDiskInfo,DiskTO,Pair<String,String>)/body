{
  int controllerKey;
  DiskControllerType controllerType=DiskControllerType.none;
  if (matchingExistingDisk != null) {
    String currentBusName=matchingExistingDisk.getDiskDeviceBusName();
    if (currentBusName != null) {
      s_logger.info("Chose disk controller based on existing information: " + currentBusName);
      if (currentBusName.startsWith("ide")) {
        controllerType=DiskControllerType.ide;
      }
 else       if (currentBusName.startsWith("scsi")) {
        controllerType=DiskControllerType.scsi;
      }
    }
    if (controllerType == DiskControllerType.scsi || controllerType == DiskControllerType.none) {
      Ternary<Integer,Integer,DiskControllerType> vmScsiControllerInfo=vmMo.getScsiControllerInfo();
      controllerType=vmScsiControllerInfo.third();
    }
    return controllerType.toString();
  }
  if (vol.getType() == Volume.Type.ROOT) {
    s_logger.info("Chose disk controller for vol " + vol.getType() + " -> "+ controllerInfo.first()+ ", based on root disk controller settings at global configuration setting.");
    return controllerInfo.first();
  }
 else {
    s_logger.info("Chose disk controller for vol " + vol.getType() + " -> "+ controllerInfo.second()+ ", based on default data disk controller setting i.e. Operating system recommended.");
    return controllerInfo.second();
  }
}
