{
  gcAndKillHungWorkerVMs();
  HashMap<String,State> newStates=sync();
  if (newStates == null) {
    return null;
  }
  VmwareContext context=getServiceContext();
  VmwareHypervisorHost hyperHost=getHyperHost(context);
  try {
    if (!hyperHost.isHyperHostConnected()) {
      return null;
    }
  }
 catch (  Exception e) {
    s_logger.error("Unexpected exception",e);
    return null;
  }
  return new PingRoutingCommand(getType(),id,newStates,syncHostVmStates());
}
