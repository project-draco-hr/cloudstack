{
  resource.configure("NiciraNvpResource",parameters);
  LogicalSwitchPort lsp=mock(LogicalSwitchPort.class);
  when(lsp.getUuid()).thenReturn("eeee");
  when(nvpApi.createLogicalSwitchPort(eq("cccc"),(LogicalSwitchPort)any())).thenReturn(lsp);
  doThrow(new NiciraNvpApiException()).when(nvpApi).modifyLogicalSwitchPortAttachment((String)any(),(String)any(),(Attachment)any());
  CreateLogicalSwitchPortCommand clspc=new CreateLogicalSwitchPortCommand("cccc","dddd","owner","nicname");
  CreateLogicalSwitchPortAnswer clspa=(CreateLogicalSwitchPortAnswer)resource.executeRequest(clspc);
  assertFalse(clspa.getResult());
  verify(nvpApi,atLeastOnce()).deleteLogicalSwitchPort((String)any(),(String)any());
}
