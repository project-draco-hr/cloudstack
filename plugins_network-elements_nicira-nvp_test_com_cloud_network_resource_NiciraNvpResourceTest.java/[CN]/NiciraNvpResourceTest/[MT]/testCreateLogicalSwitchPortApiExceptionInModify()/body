{
  _resource.configure("NiciraNvpResource",_parameters);
  LogicalSwitchPort lsp=mock(LogicalSwitchPort.class);
  when(lsp.getUuid()).thenReturn("eeee");
  when(_nvpApi.createLogicalSwitchPort(eq("cccc"),(LogicalSwitchPort)any())).thenReturn(lsp);
  doThrow(new NiciraNvpApiException()).when(_nvpApi).modifyLogicalSwitchPortAttachment((String)any(),(String)any(),(Attachment)any());
  CreateLogicalSwitchPortCommand clspc=new CreateLogicalSwitchPortCommand("cccc","dddd","owner","nicname");
  CreateLogicalSwitchPortAnswer clspa=(CreateLogicalSwitchPortAnswer)_resource.executeRequest(clspc);
  assertFalse(clspa.getResult());
  verify(_nvpApi,atLeastOnce()).deleteLogicalSwitchPort((String)any(),(String)any());
}
