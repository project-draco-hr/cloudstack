{
  AclPolicy policy=_iamSrv.getResourceGrantPolicy(entityType,entityId,accessType.toString(),action);
  if (policy == null) {
    Account caller=CallContext.current().getCallingAccount();
    String aclPolicyName="policyGrant" + entityType + entityId;
    String description="Policy to grant permission to " + entityType + entityId;
    policy=createAclPolicy(caller,aclPolicyName,description,null);
    addAclPermissionToAclPolicy(policy.getId(),entityType,PermissionScope.RESOURCE,entityId,action,Permission.Allow);
  }
  Long policyId=policy.getId();
  for (  Long acctId : accountIds) {
    if (!isPolicyAttachedToAccount(policyId,acctId)) {
      attachAclPolicyToAccounts(policyId,Collections.singletonList(acctId));
    }
  }
}
