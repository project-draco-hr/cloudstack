{
  PatternLayout layout=new PatternLayout("%c{1} - %m%n");
  RollingFileAppender rfa=new RollingFileAppender();
  rfa.setLayout(layout);
  String datePattern="yyyy-MM-dd_HH_mm_ss";
  TimeBasedRollingPolicy tbrp=new TimeBasedRollingPolicy();
  tbrp.setFileNamePattern("test1-%d{" + datePattern + "}");
  tbrp.activateOptions();
  rfa.setRollingPolicy(tbrp);
  rfa.activateOptions();
  logger.addAppender(rfa);
  SimpleDateFormat sdf=new SimpleDateFormat(datePattern);
  String[] filenames=new String[4];
  Calendar cal=Calendar.getInstance();
  for (int i=0; i < 4; i++) {
    filenames[i]="test1-" + sdf.format(cal.getTime());
    cal.add(Calendar.SECOND,1);
  }
  System.out.println("Waiting until next second and 100 millis.");
  delayUntilNextSecond(100);
  System.out.println("Done waiting.");
  for (int i=0; i < 5; i++) {
    logger.debug("Hello---" + i);
    Thread.sleep(500);
  }
  for (int i=0; i < 4; i++) {
  }
  for (int i=0; i < 4; i++) {
    assertTrue(compare(filenames[i],"witness/rolling/tbr-test1." + i));
  }
}
