{
  when(_vmDao.findById(anyLong())).thenReturn(_vmMock);
  when(_templateDao.findById(anyLong())).thenReturn(_templateMock);
  doReturn(VirtualMachine.State.Error).when(_vmMock).getState();
  _userVmMgr.restoreVMInternal(_account,_vmMock,null);
}
