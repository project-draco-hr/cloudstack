{
  SecurityGroupResponse sgResponse=new SecurityGroupResponse();
  sgResponse.setId(vsg.getUuid());
  sgResponse.setName(vsg.getName());
  sgResponse.setDescription(vsg.getDescription());
  ApiResponseHelper.populateOwner(sgResponse,vsg);
  Long rule_id=vsg.getRuleId();
  if (rule_id != null && rule_id.longValue() > 0) {
    SecurityGroupRuleResponse ruleData=new SecurityGroupRuleResponse();
    ruleData.setRuleId(vsg.getRuleUuid());
    ruleData.setProtocol(vsg.getRuleProtocol());
    if ("icmp".equalsIgnoreCase(vsg.getRuleProtocol())) {
      ruleData.setIcmpType(vsg.getRuleStartPort());
      ruleData.setIcmpCode(vsg.getRuleEndPort());
    }
 else {
      ruleData.setStartPort(vsg.getRuleStartPort());
      ruleData.setEndPort(vsg.getRuleEndPort());
    }
    if (vsg.getRuleAllowedNetworkId() != null) {
      List<SecurityGroupJoinVO> sgs=this.searchByIds(vsg.getRuleAllowedNetworkId());
      if (sgs != null && sgs.size() > 0) {
        SecurityGroupJoinVO sg=sgs.get(0);
        ruleData.setSecurityGroupName(sg.getName());
        ruleData.setAccountName(sg.getAccountName());
      }
    }
 else {
      ruleData.setCidr(vsg.getRuleAllowedSourceIpCidr());
    }
    if (vsg.getRuleType() == SecurityRuleType.IngressRule) {
      ruleData.setObjectName("ingressrule");
      sgResponse.addSecurityGroupIngressRule(ruleData);
    }
 else {
      ruleData.setObjectName("egressrule");
      sgResponse.addSecurityGroupEgressRule(ruleData);
    }
  }
  Long tag_id=vsg.getTagId();
  if (tag_id != null && tag_id.longValue() > 0) {
    ResourceTagResponse tag=new ResourceTagResponse();
    tag.setKey(vsg.getTagKey());
    tag.setValue(vsg.getTagValue());
    if (vsg.getTagResourceType() != null) {
      tag.setResourceType(vsg.getTagResourceType().toString());
    }
    tag.setId(vsg.getTagResourceUuid());
    tag.setCustomer(vsg.getTagCustomer());
    tag.setDomainId(vsg.getTagDomainId());
    if (vsg.getAccountType() == Account.ACCOUNT_TYPE_PROJECT) {
      tag.setProjectId(vsg.getProjectId());
      tag.setProjectName(vsg.getProjectName());
    }
 else {
      tag.setAccountName(vsg.getAccountName());
    }
    tag.setDomainId(vsg.getDomainId());
    tag.setDomainName(vsg.getDomainName());
    tag.setObjectName("tag");
    sgResponse.addTag(tag);
  }
  sgResponse.setObjectName("securitygroup");
  return sgResponse;
}
