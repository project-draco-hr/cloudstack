{
  if (!_networkModel.areServicesSupportedInNetwork(network.getId(),Service.Lb)) {
    InvalidParameterValueException ex=new InvalidParameterValueException("LB service is not supported in specified network id");
    ex.addProxyObject(network.getUuid(),"networkId");
    throw ex;
  }
  _lbMgr.isLbServiceSupportedInNetwork(network.getId(),scheme);
  Map<Network.Capability,String> caps=_networkModel.getNetworkServiceCapabilities(network.getId(),Service.Lb);
  String supportedProtocols=caps.get(Capability.SupportedProtocols).toLowerCase();
  if (!supportedProtocols.contains(NetUtils.TCP_PROTO.toLowerCase())) {
    throw new InvalidParameterValueException("Protocol " + NetUtils.TCP_PROTO.toLowerCase() + " is not supported in zone "+ network.getDataCenterId());
  }
  if (!NetUtils.isValidPort(instancePort)) {
    throw new InvalidParameterValueException("Invalid value for instance port: " + instancePort);
  }
  if (!NetUtils.isValidPort(sourcePort)) {
    throw new InvalidParameterValueException("Invalid value for source port: " + sourcePort);
  }
  if ((algorithm == null) || !NetUtils.isValidAlgorithm(algorithm)) {
    throw new InvalidParameterValueException("Invalid algorithm: " + algorithm);
  }
}
