{
  Logger logger=Logger.getLogger("org.apache.log4j.xml.XMLLayoutTest");
  NDC.push("NDC goes here");
  LoggingEvent event=new LoggingEvent("org.apache.log4j.Logger",logger,Level.INFO,"Hello, World",null);
  XMLLayout layout=(XMLLayout)createLayout();
  String result=layout.format(event);
  NDC.pop();
  Element parsedResult=parse(result);
  checkEventElement(parsedResult,event);
  int childElementCount=0;
  for (Node node=parsedResult.getFirstChild(); node != null; node=node.getNextSibling()) {
switch (node.getNodeType()) {
case Node.ELEMENT_NODE:
      childElementCount++;
    if (childElementCount == 1) {
      checkMessageElement((Element)node,"Hello, World");
    }
 else {
      checkNDCElement((Element)node,"NDC goes here");
    }
  break;
case Node.COMMENT_NODE:
break;
case Node.TEXT_NODE:
break;
default :
fail("Unexpected node type");
break;
}
}
assertEquals(2,childElementCount);
}
