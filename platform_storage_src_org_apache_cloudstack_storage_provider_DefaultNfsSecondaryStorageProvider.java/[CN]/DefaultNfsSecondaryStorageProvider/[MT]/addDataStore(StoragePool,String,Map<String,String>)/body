{
  URI uri;
  try {
    uri=new URI(url);
  }
 catch (  URISyntaxException e) {
    throw new InvalidParameterValueException("invalide url" + url);
  }
  String protocol=uri.getScheme();
  if (protocol == null) {
    throw new InvalidParameterValueException("the protocol can't be null");
  }
  DataStoreConfigurator dscf=_supportedProtocols.get(HypervisorType.XenServer).get(protocol);
  Map<String,String> configs=dscf.getConfigs(uri,params);
  dscf.validate(configs);
  DataStore ds=dscf.getDataStore(sp);
  return ds;
}
