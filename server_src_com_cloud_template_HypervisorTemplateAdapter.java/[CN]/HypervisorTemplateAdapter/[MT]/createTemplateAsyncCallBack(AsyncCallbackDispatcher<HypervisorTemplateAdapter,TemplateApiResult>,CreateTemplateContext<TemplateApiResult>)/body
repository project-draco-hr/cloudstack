{
  TemplateApiResult result=callback.getResult();
  TemplateInfo template=context.template;
  if (result.isFailed()) {
    _tmpltDao.remove(template.getId());
  }
 else {
    VMTemplateVO tmplt=this._tmpltDao.findById(template.getId());
    long accountId=tmplt.getAccountId();
    if (template.getSize() != null) {
      _resourceLimitMgr.incrementResourceCount(accountId,ResourceType.secondary_storage,template.getSize());
    }
  }
  return null;
}
