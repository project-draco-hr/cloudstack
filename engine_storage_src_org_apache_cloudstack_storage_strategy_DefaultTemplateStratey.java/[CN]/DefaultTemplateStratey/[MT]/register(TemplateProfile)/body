{
  VMTemplateHostVO vmTemplateHost=_templateImageStoreDao.findByHostTemplate(_ds.getId(),tp.getTemplateId());
  if (vmTemplateHost == null) {
    vmTemplateHost=new VMTemplateHostVO(_ds.getId(),tp.getTemplateId(),new Date(),0,VMTemplateStorageResourceAssoc.Status.NOT_DOWNLOADED,null,null,"jobid0000",null,tp.getUrl());
    _templateImageStoreDao.persist(vmTemplateHost);
  }
  DataStoreEndPointSelector dseps=_ds.getEndPointSelector();
  List<DataStoreEndPoint> eps=dseps.getEndPoints(StorageEvent.RegisterTemplate);
  Collections.shuffle(eps);
  DataStoreEndPoint ep=eps.get(0);
  _driver.register(tp,ep);
  return null;
}
