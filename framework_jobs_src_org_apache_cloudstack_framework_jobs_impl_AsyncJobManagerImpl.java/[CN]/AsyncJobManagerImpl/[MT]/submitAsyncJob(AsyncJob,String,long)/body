{
  Transaction txt=Transaction.currentTxn();
  try {
    @SuppressWarnings("rawtypes") GenericDao dao=GenericDaoBase.getDao(job.getClass());
    txt.start();
    job.setInitMsid(getMsid());
    dao.persist(job);
    syncAsyncJobExecution(job,syncObjType,syncObjId,1);
    txt.commit();
    return job.getId();
  }
 catch (  Exception e) {
    String errMsg="Unable to schedule async job for command " + job.getCmd() + ", unexpected exception.";
    s_logger.warn(errMsg,e);
    throw new CloudRuntimeException(errMsg);
  }
}
