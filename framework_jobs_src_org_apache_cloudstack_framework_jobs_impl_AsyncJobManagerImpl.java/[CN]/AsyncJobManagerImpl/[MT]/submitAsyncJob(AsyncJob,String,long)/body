{
  try {
    @SuppressWarnings("rawtypes") final GenericDao dao=GenericDaoBase.getDao(job.getClass());
    return Transaction.execute(new TransactionCallback<Long>(){
      @Override public Long doInTransaction(      TransactionStatus status){
        job.setInitMsid(getMsid());
        dao.persist(job);
        publishOnEventBus(job,"submit");
        syncAsyncJobExecution(job,syncObjType,syncObjId,1);
        return job.getId();
      }
    }
);
  }
 catch (  Exception e) {
    String errMsg="Unable to schedule async job for command " + job.getCmd() + ", unexpected exception.";
    s_logger.warn(errMsg,e);
    throw new CloudRuntimeException(errMsg);
  }
}
