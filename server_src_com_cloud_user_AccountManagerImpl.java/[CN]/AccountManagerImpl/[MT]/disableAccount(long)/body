{
  boolean success=false;
  if (accountId <= 2) {
    if (s_logger.isInfoEnabled()) {
      s_logger.info("disableAccount -- invalid account id: " + accountId);
    }
    return false;
  }
  AccountVO account=_accountDao.findById(accountId);
  if ((account == null) || (account.getState().equals(State.disabled) && !account.getNeedsCleanup())) {
    success=true;
  }
 else {
    AccountVO acctForUpdate=_accountDao.createForUpdate();
    acctForUpdate.setState(State.disabled);
    success=_accountDao.update(Long.valueOf(accountId),acctForUpdate);
    if (success) {
      if (!doDisableAccount(accountId)) {
        s_logger.warn("Failed to disable account " + account + " resources as a part of disableAccount call, marking the account for cleanup");
        _accountDao.markForCleanup(accountId);
      }
    }
  }
  return success;
}
