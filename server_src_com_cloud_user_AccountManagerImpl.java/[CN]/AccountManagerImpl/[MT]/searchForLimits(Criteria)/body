{
  Long id=(Long)c.getCriteria(Criteria.ID);
  Long domainId=(Long)c.getCriteria(Criteria.DOMAINID);
  Long accountId=(Long)c.getCriteria(Criteria.ACCOUNTID);
  ResourceType type=(ResourceType)c.getCriteria(Criteria.TYPE);
  List<ResourceLimitVO> limits=new ArrayList<ResourceLimitVO>();
  if ((accountId != null) && (domainId != null)) {
    if (domainId == DomainVO.ROOT_DOMAIN) {
      AccountVO account=_accountDao.findById(accountId);
      if ((account != null) && (account.getType() == 1)) {
        limits=_resourceLimitDao.listAll();
        return limits;
      }
    }
  }
  if (accountId != null) {
    SearchBuilder<ResourceLimitVO> sb=_resourceLimitDao.createSearchBuilder();
    sb.and("accountId",sb.entity().getAccountId(),SearchCriteria.Op.EQ);
    sb.and("type",sb.entity().getType(),SearchCriteria.Op.EQ);
    sb.and("id",sb.entity().getId(),SearchCriteria.Op.EQ);
    SearchCriteria<ResourceLimitVO> sc=sb.create();
    if (accountId != null) {
      sc.setParameters("accountId",accountId);
    }
    if (type != null) {
      sc.setParameters("type",type);
    }
    if (id != null) {
      sc.setParameters("id",id);
    }
    if (type == null) {
      List<ResourceLimitVO> userLimits=_resourceLimitDao.listByAccountId(accountId);
      List<ResourceLimitVO> rootLimits=_resourceLimitDao.listByDomainId(DomainVO.ROOT_DOMAIN);
      ResourceType resourceTypes[]=ResourceType.values();
      for (      ResourceType resourceType : resourceTypes) {
        boolean found=false;
        for (        ResourceLimitVO userLimit : userLimits) {
          if (userLimit.getType() == resourceType) {
            limits.add(userLimit);
            found=true;
            break;
          }
        }
        if (!found) {
          for (          ResourceLimitVO rootLimit : rootLimits) {
            if (rootLimit.getType() == resourceType) {
              limits.add(rootLimit);
              found=true;
              break;
            }
          }
        }
        if (!found) {
          limits.add(new ResourceLimitVO(domainId,accountId,resourceType,-1L));
        }
      }
    }
 else {
      AccountVO account=_accountDao.findById(accountId);
      limits.add(new ResourceLimitVO(null,accountId,type,findCorrectResourceLimit(account.getId(),type)));
    }
  }
 else   if (domainId != null) {
    if (type == null) {
      ResourceType resourceTypes[]=ResourceType.values();
      List<ResourceLimitVO> domainLimits=_resourceLimitDao.listByDomainId(domainId);
      for (      ResourceType resourceType : resourceTypes) {
        boolean found=false;
        for (        ResourceLimitVO domainLimit : domainLimits) {
          if (domainLimit.getType() == resourceType) {
            limits.add(domainLimit);
            found=true;
            break;
          }
        }
        if (!found) {
          limits.add(new ResourceLimitVO(domainId,null,resourceType,-1L));
        }
      }
    }
 else {
      limits.add(_resourceLimitDao.findByDomainIdAndType(domainId,type));
    }
  }
  return limits;
}
