{
  long max=-1;
  ResourceLimitVO limit=_resourceLimitDao.findByDomainIdAndType(domain.getId(),type);
  if (limit != null) {
    max=limit.getMax().longValue();
  }
 else {
    Long domainId=domain.getParent();
    while ((domainId != null) && (limit == null)) {
      limit=_resourceLimitDao.findByDomainIdAndType(domainId,type);
      DomainVO tmpDomain=_domainDao.findById(domainId);
      domainId=tmpDomain.getParent();
    }
    if (limit != null) {
      max=limit.getMax().longValue();
    }
  }
  return max;
}
