{
  List<UserVmVO> vms=_userVmDao.listByAccountId(accountId);
  boolean success=true;
  for (  UserVmVO vm : vms) {
    try {
      success=(success && _vmMgr.stop(vm));
    }
 catch (    AgentUnavailableException aue) {
      s_logger.warn("Agent running on host " + vm.getHostId() + " is unavailable, unable to stop vm "+ vm.getName());
      success=false;
    }
  }
  List<DomainRouterVO> routers=_routerDao.listBy(accountId);
  for (  DomainRouterVO router : routers) {
    success=(success && _routerMgr.stopRouterInternal(router.getId()));
  }
  return success;
}
