{
  if (isAdmin(caller.getType())) {
    if (domainId == null && accountName != null) {
      throw new InvalidParameterValueException("accountName and domainId might be specified together");
    }
 else     if (domainId != null) {
      Domain domain=_domainMgr.getDomain(domainId);
      if (domain == null) {
        throw new InvalidParameterValueException("Unable to find the domain by id=" + domainId);
      }
      checkAccess(caller,domain);
      if (accountName != null) {
        Account owner=getActiveAccountByName(accountName,domainId);
        if (owner == null) {
          throw new InvalidParameterValueException("Unable to find account with name " + accountName + " in domain id="+ domainId);
        }
      }
    }
  }
 else   if (accountName != null && domainId != null) {
    if (!accountName.equals(caller.getAccountName()) || domainId.longValue() != caller.getDomainId()) {
      throw new PermissionDeniedException("Can't list port forwarding rules for account " + accountName + " in domain "+ domainId+ ", permission denied");
    }
  }
 else {
    accountName=caller.getAccountName();
    domainId=caller.getDomainId();
  }
  return new Pair<String,Long>(accountName,domainId);
}
