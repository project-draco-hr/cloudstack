{
  if (this.closed)   return;
  LogLog.debug("Closing appender [" + name + "].");
  this.closed=true;
  try {
    if (topicSession != null)     topicSession.close();
    if (topicConnection != null)     topicConnection.close();
  }
 catch (  JMSException e) {
    LogLog.error("Error while closing JMSAppender [" + name + "].",e);
  }
catch (  RuntimeException e) {
    LogLog.error("Error while closing JMSAppender [" + name + "].",e);
  }
  topicPublisher=null;
  topicSession=null;
  topicConnection=null;
}
