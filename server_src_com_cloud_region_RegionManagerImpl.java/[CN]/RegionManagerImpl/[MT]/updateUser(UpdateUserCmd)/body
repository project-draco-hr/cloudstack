{
  long id=cmd.getId();
  UserVO user=_userDao.findById(id);
  if (user == null) {
    throw new InvalidParameterValueException("The specified user doesn't exist in the system");
  }
  String userUUID=user.getUuid();
  StringBuffer params=new StringBuffer("/api?command=updateUser");
  params.append("&" + ApiConstants.ID + "="+ userUUID);
  if (cmd.getApiKey() != null) {
    params.append("&" + ApiConstants.API_KEY + "="+ cmd.getApiKey());
  }
  if (cmd.getEmail() != null) {
    params.append("&" + ApiConstants.EMAIL + "="+ cmd.getEmail());
  }
  if (cmd.getFirstname() != null) {
    params.append("&" + ApiConstants.FIRSTNAME + "="+ cmd.getFirstname());
  }
  if (cmd.getLastname() != null) {
    params.append("&" + ApiConstants.LASTNAME + "="+ cmd.getLastname());
  }
  if (cmd.getPassword() != null) {
    params.append("&" + ApiConstants.PASSWORD + "="+ cmd.getPassword());
  }
  if (cmd.getSecretKey() != null) {
    params.append("&" + ApiConstants.SECRET_KEY + "="+ cmd.getSecretKey());
  }
  if (cmd.getTimezone() != null) {
    params.append("&" + ApiConstants.TIMEZONE + "="+ cmd.getTimezone());
  }
  if (cmd.getUsername() != null) {
    params.append("&" + ApiConstants.USERNAME + "="+ cmd.getUsername());
  }
  long regionId=user.getRegionId();
  if (getId() == regionId) {
    UserAccount updateUser=_accountMgr.updateUser(cmd);
    if (updateUser != null) {
      List<RegionVO> regions=_regionDao.listAll();
      for (      Region region : regions) {
        if (region.getId() == getId()) {
          continue;
        }
        String url=region.getEndPoint() + params + "&"+ ApiConstants.IS_PROPAGATE+ "=true";
        if (makeAPICall(url)) {
          s_logger.debug("Successfully updated user :" + userUUID + " in Region: "+ region.getId());
        }
 else {
          s_logger.error("Error while updating user :" + userUUID + " in Region: "+ region.getId());
        }
      }
    }
    return updateUser;
  }
 else {
    Region region=_regionDao.findById(regionId);
    String url=region.getEndPoint() + params;
    if (makeAPICall(url)) {
      s_logger.debug("Successfully updated user :" + userUUID + " in source Region: "+ region.getId());
      return null;
    }
 else {
      s_logger.error("Error while updating user :" + userUUID + " in source Region: "+ region.getId());
      return null;
    }
  }
}
