def do_POST(self):
    form = cgi.FieldStorage(fp=self.rfile, headers=self.headers, environ={'REQUEST_METHOD': 'POST', 'CONTENT_TYPE': self.headers['Content-Type'], })
    self.send_response(200)
    self.end_headers()
    clientAddress = self.client_address[0]
    if (clientAddress not in ['localhost', '127.0.0.1']):
        syslog.syslog(('serve_password: non-localhost IP trying to save password: %s' % clientAddress))
        self.send_response(403)
        return
    if (('ip' not in form) or ('password' not in form) or ('token' not in form) or (self.headers.get('DomU_Request') != 'save_password')):
        syslog.syslog('serve_password: request trying to save password does not contain both ip and password')
        self.send_response(403)
        return
    token = form['token'].value
    if (not checkToken(token)):
        syslog.syslog(('serve_password: invalid save_password token received from %s' % clientAddress))
        self.send_response(403)
        return
    ip = form['ip'].value
    password = form['password'].value
    if ((not ip) or (not password)):
        syslog.syslog(('serve_password: empty ip/password[%s/%s] received from savepassword' % (ip, password)))
        return
    setPassword(ip, password)
    savePasswordFile()
    return
