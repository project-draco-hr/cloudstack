{
  MD5UserAuthenticator authenticator=new MD5UserAuthenticator();
  Field daoField=MD5UserAuthenticator.class.getDeclaredField("_userAccountDao");
  daoField.setAccessible(true);
  daoField.set(authenticator,dao);
  UserAccountVO account=new UserAccountVO();
  account.setPassword("surprise");
  Mockito.when(dao.getUserAccount(Mockito.anyString(),Mockito.anyLong())).thenReturn(account);
  Pair<Boolean,ActionOnFailedAuthentication> pair=authenticator.authenticate("admin","password",1l,null);
  Assert.assertFalse(pair.first());
}
