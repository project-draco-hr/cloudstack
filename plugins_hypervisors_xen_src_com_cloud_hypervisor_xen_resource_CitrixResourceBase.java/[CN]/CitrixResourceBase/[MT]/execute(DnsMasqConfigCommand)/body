{
  Connection conn=getConnection();
  String routerIp=cmd.getAccessDetail(NetworkElementCommand.ROUTER_IP);
  DnsMasqConfigurator configurator=new DnsMasqConfigurator();
  String[] config=configurator.generateConfiguration(cmd);
  String tmpConfigFilePath="/tmp/" + routerIp.replace(".","-") + ".cfg";
  String tmpConfigFileContents="";
  for (int i=0; i < config.length; i++) {
    tmpConfigFileContents+=config[i];
    tmpConfigFileContents+="\n";
  }
  String result=callHostPlugin(conn,"vmops","createFileInDomr","filepath",tmpConfigFilePath,"filecontents",tmpConfigFileContents,"domrip",routerIp);
  if (result == null || result.isEmpty()) {
    return new Answer(cmd,false,"DnsMasqConfigCommand failed to create DnsMasq cfg file.");
  }
  result=callHostPlugin(conn,"vmops","configdnsmasq","routerip",routerIp,"filepath",tmpConfigFilePath);
  if (result == null || result.isEmpty()) {
    return new Answer(cmd,false,"DnsMasqconfigCommand failed");
  }
  return new Answer(cmd);
}
