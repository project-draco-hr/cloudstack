{
  Connection conn=getConnection();
  List<String> vmNames=cmd.getVmNames();
  HashMap<String,List<VmDiskStatsEntry>> vmDiskStatsNameMap=new HashMap<String,List<VmDiskStatsEntry>>();
  if (vmNames.size() == 0) {
    return new GetVmDiskStatsAnswer(cmd,"",cmd.getHostName(),vmDiskStatsNameMap);
  }
  try {
    List<String> vmUUIDs=new ArrayList<String>();
    for (    String vmName : vmNames) {
      VM vm=getVM(conn,vmName);
      vmUUIDs.add(vm.getUuid(conn));
    }
    HashMap<String,List<VmDiskStatsEntry>> vmDiskStatsUUIDMap=getVmDiskStats(conn,cmd,vmUUIDs,cmd.getHostGuid());
    if (vmDiskStatsUUIDMap == null) {
      return new GetVmDiskStatsAnswer(cmd,"",cmd.getHostName(),vmDiskStatsNameMap);
    }
    for (    String vmUUID : vmDiskStatsUUIDMap.keySet()) {
      List<VmDiskStatsEntry> vmDiskStatsUUID=vmDiskStatsUUIDMap.get(vmUUID);
      String vmName=vmNames.get(vmUUIDs.indexOf(vmUUID));
      for (      VmDiskStatsEntry vmDiskStat : vmDiskStatsUUID) {
        vmDiskStat.setVmName(vmName);
      }
      vmDiskStatsNameMap.put(vmName,vmDiskStatsUUID);
    }
    return new GetVmDiskStatsAnswer(cmd,"",cmd.getHostName(),vmDiskStatsNameMap);
  }
 catch (  XenAPIException e) {
    String msg="Unable to get VM disk stats" + e.toString();
    s_logger.warn(msg,e);
    return new GetVmDiskStatsAnswer(cmd,"",cmd.getHostName(),vmDiskStatsNameMap);
  }
catch (  XmlRpcException e) {
    String msg="Unable to get VM disk stats" + e.getMessage();
    s_logger.warn(msg,e);
    return new GetVmDiskStatsAnswer(cmd,"",cmd.getHostName(),vmDiskStatsNameMap);
  }
}
