{
  Connection conn=getConnection();
  String routerIp=cmd.getAccessDetail(NetworkElementCommand.ROUTER_IP);
  String[] results=new String[cmd.getRules().length];
  int i=0;
  boolean endResult=true;
  for (  PortForwardingRuleTO rule : cmd.getRules()) {
    String args="vpc_portforwarding.sh " + routerIp;
    args+=rule.revoked() ? " -D" : " -A";
    args+=" -P " + rule.getProtocol().toLowerCase();
    args+=" -l " + rule.getSrcIp();
    args+=" -p " + rule.getStringSrcPortRange();
    args+=" -r " + rule.getDstIp();
    args+=" -d " + rule.getStringDstPortRange().replace(":","-");
    String result=callHostPlugin(conn,"vmops","routerProxy","args",args.toString());
    if (result == null || result.isEmpty()) {
      results[i++]="Failed";
      endResult=false;
    }
 else {
      results[i++]=null;
    }
  }
  return new SetPortForwardingRulesAnswer(cmd,results,endResult);
}
