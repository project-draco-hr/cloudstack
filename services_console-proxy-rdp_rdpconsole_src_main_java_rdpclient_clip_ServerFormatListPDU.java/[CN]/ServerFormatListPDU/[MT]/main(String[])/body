{
  System.setProperty("streamer.Element.debug","true");
  byte[] packet=new byte[]{0x02,0x00,0x00,0x00,(byte)0xe0,0x00,0x00,0x00,(byte)0x8a,(byte)0xc0,0x00,0x00,0x52,0x00,0x69,0x00,0x63,0x00,0x68,0x00,0x20,0x00,0x54,0x00,0x65,0x00,0x78,0x00,0x74,0x00,0x20,0x00,0x46,0x00,0x6f,0x00,0x72,0x00,0x6d,0x00,0x61,0x00,0x74,0x00,0x00,0x00,0x45,(byte)0xc1,0x00,0x00,0x52,0x00,0x69,0x00,0x63,0x00,0x68,0x00,0x20,0x00,0x54,0x00,0x65,0x00,0x78,0x00,0x74,0x00,0x20,0x00,0x46,0x00,0x6f,0x00,0x72,0x00,0x6d,0x00,0x61,0x00,0x74,0x00,0x20,0x00,0x57,0x00,0x69,0x00,0x74,0x00,0x68,0x00,0x6f,0x00,0x75,0x00,0x74,0x00,0x20,0x00,0x4f,0x00,0x62,0x00,0x6a,0x00,0x65,0x00,0x63,0x00,0x74,0x00,0x73,0x00,0x00,0x00,0x43,(byte)0xc1,0x00,0x00,0x52,0x00,0x54,0x00,0x46,0x00,0x20,0x00,0x41,0x00,0x73,0x00,0x20,0x00,0x54,0x00,0x65,0x00,0x78,0x00,0x74,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x0d,0x00,0x00,0x00,0x00,0x00,0x04,(byte)0xc0,0x00,0x00,0x4e,0x00,0x61,0x00,0x74,0x00,0x69,0x00,0x76,0x00,0x65,0x00,0x00,0x00,0x0e,(byte)0xc0,0x00,0x00,0x4f,0x00,0x62,0x00,0x6a,0x00,0x65,0x00,0x63,0x00,0x74,0x00,0x20,0x00,0x44,0x00,0x65,0x00,0x73,0x00,0x63,0x00,0x72,0x00,0x69,0x00,0x70,0x00,0x74,0x00,0x6f,0x00,0x72,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x00,0x00};
  MockSource source=new MockSource("source",ByteBuffer.convertByteArraysToByteBuffers(packet));
  Element router=new ServerClipRdrChannelRouter("router");
  ClipboardState state=new ClipboardState();
  state.serverUseLongFormatNames=true;
  Element format_list=new ServerFormatListPDU("format_list",state);
  Element sink=new MockSink("sink",ByteBuffer.convertByteArraysToByteBuffers(new byte[]{0x03,0x00,0x01,0x00,0x00,0x00,0x00,0x00},new byte[]{0x04,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x0d,0x00,0x00,0x00}));
  Pipeline pipeline=new PipelineImpl("test");
  pipeline.add(source,router,format_list,sink);
  pipeline.link("source","router >format_list","format_list","sink");
  pipeline.runMainLoop("source",STDOUT,false,false);
  if (!(state.serverClipboardDataFormats.containsKey(49475) && state.serverClipboardDataFormats.containsKey("Rich Text Format")))   throw new RuntimeException("Server format list packet parsed incorrectly.");
}
