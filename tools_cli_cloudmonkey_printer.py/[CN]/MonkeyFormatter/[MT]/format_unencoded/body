def format_unencoded(self, tokensource, outfile):
    for (ttype, value) in tokensource:
        color = self.colorscheme.get(ttype)
        while (color is None):
            ttype = ttype[:(-1)]
            color = self.colorscheme.get(ttype)
        if color:
            spl = value.split('\n')
            for line in spl[:(-1)]:
                if line:
                    outfile.write(ansiformat(color, line))
                outfile.write('\n')
            if spl[(-1)]:
                outfile.write(ansiformat(color, spl[(-1)]))
        else:
            outfile.write(value)
