@attr('simulator_only', tags=['advanced', 'basic'], required_hardware='false')
def test_04_pt_startvm_false_attach_disk(self):
    ' Positive test for stopped VM test path - T3 and variant, T9\n\n        # 1.  Deploy VM in the network with specifying startvm parameter\n        #     as False\n        # 2.  List VMs and verify that VM is in stopped state\n        # 3.  Create a data disk and attach it to VM\n        # 4.  Now detach the disk from the VM\n        # 5.  Verify that attach and detach operations are successful\n        # 6.  Deploy another VM in the account with startVM = False\n        # 7.  Attach the same volume to this VM\n        # 8.  Detach the volume\n        # 9.  Both attach and detach operations should be successful\n        '
    disk_offering = DiskOffering.create(self.apiclient, self.testdata['disk_offering'])
    self.cleanup.append(disk_offering)
    volume = Volume.create(self.apiclient, self.testdata['volume'], zoneid=self.zone.id, account=self.account.name, domainid=self.account.domainid, diskofferingid=disk_offering.id)
    self.cleanup.append(volume)
    virtual_machine = VirtualMachine.create(self.userapiclient, self.testdata['small'], templateid=self.defaultTemplateId, accountid=self.account.name, domainid=self.account.domainid, serviceofferingid=self.service_offering.id, networkids=([self.networkid] if self.networkid else None), zoneid=self.zone.id, startvm=False, mode=self.zone.networktype)
    self.cleanup.append(virtual_machine)
    response = virtual_machine.getState(self.apiclient, VirtualMachine.STOPPED)
    self.assertEqual(response[0], PASS, response[1])
    virtual_machine.attach_volume(self.userapiclient, volume=volume)
    volumes = Volume.list(self.userapiclient, virtualmachineid=virtual_machine.id, type='DATADISK', listall=True)
    self.assertEqual(validateList(volumes)[0], PASS, 'Volumes list validation failed')
    self.assertEqual(volumes[0].id, volume.id, 'Listed Volume id not matching with attached volume id')
    virtual_machine.detach_volume(self.userapiclient, volume)
    volumes = Volume.list(self.userapiclient, virtualmachineid=virtual_machine.id, type='DATADISK', listall=True)
    self.assertEqual(validateList(volumes)[0], FAIL, 'Detached volume should not be listed')
    virtual_machine_2 = VirtualMachine.create(self.userapiclient, self.testdata['small'], templateid=self.defaultTemplateId, accountid=self.account.name, domainid=self.account.domainid, serviceofferingid=self.service_offering.id, networkids=([self.networkid] if self.networkid else None), zoneid=self.zone.id, startvm=False, mode=self.zone.networktype)
    self.cleanup.append(virtual_machine_2)
    response = virtual_machine_2.getState(self.apiclient, VirtualMachine.STOPPED)
    self.assertEqual(response[0], PASS, response[1])
    virtual_machine_2.attach_volume(self.userapiclient, volume=volume)
    volumes = Volume.list(self.userapiclient, virtualmachineid=virtual_machine_2.id, type='DATADISK', listall=True)
    self.assertEqual(validateList(volumes)[0], PASS, 'Volumes list validation failed')
    self.assertEqual(volumes[0].id, volume.id, 'Listed Volume id not matching with attached volume id')
    virtual_machine_2.detach_volume(self.userapiclient, volume)
    volumes = Volume.list(self.userapiclient, virtualmachineid=virtual_machine_2.id, type='DATADISK', listall=True)
    self.assertEqual(validateList(volumes)[0], FAIL, 'Detached volume should not be listed')
    return
