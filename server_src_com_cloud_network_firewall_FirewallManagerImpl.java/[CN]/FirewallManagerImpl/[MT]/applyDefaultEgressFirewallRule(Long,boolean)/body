{
  if (defaultPolicy == false) {
    return true;
  }
  s_logger.debug("applying default firewall egress rules ");
  NetworkVO network=_networkDao.findById(networkId);
  List<String> sourceCidr=new ArrayList<String>();
  sourceCidr.add(NetUtils.ALL_CIDRS);
  FirewallRuleVO ruleVO=new FirewallRuleVO(null,null,null,null,"all",networkId,network.getAccountId(),network.getDomainId(),Purpose.Firewall,sourceCidr,null,null,null,FirewallRule.TrafficType.Egress,FirewallRuleType.System);
  List<FirewallRuleVO> rules=new ArrayList<FirewallRuleVO>();
  rules.add(ruleVO);
  try {
    if (!applyRules(rules,false,false)) {
      return false;
    }
  }
 catch (  ResourceUnavailableException ex) {
    s_logger.warn("Failed to apply default egress rules for guest network due to ",ex);
    return false;
  }
  return true;
}
