{
  FirewallRuleVO rule=_firewallDao.findById(ruleId);
  if (rule == null || rule.getPurpose() != Purpose.Firewall) {
    throw new InvalidParameterValueException("Unable to find " + ruleId + " having purpose "+ Purpose.Firewall);
  }
  _accountMgr.checkAccess(caller,rule);
  revokeRule(rule,caller,userId,false);
  boolean success=false;
  if (apply) {
    List<FirewallRuleVO> rules=_firewallDao.listByIpAndPurpose(rule.getSourceIpAddressId(),Purpose.Firewall);
    return applyFirewallRules(rules,false,caller);
  }
 else {
    success=true;
  }
  return success;
}
