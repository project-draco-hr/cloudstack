{
  List<FirewallRuleVO> rules=_firewallDao.listByIpPurposeAndProtocolAndNotRevoked(ipAddrId,startPort,endPort,protocol,Purpose.Firewall);
  if (!rules.isEmpty()) {
    return rules.get(0);
  }
  return createFirewallRule(ipAddrId,caller,null,startPort,endPort,protocol,icmpCode,icmpType);
}
