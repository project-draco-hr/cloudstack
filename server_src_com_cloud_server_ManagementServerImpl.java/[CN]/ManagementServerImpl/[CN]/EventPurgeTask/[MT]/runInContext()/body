{
  try {
    final GlobalLock lock=GlobalLock.getInternLock("EventPurge");
    if (lock == null) {
      logger.debug("Couldn't get the global lock");
      return;
    }
    if (!lock.lock(30)) {
      logger.debug("Couldn't lock the db");
      return;
    }
    try {
      final Calendar purgeCal=Calendar.getInstance();
      purgeCal.add(Calendar.DAY_OF_YEAR,-_purgeDelay);
      final Date purgeTime=purgeCal.getTime();
      logger.debug("Deleting events older than: " + purgeTime.toString());
      final List<EventVO> oldEvents=_eventDao.listOlderEvents(purgeTime);
      logger.debug("Found " + oldEvents.size() + " events to be purged");
      for (      final EventVO event : oldEvents) {
        _eventDao.expunge(event.getId());
      }
    }
 catch (    final Exception e) {
      logger.error("Exception ",e);
    }
 finally {
      lock.unlock();
    }
  }
 catch (  final Exception e) {
    logger.error("Exception ",e);
  }
}
