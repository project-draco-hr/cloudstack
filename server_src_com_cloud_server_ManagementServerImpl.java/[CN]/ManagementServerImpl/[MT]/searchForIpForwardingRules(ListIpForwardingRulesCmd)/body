{
  String ipAddress=cmd.getPublicIpAddress();
  Filter searchFilter=new Filter(FirewallRuleVO.class,"id",true,cmd.getStartIndex(),cmd.getPageSizeVal());
  SearchCriteria<FirewallRuleVO> sc=_firewallRulesDao.createSearchCriteria();
  if (ipAddress != null) {
    sc.addAnd("publicIpAddress",SearchCriteria.Op.EQ,ipAddress);
  }
  sc.addAnd("protocol",SearchCriteria.Op.EQ,NetUtils.NAT_PROTO);
  return _firewallRulesDao.search(sc,searchFilter);
}
