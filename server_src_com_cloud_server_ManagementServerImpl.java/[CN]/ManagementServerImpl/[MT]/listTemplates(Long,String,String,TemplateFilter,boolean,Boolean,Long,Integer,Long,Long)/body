{
  VMTemplateVO template=null;
  if (templateId != null) {
    template=_templateDao.findById(templateId);
    if (template == null) {
      throw new InvalidParameterValueException("Please specify a valid template ID.");
    }
  }
  Account account=null;
  DomainVO domain=null;
  if (accountId != null) {
    account=_accountDao.findById(accountId);
    domain=_domainDao.findById(account.getDomainId());
  }
 else {
    domain=_domainDao.findById(DomainVO.ROOT_DOMAIN);
  }
  List<VMTemplateVO> templates=new ArrayList<VMTemplateVO>();
  if (template == null) {
    templates=_templateDao.searchTemplates(name,keyword,templateFilter,isIso,bootable,account,domain,pageSize,startIndex,zoneId);
  }
 else {
    templates=new ArrayList<VMTemplateVO>();
    templates.add(template);
  }
  return templates;
}
