{
  Account account=UserContext.current().getCaller();
  SSHKeyPairVO s=_sshKeyPairDao.findByName(account.getAccountId(),account.getDomainId(),cmd.getName());
  if (s != null)   throw new InvalidParameterValueException("A key pair with name '" + cmd.getName() + "' already exists.");
  SSHKeysHelper keys=new SSHKeysHelper();
  String name=cmd.getName();
  String publicKey=keys.getPublicKey();
  String fingerprint=keys.getPublicKeyFingerPrint();
  String privateKey=keys.getPrivateKey();
  return createAndSaveSSHKeyPair(name,fingerprint,publicKey,privateKey);
}
