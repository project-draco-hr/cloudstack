{
  Account account=UserContext.current().getCaller();
  SSHKeyPairVO s=_sshKeyPairDao.findByName(account.getAccountId(),account.getDomainId(),cmd.getName());
  if (s != null)   throw new InvalidParameterValueException("A key pair with name '" + cmd.getName() + "' already exists.");
  String name=cmd.getName();
  String publicKey=SSHKeysHelper.getPublicKeyFromKeyMaterial(cmd.getPublicKey());
  String fingerprint=SSHKeysHelper.getPublicKeyFingerprint(publicKey);
  if (publicKey == null)   throw new InvalidParameterValueException("Public key is invalid");
  return createAndSaveSSHKeyPair(name,fingerprint,publicKey,null);
}
