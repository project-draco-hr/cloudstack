{
  final Account owner=getOwner(cmd);
  checkForKeyByName(cmd,owner);
  checkForKeyByPublicKey(cmd,owner);
  final String name=cmd.getName();
  String key=cmd.getPublicKey();
  try {
    key=URLDecoder.decode(key,"UTF-8");
  }
 catch (  final UnsupportedEncodingException e) {
    s_logger.warn("key decoding tried invain: " + e.getLocalizedMessage());
  }
  final String publicKey=getPublicKeyFromKeyKeyMaterial(key);
  final String fingerprint=getFingerprint(publicKey);
  return createAndSaveSSHKeyPair(name,fingerprint,publicKey,null,owner);
}
