{
  Filter searchFilter=new Filter(SnapshotVO.class,c.getOrderBy(),c.getAscending(),c.getOffset(),c.getLimit());
  SearchCriteria<SnapshotVO> sc=_snapshotDao.createSearchCriteria();
  Object volumeId=c.getCriteria(Criteria.VOLUMEID);
  Object name=c.getCriteria(Criteria.NAME);
  Object id=c.getCriteria(Criteria.ID);
  Object keyword=c.getCriteria(Criteria.KEYWORD);
  Object accountId=c.getCriteria(Criteria.ACCOUNTID);
  Object snapshotTypeStr=c.getCriteria(Criteria.TYPE);
  sc.addAnd("status",SearchCriteria.Op.EQ,Snapshot.Status.BackedUp);
  if (volumeId != null) {
    sc.addAnd("volumeId",SearchCriteria.Op.EQ,volumeId);
  }
  if (name != null) {
    sc.addAnd("name",SearchCriteria.Op.LIKE,"%" + name + "%");
  }
  if (id != null) {
    sc.addAnd("id",SearchCriteria.Op.EQ,id);
  }
  if (keyword != null) {
    SearchCriteria<SnapshotVO> ssc=_snapshotDao.createSearchCriteria();
    ssc.addOr("name",SearchCriteria.Op.LIKE,"%" + keyword + "%");
    sc.addAnd("name",SearchCriteria.Op.SC,ssc);
  }
  if (accountId != null) {
    sc.addAnd("accountId",SearchCriteria.Op.EQ,accountId);
  }
  if (snapshotTypeStr != null) {
    SnapshotType snapshotType=SnapshotVO.getSnapshotType((String)snapshotTypeStr);
    if (snapshotType == null) {
      throw new InvalidParameterValueException("Unsupported snapshot type " + snapshotTypeStr);
    }
    sc.addAnd("snapshotType",SearchCriteria.Op.EQ,snapshotType.ordinal());
  }
 else {
    sc.addAnd("snapshotType",SearchCriteria.Op.NEQ,Snapshot.SnapshotType.TEMPLATE.ordinal());
  }
  return _snapshotDao.search(sc,searchFilter);
}
