{
  String podName=cmd.getPodName();
  Long id=cmd.getId();
  Long zoneId=cmd.getZoneId();
  Object keyword=cmd.getKeyword();
  Object allocationState=cmd.getAllocationState();
  String zoneType=cmd.getZoneType();
  zoneId=_accountMgr.checkAccessAndSpecifyAuthority(UserContext.current().getCaller(),zoneId);
  Filter searchFilter=new Filter(HostPodVO.class,"dataCenterId",true,cmd.getStartIndex(),cmd.getPageSizeVal());
  SearchBuilder<HostPodVO> sb=_hostPodDao.createSearchBuilder();
  sb.and("id",sb.entity().getId(),SearchCriteria.Op.EQ);
  sb.and("name",sb.entity().getName(),SearchCriteria.Op.LIKE);
  sb.and("dataCenterId",sb.entity().getDataCenterId(),SearchCriteria.Op.EQ);
  sb.and("allocationState",sb.entity().getAllocationState(),SearchCriteria.Op.EQ);
  if (zoneType != null) {
    SearchBuilder<DataCenterVO> zoneSb=_dcDao.createSearchBuilder();
    zoneSb.and("zoneNetworkType",zoneSb.entity().getNetworkType(),SearchCriteria.Op.EQ);
    sb.join("zoneSb",zoneSb,sb.entity().getDataCenterId(),zoneSb.entity().getId(),JoinBuilder.JoinType.INNER);
  }
  SearchCriteria<HostPodVO> sc=sb.create();
  if (keyword != null) {
    SearchCriteria<HostPodVO> ssc=_hostPodDao.createSearchCriteria();
    ssc.addOr("name",SearchCriteria.Op.LIKE,"%" + keyword + "%");
    ssc.addOr("description",SearchCriteria.Op.LIKE,"%" + keyword + "%");
    sc.addAnd("name",SearchCriteria.Op.SC,ssc);
  }
  if (id != null) {
    sc.setParameters("id",id);
  }
  if (podName != null) {
    sc.setParameters("name","%" + podName + "%");
  }
  if (zoneId != null) {
    sc.setParameters("dataCenterId",zoneId);
  }
  if (allocationState != null) {
    sc.setParameters("allocationState",allocationState);
  }
  if (zoneType != null) {
    sc.setJoinParameters("zoneSb","zoneNetworkType",zoneType);
  }
  Pair<List<HostPodVO>,Integer> result=_hostPodDao.searchAndCount(sc,searchFilter);
  return new Pair<List<? extends Pod>,Integer>(result.first(),result.second());
}
