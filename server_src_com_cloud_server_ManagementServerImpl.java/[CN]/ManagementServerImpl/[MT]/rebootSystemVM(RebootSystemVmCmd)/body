{
  VMInstanceVO systemVm=_vmInstanceDao.findByIdTypes(cmd.getId(),VirtualMachine.Type.ConsoleProxy,VirtualMachine.Type.SecondaryStorageVm);
  if (systemVm == null) {
    throw new ServerApiException(BaseCmd.PARAM_ERROR,"unable to find a system vm with id " + cmd.getId());
  }
  if (systemVm.getType().equals(VirtualMachine.Type.ConsoleProxy)) {
    long eventId=EventUtils.saveScheduledEvent(User.UID_SYSTEM,Account.ACCOUNT_ID_SYSTEM,EventTypes.EVENT_PROXY_REBOOT,"Rebooting console proxy with Id: " + cmd.getId());
    return rebootConsoleProxy(cmd.getId(),eventId);
  }
 else {
    long eventId=EventUtils.saveScheduledEvent(User.UID_SYSTEM,Account.ACCOUNT_ID_SYSTEM,EventTypes.EVENT_SSVM_REBOOT,"Rebooting secondary storage vm with Id: " + cmd.getId());
    return rebootSecondaryStorageVm(cmd.getId(),eventId);
  }
}
