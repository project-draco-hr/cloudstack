{
  Map<String,Object> capabilities=new HashMap<String,Object>();
  boolean securityGroupsEnabled=false;
  List<DataCenterVO> dc=_dcDao.listSecurityGroupEnabledZones();
  if (dc != null && !dc.isEmpty()) {
    securityGroupsEnabled=true;
  }
  String firewallRuleUiEnabled=_configs.get(Config.FirewallRuleUiEnabled.key());
  String userPublicTemplateEnabled=_configs.get(Config.AllowPublicUserTemplates.key());
  capabilities.put("securityGroupsEnabled",securityGroupsEnabled);
  capabilities.put("userPublicTemplateEnabled",(userPublicTemplateEnabled == null || userPublicTemplateEnabled.equals("false") ? false : true));
  capabilities.put("cloudStackVersion",getVersion());
  capabilities.put("firewallRuleUiEnabled",(firewallRuleUiEnabled != null && firewallRuleUiEnabled.equals("true")) ? true : false);
  return capabilities;
}
