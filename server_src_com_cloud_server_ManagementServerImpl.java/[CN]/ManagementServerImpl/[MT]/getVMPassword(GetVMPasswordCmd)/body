{
  Account caller=UserContext.current().getCaller();
  UserVmVO vm=_userVmDao.findById(cmd.getId());
  if (vm == null) {
    InvalidParameterValueException ex=new InvalidParameterValueException("No VM with specified id found.");
    String tablename=AnnotationHelper.getTableName(vm);
    if (tablename != null) {
      ex.addProxyObject(tablename,cmd.getId(),"vmId");
    }
 else {
      s_logger.info("\nCould not retrieve table name (annotation) from " + tablename + " VO proxy object\n");
    }
    throw ex;
  }
  _accountMgr.checkAccess(caller,null,true,vm);
  _userVmDao.loadDetails(vm);
  String password=vm.getDetail("Encrypted.Password");
  if (password == null || password.equals("")) {
    InvalidParameterValueException ex=new InvalidParameterValueException("No password for VM with specified id found.");
    String tablename=AnnotationHelper.getTableName(vm);
    if (tablename != null) {
      ex.addProxyObject(tablename,cmd.getId(),"vmId");
    }
 else {
      s_logger.info("\nCould not retrieve table name (annotation) from " + tablename + " VO proxy object\n");
    }
    throw ex;
  }
  return password;
}
