{
  Account caller=UserContext.current().getCaller();
  UserVmVO vm=_userVmDao.findById(cmd.getId());
  if (vm == null) {
    throw new InvalidParameterValueException("No VM with id '" + cmd.getId() + "' found.");
  }
  _accountMgr.checkAccess(caller,null,true,vm);
  _userVmDao.loadDetails(vm);
  String password=vm.getDetail("Encrypted.Password");
  if (password == null || password.equals("")) {
    throw new InvalidParameterValueException("No password for VM with id '" + cmd.getId() + "' found.");
  }
  return password;
}
