{
  @SuppressWarnings("rawtypes") Map<String,Adapter> adapters=ComponentContext.getApplicationContext().getBeansOfType(Adapter.class);
  Map<String,Object> params=new HashMap<String,Object>();
  for (  Adapter adapter : adapters.values()) {
    try {
      if (!ComponentContext.isPrimary(adapter,Adapter.class) || Manager.class.isAssignableFrom(ComponentContext.getTargetClass(adapter)))       continue;
      if (!adapter.configure(adapter.getClass().getSimpleName(),params)) {
        throw new CloudRuntimeException("Failed to start adapter: " + ComponentContext.getTargetClass(adapter).getName());
      }
      if (!adapter.start()) {
        throw new CloudRuntimeException("Failed to start adapter: " + ComponentContext.getTargetClass(adapter).getName());
      }
      if (adapter instanceof ManagementBean) {
        registerMBean((ManagementBean)adapter);
      }
    }
 catch (    Exception e) {
      s_logger.error("Problems to start manager:" + ComponentContext.getTargetClass(adapter).getName(),e);
      System.exit(1);
    }
  }
}
