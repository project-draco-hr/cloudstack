{
  Account caller=UserContext.current().getCaller();
  String accountName=cmd.getAccountName();
  Long domainId=cmd.getDomainId();
  Account owner=null;
  if (accountName != null) {
    if (domainId != null) {
      owner=_accountMgr.getActiveAccount(accountName,domainId);
    }
 else {
      throw new InvalidParameterValueException("DomainId has to be specified along with account");
    }
    _accountMgr.checkAccess(caller,owner);
  }
 else {
    owner=caller;
  }
  SSHKeyPairVO s=_sshKeyPairDao.findByName(owner.getAccountId(),owner.getDomainId(),cmd.getName());
  if (s == null) {
    throw new InvalidParameterValueException("A key pair with name '" + cmd.getName() + "' does not exist for account "+ owner.getAccountName()+ " in domain id="+ owner.getDomainId());
  }
  return _sshKeyPairDao.deleteByName(caller.getAccountId(),caller.getDomainId(),cmd.getName());
}
