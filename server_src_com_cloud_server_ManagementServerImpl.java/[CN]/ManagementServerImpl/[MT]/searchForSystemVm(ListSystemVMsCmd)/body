{
  Criteria c=new Criteria("id",Boolean.TRUE,cmd.getStartIndex(),cmd.getPageSizeVal());
  Long zoneId=_accountMgr.checkAccessAndSpecifyAuthority(UserContext.current().getCaller(),cmd.getZoneId());
  c.addCriteria(Criteria.KEYWORD,cmd.getKeyword());
  c.addCriteria(Criteria.ID,cmd.getId());
  c.addCriteria(Criteria.DATACENTERID,zoneId);
  c.addCriteria(Criteria.PODID,cmd.getPodId());
  c.addCriteria(Criteria.HOSTID,cmd.getHostId());
  c.addCriteria(Criteria.NAME,cmd.getSystemVmName());
  c.addCriteria(Criteria.STATE,cmd.getState());
  String type=cmd.getSystemVmType();
  List systemVMs=new ArrayList();
  if (type == null) {
    systemVMs.addAll(searchForConsoleProxy(c));
    systemVMs.addAll(searchForSecondaryStorageVm(c));
  }
 else   if ((type != null) && (type.equalsIgnoreCase("secondarystoragevm"))) {
    systemVMs.addAll(searchForSecondaryStorageVm(c));
  }
 else   if ((type != null) && (type.equalsIgnoreCase("consoleproxy"))) {
    systemVMs.addAll(searchForConsoleProxy(c));
  }
  return systemVMs;
}
