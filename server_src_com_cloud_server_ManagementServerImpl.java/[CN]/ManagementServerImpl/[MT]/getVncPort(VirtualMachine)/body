{
  if (vm.getHostId() == null) {
    s_logger.warn("VM " + vm.getHostName() + " does not have host, return -1 for its VNC port");
    return -1;
  }
  if (s_logger.isTraceEnabled())   s_logger.trace("Trying to retrieve VNC port from agent about VM " + vm.getHostName());
  GetVncPortAnswer answer=(GetVncPortAnswer)_agentMgr.easySend(vm.getHostId(),new GetVncPortCommand(vm.getId(),vm.getInstanceName()));
  int port=answer == null ? -1 : answer.getPort();
  if (s_logger.isTraceEnabled())   s_logger.trace("Retrieved VNC port about VM " + vm.getHostName() + " is "+ port);
  return port;
}
