{
  TemplateFilter isoFilter=TemplateFilter.valueOf(cmd.getIsoFilter());
  Long accountId=null;
  Account account=UserContext.current().getCaller();
  Long domainId=cmd.getDomainId();
  String accountName=cmd.getAccountName();
  if (accountName != null && domainId != null) {
    accountId=_accountMgr.finalizeOwner(account,accountName,domainId).getAccountId();
  }
 else {
    accountId=account.getId();
  }
  boolean isAccountSpecific=(account == null || isAdmin(account.getType())) && (accountName != null) && (domainId != null);
  HypervisorType hypervisorType=HypervisorType.getType(cmd.getHypervisor());
  return listTemplates(cmd.getId(),cmd.getIsoName(),cmd.getKeyword(),isoFilter,true,cmd.isBootable(),accountId,cmd.getPageSizeVal(),cmd.getStartIndex(),cmd.getZoneId(),hypervisorType,isAccountSpecific,true,cmd.listInReadyState());
}
