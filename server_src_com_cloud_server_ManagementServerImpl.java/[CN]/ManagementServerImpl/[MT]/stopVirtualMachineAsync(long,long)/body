{
  UserVmVO userVm=_userVmDao.findById(vmId);
  long eventId=saveScheduledEvent(userId,userVm.getAccountId(),EventTypes.EVENT_VM_STOP,"stopping Vm with Id: " + vmId);
  VMOperationParam param=new VMOperationParam(userId,userVm.getAccountId(),vmId,null,eventId);
  Gson gson=GsonHelper.getBuilder().create();
  AsyncJobVO job=new AsyncJobVO();
  job.setUserId(UserContext.current().getUserId());
  job.setAccountId(userVm.getAccountId());
  job.setCmd("StopVM");
  job.setCmdInfo(gson.toJson(param));
  job.setCmdOriginator(StartVMCmd.getResultObjectName());
  return _asyncMgr.submitAsyncJob(job,true);
}
