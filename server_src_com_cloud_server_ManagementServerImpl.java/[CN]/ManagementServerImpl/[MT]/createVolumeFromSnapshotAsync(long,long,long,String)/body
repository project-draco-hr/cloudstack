{
  SnapshotVO snapshot=_snapshotDao.findById(snapshotId);
  AccountVO account=_accountDao.findById(snapshot.getAccountId());
  if (_accountMgr.resourceLimitExceeded(account,ResourceType.volume)) {
    ResourceAllocationException rae=new ResourceAllocationException("Maximum number of volumes for account: " + account.getAccountName() + " has been exceeded.");
    rae.setResourceType("volume");
    throw rae;
  }
  return _snapMgr.createVolumeFromSnapshotAsync(userId,accountId,snapshotId,volumeName);
}
