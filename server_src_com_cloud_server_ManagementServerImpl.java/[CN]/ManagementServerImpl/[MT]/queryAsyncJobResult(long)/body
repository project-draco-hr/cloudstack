{
  AsyncJobVO job=_asyncMgr.getAsyncJob(jobId);
  if (job == null) {
    if (s_logger.isDebugEnabled())     s_logger.debug("queryAsyncJobResult error: Permission denied, invalid job id " + jobId);
    throw new PermissionDeniedException("Permission denied, invalid job id " + jobId);
  }
  if (!UserContext.current().isApiServer() && job.getAccountId() != UserContext.current().getAccountId()) {
    if (s_logger.isDebugEnabled())     s_logger.debug("Mismatched account id in job and user context, perform further securty check. job id: " + jobId + ", job owner account: "+ job.getAccountId()+ ", accound id in current context: "+ UserContext.current().getAccountId());
    Account account=_accountDao.findById(UserContext.current().getAccountId());
    if (account == null || account.getType() != Account.ACCOUNT_TYPE_ADMIN) {
      if (s_logger.isDebugEnabled()) {
        if (account == null)         s_logger.debug("queryAsyncJobResult error: Permission denied, account no long exist for account id in context, job id: " + jobId + ", accountId  "+ UserContext.current().getAccountId());
 else         s_logger.debug("queryAsyncJobResult error: Permission denied, invalid ownership for job " + jobId + ", job account owner: "+ job.getAccountId()+ ", account id in context: "+ UserContext.current().getAccountId());
      }
      throw new PermissionDeniedException("Permission denied, invalid job ownership, job id: " + jobId);
    }
  }
  return _asyncMgr.queryAsyncJobResult(jobId);
}
