{
  PreparedStatement volStoreInsert=null;
  PreparedStatement volStoreUpdate=null;
  try {
    volStoreInsert=conn.prepareStatement("INSERT INTO `cloud`.`volume_store_ref` (store_id,  volume_id, zone_id, created, last_updated, job_id, download_pct, size, physical_size, download_state, checksum, error_str, local_path, install_path, url, destroyed, state) select host_id, volume_id, zone_id, created, last_updated, job_id, download_pct, size, physical_size, download_state, checksum, error_str, local_path, install_path, url, destroyed, 'Allocated' from `cloud`.`volume_host_ref`");
    volStoreInsert.executeUpdate();
    volStoreUpdate=conn.prepareStatement("update `cloud`.`volume_store_ref` set state = 'Ready' where download_state = 'DOWNLOADED'");
    volStoreUpdate.executeUpdate();
  }
 catch (  SQLException e) {
    String msg="Unable to migrate volume_host_ref." + e.getMessage();
    s_logger.error(msg);
    throw new CloudRuntimeException(msg,e);
  }
 finally {
    try {
      if (volStoreInsert != null) {
        volStoreInsert.close();
      }
      if (volStoreUpdate != null) {
        volStoreUpdate.close();
      }
    }
 catch (    SQLException e) {
    }
  }
}
