{
  PrimaryDataStore dataStore=dataStoreMgr.getPrimaryDataStore(dataStoreId);
  if (dataStore == null) {
    throw new CloudRuntimeException("Can't find dataStoreId: " + dataStoreId);
  }
  if (dataStore.exists(volume)) {
    return volume;
  }
  VolumeObject vo=(VolumeObject)volume;
  vo.stateTransit(VolumeEvent.CreateRequested);
  try {
    VolumeInfo vi=dataStore.createVolume(vo,diskType);
    vo.stateTransit(VolumeEvent.OperationSucceeded);
    return vi;
  }
 catch (  Exception e) {
    vo.stateTransit(VolumeEvent.OperationFailed);
    throw new CloudRuntimeException(e.toString());
  }
}
