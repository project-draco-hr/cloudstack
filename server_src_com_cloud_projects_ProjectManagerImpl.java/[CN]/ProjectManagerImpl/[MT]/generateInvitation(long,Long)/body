{
  ProjectInvitationVO invite=_projectInvitationDao.findPendingByAccountIdProjectId(accountId,projectId);
  if (invite != null) {
    if (_projectInvitationDao.isActive(invite.getId(),_invitationTimeOut)) {
      throw new InvalidParameterValueException("There is already a pending invitation for account id=" + accountId + " to the project id="+ projectId);
    }
 else {
      if (invite.getState() == ProjectInvitation.State.Pending) {
        expireInvitation(invite);
      }
    }
  }
  return _projectInvitationDao.persist(new ProjectInvitationVO(projectId,accountId,_accountMgr.getAccount(accountId).getDomainId(),null,null));
}
