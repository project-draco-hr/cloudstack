{
  updateVolumePath(VolumeTOs);
  List<VMSnapshotVO> children=_vmSnapshotDao.listByParent(vmSnapshot.getId());
  for (  VMSnapshotVO child : children) {
    child.setParent(vmSnapshot.getParent());
    _vmSnapshotDao.persist(child);
  }
  VMSnapshotVO current=_vmSnapshotDao.findCurrentSnapshotByVmId(vmSnapshot.getVmId());
  if (current != null && current.getId() == vmSnapshot.getId() && vmSnapshot.getParent() != null) {
    VMSnapshotVO parent=_vmSnapshotDao.findById(vmSnapshot.getParent());
    parent.setCurrent(true);
    _vmSnapshotDao.persist(parent);
  }
  vmSnapshot.setCurrent(false);
  _vmSnapshotDao.persist(vmSnapshot);
}
