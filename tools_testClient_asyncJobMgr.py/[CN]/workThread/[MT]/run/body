def run(self):
    while True:
        job = self.inqueue.get()
        cmd = job.cmd
        cmdName = cmd.__class__.__name__
        responseName = cmdName.replace('Cmd', 'Response')
        responseInstance = self.connection.getclassFromName(cmd, responseName)
        jobstatus = jobStatus()
        jobId = None
        try:
            if (not cmd.isAsync):
                jobstatus.startTime = time.time()
                result = self.connection.make_request(cmd, responseInstance)
                jobstatus.result = result
                jobstatus.endTime = time.time()
            else:
                result = self.connection.make_request(cmd, responseInstance, True)
                jobId = self.connection.getAsyncJobId(responseInstance, result)
                result = self.connection.pollAsyncJob(cmd, responseInstance, jobId)
                jobstatus.result = result
            jobstatus.status = True
        except cloudstackException.cloudstackAPIException as e:
            jobstatus.result = str(e)
            jobstatus.status = False
        except:
            jobstatus.status = False
            jobstatus.result = sys.exc_info()
        if ((self.db is not None) and (jobId is not None)):
            result = self.db.execute(('select created, last_updated from async_job where id=%s' % jobId))
            if ((result is not None) and (len(result) > 0)):
                jobstatus.startTime = result[0][0]
                jobstatus.endTime = result[0][1]
                delta = (jobstatus.endTime - jobstatus.startTime)
                jobstatus.duration = delta.total_seconds()
        self.output.lock.acquire()
        self.output.dict[job.id] = jobstatus
        self.output.lock.release()
        self.inqueue.task_done()
