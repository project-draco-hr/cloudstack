{
  LOGGER.debug(format("Listing S3 directory %1$s in bucket %2$s",directory,bucketName));
  List<S3ObjectSummary> objects=new ArrayList<>();
  ListObjectsRequest listObjectsRequest=new ListObjectsRequest();
  listObjectsRequest.withBucketName(bucketName);
  listObjectsRequest.withPrefix(directory);
  ObjectListing ol=getAmazonS3Client(clientOptions).listObjects(listObjectsRequest);
  if (ol.isTruncated()) {
    do {
      objects.addAll(ol.getObjectSummaries());
      listObjectsRequest.setMarker(ol.getNextMarker());
      ol=getAmazonS3Client(clientOptions).listObjects(listObjectsRequest);
    }
 while (ol.isTruncated());
  }
 else {
    objects.addAll(ol.getObjectSummaries());
  }
  if (objects.isEmpty()) {
    return emptyList();
  }
  return unmodifiableList(objects);
}
