{
  List<Host> firewallHosts=new ArrayList<Host>();
  List<Host> firewallhostsInZone=new ArrayList<Host>();
  NetworkDevice fwNetworkDevice=NetworkDevice.getNetworkDevice(deviceName);
  PhysicalNetworkVO pNetwork=null;
  if (((zoneId == null) && (physicalNetworkId == null)) || (fwNetworkDevice == null)) {
    throw new InvalidParameterValueException("Atleast one of ther required parameter zone Id, physical networkId, device name is missing or invalid.");
  }
  if (physicalNetworkId != null) {
    pNetwork=_physicalNetworkDao.findById(physicalNetworkId);
    if (pNetwork == null) {
      throw new InvalidParameterValueException("Could not find phyical network with ID: " + physicalNetworkId);
    }
  }
  if (zoneId != null) {
    if (_dcDao.findById(zoneId) == null) {
      throw new InvalidParameterValueException("Could not find zone with ID: " + zoneId);
    }
    firewallhostsInZone.addAll(_hostDao.listByTypeDataCenter(Host.Type.ExternalFirewall,zoneId));
  }
  if (physicalNetworkId == null) {
    return firewallhostsInZone;
  }
  PhysicalNetworkServiceProviderVO ntwkSvcProvider=_physicalNetworkServiceProviderDao.findByServiceProvider(pNetwork.getId(),fwNetworkDevice.getNetworkServiceProvder());
  if (ntwkSvcProvider == null) {
    return null;
  }
  List<ExternalFirewallDeviceVO> fwDevices=_externalFirewallDeviceDao.listByPhysicalNetworkServiceProvider(physicalNetworkId,ntwkSvcProvider.getProviderName());
  for (  ExternalFirewallDeviceVO fwDevice : fwDevices) {
    firewallHosts.add(_hostDao.findById(fwDevice.getHostId()));
  }
  return firewallHosts;
}
