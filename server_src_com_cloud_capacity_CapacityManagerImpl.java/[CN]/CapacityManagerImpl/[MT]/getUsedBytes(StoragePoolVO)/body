{
  DataStoreProvider storeProvider=_dataStoreProviderMgr.getDataStoreProvider(pool.getStorageProviderName());
  DataStoreDriver storeDriver=storeProvider.getDataStoreDriver();
  if (storeDriver instanceof PrimaryDataStoreDriver) {
    PrimaryDataStoreDriver primaryStoreDriver=(PrimaryDataStoreDriver)storeDriver;
    return primaryStoreDriver.getUsedBytes(pool);
  }
  throw new CloudRuntimeException("Storage driver in CapacityManagerImpl.getUsedBytes(StoragePoolVO) is not a PrimaryDataStoreDriver.");
}
