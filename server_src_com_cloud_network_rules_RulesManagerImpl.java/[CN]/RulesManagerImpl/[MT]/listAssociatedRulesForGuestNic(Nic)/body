{
  List<FirewallRuleVO> result=new ArrayList<FirewallRuleVO>();
  result.addAll(_portForwardingDao.listByVmidAndDestIpAddr(nic.getIp4Address(),nic.getInstanceId()));
  List<FirewallRuleVO> staticNatRules=_firewallDao.listStaticNatByVmId(nic.getInstanceId());
  for (  FirewallRuleVO rule : staticNatRules) {
    if (rule.getNetworkId() == nic.getNetworkId())     result.add(rule);
  }
  List<? extends IpAddress> staticNatIps=_ipAddressDao.listStaticNatPublicIps(nic.getNetworkId());
  for (  IpAddress ip : staticNatIps) {
    if (ip.getVmIp() != null && ip.getVmIp().equals(nic.getIp4Address())) {
      VMInstanceVO vm=_vmInstanceDao.findById(nic.getInstanceId());
      FirewallRuleVO staticNatRule=new FirewallRuleVO(null,ip.getId(),0,65535,NetUtils.ALL_PROTO.toString(),nic.getNetworkId(),vm.getAccountId(),vm.getDomainId(),Purpose.StaticNat,null,null,null,null,null);
      result.add(staticNatRule);
    }
  }
  List<LoadBalancerVMMapVO> lbMapList=_loadBalancerVMMapDao.listByInstanceId(nic.getInstanceId());
  for (  LoadBalancerVMMapVO lb : lbMapList) {
    FirewallRuleVO lbRule=_firewallDao.findById(lb.getLoadBalancerId());
    if (lbRule.getNetworkId() == nic.getNetworkId())     result.add(lbRule);
  }
  return result;
}
