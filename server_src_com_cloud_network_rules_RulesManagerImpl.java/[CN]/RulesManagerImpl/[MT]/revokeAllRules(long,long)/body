{
  List<PortForwardingRuleVO> rules=_forwardingDao.listByIpAndNotRevoked(ipId);
  if (s_logger.isDebugEnabled()) {
    s_logger.debug("Releasing " + rules.size() + " rules for ip id="+ ipId);
  }
  for (  PortForwardingRuleVO rule : rules) {
    revokeRule(rule,null,userId);
  }
  applyPortForwardingRules(ipId,true,null);
  rules=_forwardingDao.listByIpAndNotRevoked(ipId);
  if (s_logger.isDebugEnabled()) {
    s_logger.debug("Successfully released rules for ip id=" + ipId + " and # of rules now = "+ rules.size());
  }
  return rules.size() == 0;
}
