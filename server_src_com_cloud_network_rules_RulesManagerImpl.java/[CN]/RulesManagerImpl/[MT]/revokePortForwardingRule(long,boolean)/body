{
  UserContext ctx=UserContext.current();
  Account caller=ctx.getCaller();
  PortForwardingRuleVO rule=_forwardingDao.findById(ruleId);
  if (rule == null) {
    throw new InvalidParameterValueException("Unable to find " + ruleId);
  }
  _accountMgr.checkAccess(caller,rule);
  revokeRule(rule,caller,ctx.getCallerUserId());
  boolean success=false;
  if (apply) {
    success=applyPortForwardingRules(rule.getSourceIpAddressId(),true);
  }
 else {
    success=true;
  }
  if (success) {
    UsageEventVO usageEvent=new UsageEventVO(EventTypes.EVENT_NET_RULE_DELETE,rule.getAccountId(),0,rule.getId(),null);
    _usageEventDao.persist(usageEvent);
  }
  return success;
}
