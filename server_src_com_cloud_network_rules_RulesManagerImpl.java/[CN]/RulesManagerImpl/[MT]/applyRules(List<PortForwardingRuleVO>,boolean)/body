{
  if (!_networkMgr.applyRules(rules,continueOnError)) {
    s_logger.warn("Rules are not completely applied");
    return false;
  }
 else {
    for (    PortForwardingRuleVO rule : rules) {
      if (rule.getState() == FirewallRule.State.Revoke) {
        _forwardingDao.remove(rule.getId());
      }
 else       if (rule.getState() == FirewallRule.State.Add) {
        rule.setState(FirewallRule.State.Active);
        _forwardingDao.update(rule.getId(),rule);
      }
    }
    return true;
  }
}
