{
  if (!_networkMgr.applyRules(rules,continueOnError)) {
    s_logger.warn("Rules are not completely applied");
    return false;
  }
 else {
    for (    FirewallRule rule : rules) {
      if (rule.getState() == FirewallRule.State.Revoke) {
        _firewallDao.remove(rule.getId());
      }
 else       if (rule.getState() == FirewallRule.State.Add) {
        FirewallRuleVO ruleVO=_firewallDao.findById(rule.getId());
        ruleVO.setState(FirewallRule.State.Active);
        _firewallDao.update(ruleVO.getId(),ruleVO);
      }
    }
    return true;
  }
}
