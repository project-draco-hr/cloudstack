{
  boolean success=true;
  Account caller=UserContext.current().getCaller();
  IPAddressVO ipAddress=_ipAddressDao.findById(ipId);
  checkIpAndUserVm(ipAddress,null,caller);
  if (!ipAddress.isOneToOneNat()) {
    throw new InvalidParameterValueException("One to one nat is not enabled for the ip id=" + ipId);
  }
  if (!revokeAllRulesForIp(ipId,UserContext.current().getCallerUserId(),caller)) {
    s_logger.warn("Unable to revoke all static nat rules for ip " + ipAddress);
    success=false;
  }
  if (success) {
    ipAddress.setOneToOneNat(false);
    ipAddress.setAssociatedWithVmId(null);
    _ipAddressDao.update(ipAddress.getId(),ipAddress);
    return true;
  }
 else {
    s_logger.warn("Failed to disable one to one nat for the ip address id" + ipId);
    return false;
  }
}
