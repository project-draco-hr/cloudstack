{
  List<StaticNat> staticNats=new ArrayList<StaticNat>();
  if (!sourceIp.isOneToOneNat()) {
    s_logger.debug("Source ip id=" + sourceIp + " is not one to one nat");
    return staticNats;
  }
  Long networkId=sourceIp.getAssociatedWithNetworkId();
  if (networkId == null) {
    throw new CloudRuntimeException("Ip address is not associated with any network");
  }
  UserVmVO vm=_vmDao.findById(sourceIp.getAssociatedWithVmId());
  Network network=_networkModel.getNetwork(networkId);
  if (network == null) {
    CloudRuntimeException ex=new CloudRuntimeException("Unable to find an ip address to map to specified vm id");
    ex.addProxyObject(vm,vm.getId(),"vmId");
    throw ex;
  }
  if (caller != null) {
    _accountMgr.checkAccess(caller,null,true,sourceIp);
  }
  String dstIp;
  if (forRevoke) {
    dstIp=_networkModel.getIpInNetworkIncludingRemoved(sourceIp.getAssociatedWithVmId(),networkId);
  }
 else {
    dstIp=_networkModel.getIpInNetwork(sourceIp.getAssociatedWithVmId(),networkId);
  }
  StaticNatImpl staticNat=new StaticNatImpl(sourceIp.getAllocatedToAccountId(),sourceIp.getAllocatedInDomainId(),networkId,sourceIp.getId(),dstIp,forRevoke);
  staticNats.add(staticNat);
  return staticNats;
}
