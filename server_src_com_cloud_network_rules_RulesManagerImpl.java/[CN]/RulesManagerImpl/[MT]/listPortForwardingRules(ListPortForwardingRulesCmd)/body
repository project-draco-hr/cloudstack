{
  Ip ipAddress=new Ip(cmd.getIpAddress());
  Account caller=UserContext.current().getAccount();
  IPAddressVO ipAddressVO=_ipAddressDao.findById(ipAddress.addr());
  if (ipAddressVO == null || ipAddressVO.getAllocated() == null) {
    throw new InvalidParameterValueException("Unable to find IP address " + ipAddress);
  }
  List<PortForwardingRuleVO> rules=_forwardingDao.listByIpAndNotRevoked(ipAddress);
  _accountMgr.checkAccess(caller,rules.toArray(new PortForwardingRuleVO[rules.size()]));
  return rules;
}
