{
  Ip ipAddress=new Ip(cmd.getIpAddress());
  Account caller=UserContext.current().getAccount();
  IPAddressVO ipAddressVO=_ipAddressDao.findById(ipAddress.addr());
  if (ipAddressVO == null || !ipAddressVO.readyToUse()) {
    throw new InvalidParameterValueException("Ip address not ready for port forwarding rules yet: " + ipAddress);
  }
  List<PortForwardingRuleVO> rules=_forwardingDao.listByIp(ipAddress);
  _accountMgr.checkAccess(caller,rules.toArray(new PortForwardingRuleVO[rules.size()]));
  return rules;
}
