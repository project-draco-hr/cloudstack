{
  String value=configDao.getValue(Config.PrimaryStorageDownloadWait.toString());
  int _primaryStorageDownloadWait=NumbersUtil.parseInt(value,Integer.parseInt(Config.PrimaryStorageDownloadWait.getDefaultValue()));
  if (needCacheStorage(srcData,destData)) {
    Scope destScope=destData.getDataStore().getScope();
    if (destScope instanceof ClusterScope) {
      ClusterScope clusterScope=(ClusterScope)destScope;
      destScope=new ZoneScope(clusterScope.getZoneId());
    }
 else     if (destScope instanceof HostScope) {
      HostScope hostScope=(HostScope)destScope;
      destScope=new ZoneScope(hostScope.getZoneId());
    }
    DataObject cacheData=cacheMgr.createCacheObject(srcData,destScope);
    CopyCommand cmd=new CopyCommand(cacheData.getTO(),destData.getTO(),_primaryStorageDownloadWait);
    EndPoint ep=selector.select(cacheData,destData);
    Answer answer=ep.sendMessage(cmd);
    return answer;
  }
 else {
    CopyCommand cmd=new CopyCommand(srcData.getTO(),destData.getTO(),_primaryStorageDownloadWait);
    EndPoint ep=selector.select(srcData,destData);
    Answer answer=ep.sendMessage(cmd);
    return answer;
  }
}
