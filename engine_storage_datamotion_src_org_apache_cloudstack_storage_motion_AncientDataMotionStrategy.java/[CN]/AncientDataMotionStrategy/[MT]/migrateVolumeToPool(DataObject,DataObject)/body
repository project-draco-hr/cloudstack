{
  VolumeInfo volume=(VolumeInfo)srcData;
  StoragePool destPool=(StoragePool)dataStoreMgr.getDataStore(destData.getDataStore().getId(),DataStoreRole.Primary);
  MigrateVolumeCommand command=new MigrateVolumeCommand(volume.getId(),volume.getPath(),destPool,volume.getAttachedVmName());
  EndPoint ep=selector.select(srcData,StorageAction.MIGRATEVOLUME);
  Answer answer=null;
  if (ep == null) {
    String errMsg="No remote endpoint to send command, check if host or ssvm is down?";
    s_logger.error(errMsg);
    answer=new Answer(command,false,errMsg);
  }
 else {
    answer=ep.sendMessage(command);
  }
  if (answer == null || !answer.getResult()) {
    throw new CloudRuntimeException("Failed to migrate volume " + volume + " to storage pool "+ destPool);
  }
 else {
    VolumeVO volumeVo=volDao.findById(volume.getId());
    Long oldPoolId=volume.getPoolId();
    volumeVo.setPath(((MigrateVolumeAnswer)answer).getVolumePath());
    volumeVo.setFolder(destPool.getPath());
    volumeVo.setPodId(destPool.getPodId());
    volumeVo.setPoolId(destPool.getId());
    volumeVo.setLastPoolId(oldPoolId);
    volDao.update(volume.getId(),volumeVo);
  }
  return answer;
}
