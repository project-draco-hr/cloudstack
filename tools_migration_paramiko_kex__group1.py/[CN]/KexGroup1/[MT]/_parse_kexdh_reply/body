def _parse_kexdh_reply(self, m):
    host_key = m.get_string()
    self.f = m.get_mpint()
    if ((self.f < 1) or (self.f > (P - 1))):
        raise SSHException('Server kex "f" is out of range')
    sig = m.get_string()
    K = pow(self.f, self.x, P)
    hm = Message()
    hm.add(self.transport.local_version, self.transport.remote_version, self.transport.local_kex_init, self.transport.remote_kex_init)
    hm.add_string(host_key)
    hm.add_mpint(self.e)
    hm.add_mpint(self.f)
    hm.add_mpint(K)
    self.transport._set_K_H(K, SHA.new(str(hm)).digest())
    self.transport._verify_key(host_key, sig)
    self.transport._activate_outbound()
