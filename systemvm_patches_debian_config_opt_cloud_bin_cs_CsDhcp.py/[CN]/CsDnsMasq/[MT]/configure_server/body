def configure_server(self):
    self.updated = (self.updated | CsHelper.addifmissing(DNSMASQ_CONF, 'dhcp-hostsfile=/etc/dhcphosts.txt'))
    for i in self.devinfo:
        if (not i['dnsmasq']):
            continue
        device = i['dev']
        ip = i['ip'].split('/')[0]
        line = ('dhcp-range=interface:%s,set:interface-%s,%s,static' % (device, device, ip))
        self.updated = (self.updated | CsHelper.addifmissing(CLOUD_CONF, line))
        gn = CsGuestNetwork(device, self.cl)
        line = ('dhcp-option=tag:interface-%s,15,%s' % (device, gn.get_domain()))
        self.updated = (self.updated | CsHelper.addifmissing(CLOUD_CONF, line))
    if self.updated:
        if self.first_host:
            CsHelper.service('dnsmasq', 'restart')
        else:
            CsHelper.hup_dnsmasq('dnsmasq', 'dnsmasq')
