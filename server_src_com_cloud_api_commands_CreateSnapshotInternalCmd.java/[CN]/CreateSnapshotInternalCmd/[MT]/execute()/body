{
  try {
    SnapshotVO snapshot=_snapshotMgr.createSnapshotInternal(this);
    SnapshotResponse response=new SnapshotResponse();
    response.setId(snapshot.getId());
    Account account=ApiDBUtils.findAccountById(snapshot.getAccountId());
    if (account != null) {
      response.setAccountName(account.getAccountName());
      response.setDomainId(account.getDomainId());
      response.setDomainName(ApiDBUtils.findDomainById(account.getDomainId()).getName());
    }
    VolumeVO volume=ApiDBUtils.findVolumeById(snapshot.getVolumeId());
    String snapshotTypeStr=SnapshotType.values()[snapshot.getSnapshotType()].name();
    response.setSnapshotType(snapshotTypeStr);
    response.setVolumeId(snapshot.getVolumeId());
    response.setVolumeName(volume.getName());
    response.setVolumeType(volume.getVolumeType().toString());
    response.setCreated(snapshot.getCreated());
    response.setName(snapshot.getName());
    response.setObjectName("snapshot");
    response.setResponseName(getName());
    this.setResponseObject(response);
  }
 catch (  ResourceAllocationException ex) {
    throw new ServerApiException(BaseCmd.INTERNAL_ERROR,ex.getMessage());
  }
}
